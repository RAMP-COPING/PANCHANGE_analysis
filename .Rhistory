MHD.DX.1.0_6, MHD.DX.1.0_7, MHD.DX.1.0_14, MHD.DX.1.0_8, MHD.DX.1.0_9)
head(sign_up_glad_subset)
sign_up_glad_subset <- sign_up_glad_subset %>%
rename(participant_id = ExternalReference,
mdd = MHD.DX.1.0_1,
perinatal_D = MHD.DX.1.0_2,
ptsd = MHD.DX.1.0_9,
gad = MHD.DX.1.0_4,
social_anxiety = MHD.DX.1.0_5,
specific_phobia = MHD.DX.1.0_6,
agoraphobia = MHD.DX.1.0_7,
panic_disorder = MHD.DX.1.0_14,
panic_attacks = MHD.DX.1.0_8)
names(sign_up_glad_subset)
sign_up_glad_subset <- sign_up_glad_subset %>%
mutate(mdd =
case_when(mdd == "0.0" ~ "No",
mdd == "0" ~ "No",
mdd == "1" ~ "Yes",
mdd == "1.0" ~ "Yes"),
perinatal_D =
case_when(perinatal_D == "0.0" ~ "No",
perinatal_D == "0" ~ "No",
perinatal_D == "1" ~ "Yes",
perinatal_D == "1.0" ~ "Yes"),
ptsd =
case_when(ptsd == "0.0" ~ "No",
ptsd == "0" ~ "No",
ptsd == "1" ~ "Yes",
ptsd == "1.0" ~ "Yes"),
gad =
case_when(gad == "0.0" ~ "No",
gad == "0" ~ "No",
gad == "1" ~ "Yes",
gad == "1.0" ~ "Yes"),
social_anxiety =
case_when(social_anxiety == "0.0" ~ "No",
social_anxiety == "0" ~ "No",
social_anxiety == "1" ~ "Yes",
social_anxiety == "1.0" ~ "Yes"),
specific_phobia =
case_when(specific_phobia == "0.0" ~ "No",
specific_phobia == "0" ~ "No",
specific_phobia == "1" ~ "Yes",
specific_phobia == "1.0" ~ "Yes"),
agoraphobia =
case_when(agoraphobia == "0.0" ~ "No",
agoraphobia == "0" ~ "No",
agoraphobia == "1" ~ "Yes",
agoraphobia == "1.0" ~ "Yes"),
panic_disorder =
case_when(panic_disorder == "0.0" ~ "No",
panic_disorder == "0" ~ "No",
panic_disorder == "1" ~ "Yes",
panic_disorder == "1.0" ~ "Yes"),
panic_attacks =
case_when(panic_attacks == "0.0" ~ "No",
panic_attacks == "0" ~ "No",
panic_attacks == "1" ~ "Yes",
panic_attacks == "1.0" ~ "Yes"))
yes_no_depression_prep <- sign_up_glad_subset %>%
group_by(mdd) %>%
filter(mdd == "Yes" | mdd == "No") %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
head(yes_no_depression_prep)
#For some reason we have 1 and 1.0 for "yes" and 0 and 0.0 for "no"?
mdd_pie <- ggplot(yes_no_depression_prep, aes(x = "", y = freq, fill= mdd)) +
geom_bar(width = 1, stat = "identity") +
scale_fill_manual(values =  COPINGpalette2) +
scale_color_manual(values =  COPINGpalette2) +
coord_polar("y",start=0) +
theme_void() +
labs(title = paste("Proportion of the GLAD sample with a diagnosis of MDD",
sep=" "),
subtitle = paste("n", sum(yes_no_depression_prep$n),
sep = " "),
fill = "Self-reported depression diagnosis")
#This is for the percent labels, but they don't look nice
#+
#   geom_text(aes(y = c(0.88, 0.12),
#                label = paste0(round((freq*100),0),"%")),
#          size=5,
#         vjust = 5,
#        face="bold"
#       )
mdd_pie
yes_no_anxiety_prep <- sign_up_glad_subset %>%
group_by(gad) %>%
filter(gad == "Yes" | gad == "No") %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
head(yes_no_anxiety_prep)
gad_pie <- ggplot(yes_no_anxiety_prep, aes(x = "", y = freq, fill= gad)) +
geom_bar(width = 1, stat = "identity") +
scale_fill_manual(values =  COPINGpalette2) +
scale_color_manual(values =  COPINGpalette2) +
coord_polar("y",start=0) +
theme_void() +
labs(title = paste("Proportion of the GLAD sample with a diagnosis of GAD",
sep=" "),
subtitle = paste("n", sum(yes_no_anxiety_prep$n),
sep = " "),
fill = "Self-reported anxiety diagnosis")
#This is for the percent labels, but they don't look nice
#+
#   geom_text(aes(y = c(0.88, 0.12),
#                label = paste0(round((freq*100),0),"%")),
#          size=5,
#         vjust = 5,
#        face="bold"
#       )
gad_pie
variables <- data.frame(apply(sign_up_glad_subset[c("mdd", "perinatal_D", "ptsd",                  "gad", "social_anxiety", "specific_phobia", "agoraphobia",
"panic_disorder", "panic_attacks")],2,table))
variables
diagnoses <- data.frame(c("mdd", "perinatal D", "ptsd", "gad", "social anxiety",
"specific phobia", "agoraphobia", "panic disorder", "panic attacks"))
diagnoses
positive_diagnosis <- data.frame(t(variables[2,]))
positive_diagnosis
diagnosis_type <- cbind(diagnoses, positive_diagnosis)
diagnosis_type
names(diagnosis_type) <- c("diagnosis", "count")
diagnosis_type
knitr::opts_chunk$set(echo = TRUE)
remove(list = ls())
# Read in data
library(knitr)
library(summarytools)
library(psych)
library(polycor)
library(corrplot)
library(patchwork)
library(broom)
library(tidyverse)
library(ggpubr)
# get file info
source("../PANCHANGE_raw_path.R")
alldat <-  readRDS(file = paste0(data_path, "/four_cohorts_variables_exclusion.rds"))
COPINGpalette2 <- c("#78D9C5",
"#F5BE5E")
COPINGpalette3 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9")
COPINGpalette4 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73")
COPINGpalette5 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73",
"#FFED98")
COPINGpalette6 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73",
"#FFED98",
"#BFD2EB")
COPINGpalette7 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73",
"#FFED98",
"#BFD2EB",
"#808080")
COPINGpalette9 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73",
"#FFED98",
"#BFD2EB",
"#808080",
"#cccccc",
"3B47DA")
COPINGpaletteGRAD <- c("#F5BE5E",
"#FFD284",
"#FFEED1",
"#B5B5B5",
"#DEFFF8",
"#94F6E1",
"#78D9C5")
COPINGNeuCenterpalette <- c("#78D9C5",
"#808080",
"#F5BE5E")
RAMPworseGRADpalette <- c("#78D9C5",
"#FFEED1",
"#F5BE5E",
"#FFB1B5")
GLADpalette = c("#efc00b",
"#b7dee8")
# impute retro for those who did not change
alldat$gad.sum_score_retro <- ifelse(alldat$gad.pandemic_felt_feelings == "No different", alldat$gad.sum_score_base,alldat$gad.sum_score_retro)
alldat$phq.sum_score_retro <- ifelse(alldat$phq.pandemic_felt_feelings == "No different", alldat$phq.sum_score_base,alldat$phq.sum_score_retro)
dat.retro <- alldat %>%
filter(
((data_group_gad == "Baseline and retrospective data" |
data_group_gad == "All prepandemic, baseline and retrospective data") |
(data_group_phq == "Baseline and retrospective data" |
data_group_phq == "All prepandemic, baseline and retrospective data") |
(data_group_pcl == "Baseline data only" |
data_group_pcl == "Baseline and retrospective data" |
data_group_pcl == "Prepandemic and baseline data" |
data_group_pcl == "All prepandemic, baseline and retrospective data"))
)
dim(dat.retro)
dat.prepan <- alldat %>%
filter(
((data_group_gad == "Prepandemic and baseline data" |
data_group_gad == "All prepandemic, baseline and retrospective data") |
(data_group_phq == "Prepandemic and baseline data" |
data_group_phq == "All prepandemic, baseline and retrospective data") |
(data_group_pcl == "Prepandemic and baseline data" |
data_group_pcl == "All prepandemic, baseline and retrospective data") ) &
prepandemic_march_1_numeric == 1 # Exclude participants that signed up after the 1. March
)
dim(dat.prepan)
## Subset samples by study
GLAD.prepan <- dat.prepan %>%
filter(Sample == "GLAD" |
Sample == "EDGI")
NBR.prepan <- dat.prepan %>%
filter(Sample == "NBR")
RAMP.prepan <- dat.prepan %>%
filter(Sample == "RAMP")
### retro
GLAD.retro <- dat.retro %>%
filter(Sample == "GLAD" |
Sample == "EDGI")
NBR.retro <- dat.retro %>%
filter(Sample == "NBR")
RAMP.retro <- dat.retro %>%
filter(Sample == "RAMP")
#Merge GLAD and EDGI Samples into one sample
dat.retro <- dat.retro %>%
mutate(Sample_plot =
case_when(
dat.retro$Sample == "GLAD" ~ "GLAD/EDGI",
dat.retro$Sample == "EDGI" ~ "GLAD/EDGI",
dat.retro$Sample == "NBR" ~ "NBR",
dat.retro$Sample == "RAMP" ~ "RAMP"
))
#Check that it worked
dat.retro %>%
group_by(Sample_plot) %>%
summarise(N = n())
GLAD.prepan %>%
ggplot(aes(x = Gender)) +
geom_bar(fill = COPINGpalette4) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "Gender distribution of the GLAD/EDGI prepan cohort",
subtitle = paste("N =", dim(GLAD.prepan)[1]),
x = "",
y = "N participants")
GLAD.retro %>%
ggplot(aes(x = Gender)) +
geom_bar(fill = COPINGpalette4) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "Gender distribution of the GLAD/EDGI retro cohort",
subtitle = paste("N =", dim(GLAD.retro)[1]),
x = "",
y = "N participants")
NBR.retro %>%
ggplot(aes(x = Gender)) +
geom_bar(fill = COPINGpalette4) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "Gender distribution of the NBR retro cohort",
subtitle = paste("N =", dim(NBR.retro)[1]),
x = "",
y = "N participants")
RAMP.retro %>%
ggplot(aes(x = Gender)) +
geom_bar(fill = COPINGpalette4) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "Gender distribution of the RAMP retro cohort",
subtitle = paste("N =", dim(RAMP.retro)[1]),
x = "",
y = "N participants")
dat.retro %>%
ggplot(aes(x = Gender, fill = Sample_plot)) +
geom_bar(position = "dodge") +
scale_fill_manual(values = COPINGpalette4) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "Gender distribution of the retro cohorts",
subtitle = paste("N =", dim(dat.retro)[1]),
x = "",
y = "") +
theme(legend.position = "bottom") +
theme(legend.title = element_blank())
GLAD.prepan %>%
ggplot(aes(x = age_category_collapsed)) +
geom_bar(fill = COPINGpalette9) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "Age distribution of the GLAD/EDGI prepan cohort",
subtitle = paste("N =", dim(GLAD.prepan)[1]),
x = "",
y = "")
dat.retro %>%
ggplot(aes(x = age_category_collapsed, fill = Sample_plot)) +
geom_bar(position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "Age distribution of the retro cohorts",
subtitle = paste("N =", dim(dat.retro)[1]),
x = "Age (years)",
y = "") +
theme(legend.position = "bottom") +
theme(legend.title = element_blank())
GLAD.prepan %>%
ggplot(aes(x = Ethnicity_collapsed)) +
geom_bar(fill = COPINGpalette6) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "Ethnic distribution of the GLAD/EDGI prepan cohort",
subtitle = paste("N =", dim(GLAD.prepan)[1]),
x = "",
y = "N participants") +
scale_x_discrete(guide = guide_axis(n.dodge = 2))
dat.retro %>%
ggplot(aes(x = Ethnicity_collapsed, fill = Sample_plot)) +
geom_bar(position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "Ethnic distribution of the retro cohorts",
subtitle = paste("N =", dim(dat.retro)[1]),
x = "",
y = "N participants") +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(legend.position = "bottom") +
theme(legend.title = element_blank())
GLAD.prepan %>%
ggplot(aes(x = employment_prior_covid)) +
geom_bar(fill = COPINGpalette6) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "Employment of the GLAD/EDGI prepan cohort",
subtitle = paste("N =", dim(GLAD.prepan)[1]),
x = "",
y = "") +
scale_x_discrete(guide = guide_axis(n.dodge = 2))
dat.retro %>%
ggplot(aes(x = employment_prior_covid, fill = Sample_plot)) +
geom_bar(position = "dodge") +
scale_fill_manual(values = COPINGpalette6) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "Employment distribution of the retro cohorts",
subtitle = paste("N =", dim(dat.retro)[1]),
x = "",
y = "") +
theme(legend.position = "bottom") +
theme(legend.title = element_blank())
dat.retro_diagnosis_sums <- data.frame(apply(dat.retro[c("depressive_disorders_numeric", "anxiety_disorders_numeric", "eating_disorders_numeric", "obsessive_compulsive_disorders_numeric", "psychotic_disorders_numeric", "autism_spectrum_disorder_numeric", "mhd.attention_deficit_hyperactivity_disorder_numeric", "personality_cluster_a_numeric", "personality_cluster_b_numeric", "personality_cluster_c_numeric", "mhd.mania_hypomania_bipolar_or_manicdepression_numeric", "mhd.posttraumatic_stress_disorder_ptsd_numeric", "control_numeric")],2,table))
dat.retro_diagnosis_sums
dat.retro_diagnosis_variables <- data.frame(c("depressive disorders", "anxiety disorders", "eating disorders", "obsessive compulsive disorders", "psychotic disorders", "autism spectrum disorder", "attention deficit hyperactivity disorder", "personality cluster a", "personality cluster b", "personality cluster c", "mania hypomania bipolar or manicdepression", "posttraumatic stress disorder ptsd", "control"))
dat.retro_diagnosis_variables
dat.retro_positive_diagnosis <- data.frame(t(dat.retro_diagnosis_sums[2,]))
dat.retro_positive_diagnosis
dat.retro_diagnosis_sums <- data.frame(apply(dat.retro[c("depressive_disorders_numeric", "anxiety_disorders_numeric", "eating_disorders_numeric", "obsessive_compulsive_disorders_numeric", "psychotic_disorders_numeric", "autism_spectrum_disorder_numeric", "mhd.attention_deficit_hyperactivity_disorder_numeric", "personality_cluster_a_numeric", "personality_cluster_b_numeric", "personality_cluster_c_numeric", "mhd.mania_hypomania_bipolar_or_manicdepression_numeric", "mhd.posttraumatic_stress_disorder_ptsd_numeric", "control_numeric")],2,table))
dat.retro_diagnosis_sums
dat.retro_diagnosis_type <- cbind(dat.retro_diagnosis_variables, dat.retro_positive_diagnosis)
dat.retro_diagnosis_type
names(diagnosis_type) <- c("diagnosis", "count")
names(dat.retro_diagnosis_type) <- c("diagnosis", "count")
dat.retro_diagnosis_type
head(dat.retro_diagnosis_type, 20)
head(dat.retro$disorders_total_count)
dat.retro_diagnosis_type %>%
mutate(diagnosis_plot = fct_reorder(diagnosis, -count)) %>%
ggplot(aes(x = diagnosis_plot, y = count, fill = dat.retro$Sample_plot)) +
geom_bar(stat = "identity")
dim(dat.retro_diagnosis_type)
dat.retro %>%
group_by(Sample_plot) %>%
ggplot(data = dat.retro_diagnosis_type, aes(x = diagnosis, y = count)) +
geom_bar(stat = "identity")
dat.retro %>%
group_by(Sample_plot)
dat.retro %>%
group_by(Sample_plot) %>%
ggplot(data = dat.retro_diagnosis_type, aes(x = diagnosis, y = count)) +
geom_bar(stat = "identity")
dat.retro %>%
group_by(Sample_plot) %>%
ggplot(aes(x = dat.retro_diagnosis_type$diagnosis, y = dat.retro_diagnosis_type$count)) +
geom_bar(stat = "identity")
dat.retro_diagnosis_type %>%
mutate(diagnosis_plot = fct_reorder(diagnosis, -count)) %>%
ggplot(aes(x = diagnosis_plot, y = count)) +
geom_bar(stat = "identity")
dat.retro_diagnosis_type %>%
mutate(diagnosis_plot = fct_reorder(diagnosis, -count)) %>%
ggplot(aes(x = diagnosis_plot, y = count)) +
geom_bar(stat = "identity") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
theme_minimal()
dat.retro_diagnosis_sums <- data.frame(apply(dat.retro[c("depressive_disorders_numeric", "anxiety_disorders_numeric", "eating_disorders_numeric", "obsessive_compulsive_disorders_numeric", "psychotic_disorders_numeric", "autism_spectrum_disorder_numeric", "mhd.attention_deficit_hyperactivity_disorder_numeric", "personality_cluster_a_numeric", "personality_cluster_b_numeric", "personality_cluster_c_numeric", "mhd.mania_hypomania_bipolar_or_manicdepression_numeric", "mhd.posttraumatic_stress_disorder_ptsd_numeric", "control_numeric")],2,table))
dat.retro_diagnosis_variables <- data.frame(c("depressive disorders", "anxiety disorders", "eating disorders", "OCDs", "psychotic disorders", "aSD", "ADHD", "personality cluster a", "personality cluster b", "personality cluster c", "mania hypomania bipolar or manicdepression", "PTSD", "control"))
dat.retro_positive_diagnosis <- data.frame(t(dat.retro_diagnosis_sums[2,]))
dat.retro_diagnosis_type <- cbind(dat.retro_diagnosis_variables, dat.retro_positive_diagnosis)
names(dat.retro_diagnosis_type) <- c("diagnosis", "count")
dat.retro_diagnosis_type %>%
mutate(diagnosis_plot = fct_reorder(diagnosis, -count)) %>%
ggplot(aes(x = diagnosis_plot, y = count)) +
geom_bar(stat = "identity") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
theme_minimal()
dat.retro_diagnosis_type %>%
mutate(diagnosis_plot = fct_reorder(diagnosis, -count)) %>%
ggplot(aes(x = diagnosis_plot, y = count)) +
geom_bar(stat = "identity") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
theme_minimal() +
labs(x = "",
y = "")
dat.retro <- dat.retro %>%
mutate(personality_disorder_numeric =
case_when(
personality_cluster_a_numeric == 1 | personality_cluster_b_numeric == 1 | personality_cluster_c_numeric == 1 ~ 1,
personality_cluster_a_numeric == 0 & personality_cluster_b_numeric == 0 & personality_cluster_c_numeric == 0 ~ 0
))
head(dat.retro$personality_cluster_a_numeric, 10)
head(dat.retro$personality_cluster_b_numeric, 10)
head(dat.retro$personality_cluster_c_numeric, 10)
head(dat.retro$personality_disorder_numeric, 10)
dat.retro_diagnosis_sums <- data.frame(apply(dat.retro[c("depressive_disorders_numeric", "anxiety_disorders_numeric", "eating_disorders_numeric", "obsessive_compulsive_disorders_numeric", "psychotic_disorders_numeric", "autism_spectrum_disorder_numeric", "mhd.attention_deficit_hyperactivity_disorder_numeric", "personality_disorder_numeric", "mhd.mania_hypomania_bipolar_or_manicdepression_numeric", "mhd.posttraumatic_stress_disorder_ptsd_numeric", "control_numeric")],2,table))
dat.retro_diagnosis_variables <- data.frame(c("depressive disorders", "anxiety disorders", "eating disorders", "OCDs", "psychotic disorders", "aSD", "ADHD", "personality disorders", "mania hypomania bipolar or manicdepression", "PTSD", "control"))
dat.retro_positive_diagnosis <- data.frame(t(dat.retro_diagnosis_sums[2,]))
dat.retro_diagnosis_type <- cbind(dat.retro_diagnosis_variables, dat.retro_positive_diagnosis)
names(dat.retro_diagnosis_type) <- c("diagnosis", "count")
dat.retro_diagnosis_type %>%
mutate(diagnosis_plot = fct_reorder(diagnosis, -count)) %>%
ggplot(aes(x = diagnosis_plot, y = count)) +
geom_bar(stat = "identity") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
theme_minimal() +
labs(x = "",
y = "")
dat.retro_diagnosis_sums <- data.frame(apply(dat.retro[c("depressive_disorders_numeric", "anxiety_disorders_numeric", "eating_disorders_numeric", "obsessive_compulsive_disorders_numeric", "psychotic_disorders_numeric", "autism_spectrum_disorder_numeric", "mhd.attention_deficit_hyperactivity_disorder_numeric", "personality_disorder_numeric", "mhd.mania_hypomania_bipolar_or_manicdepression_numeric", "mhd.posttraumatic_stress_disorder_ptsd_numeric", "control_numeric")],2,table))
dat.retro_diagnosis_variables <- data.frame(c("depressive disorders", "anxiety disorders", "eating disorders", "OCDs", "psychotic disorders", "aSD", "ADHD", "personality disorders", "bipolar", "PTSD", "control"))
dat.retro_positive_diagnosis <- data.frame(t(dat.retro_diagnosis_sums[2,]))
dat.retro_diagnosis_type <- cbind(dat.retro_diagnosis_variables, dat.retro_positive_diagnosis)
names(dat.retro_diagnosis_type) <- c("diagnosis", "count")
dat.retro_diagnosis_type %>%
mutate(diagnosis_plot = fct_reorder(diagnosis, -count)) %>%
ggplot(aes(x = diagnosis_plot, y = count)) +
geom_bar(stat = "identity") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
theme_minimal() +
labs(x = "",
y = "")
dat.retro_diagnosis_sums <- data.frame(apply(dat.retro[c("depressive_disorders_numeric", "anxiety_disorders_numeric", "eating_disorders_numeric", "obsessive_compulsive_disorders_numeric", "psychotic_disorders_numeric", "autism_spectrum_disorder_numeric", "mhd.attention_deficit_hyperactivity_disorder_numeric", "personality_disorder_numeric", "mhd.mania_hypomania_bipolar_or_manicdepression_numeric", "mhd.posttraumatic_stress_disorder_ptsd_numeric", "control_numeric")],2,table))
dat.retro_diagnosis_variables <- data.frame(c("depressive disorders", "anxiety disorders", "eating disorders", "OCDs", "psychotic disorders", "ASD", "ADHD", "personality disorders", "bipolar disorder", "PTSD", "control"))
dat.retro_positive_diagnosis <- data.frame(t(dat.retro_diagnosis_sums[2,]))
dat.retro_diagnosis_type <- cbind(dat.retro_diagnosis_variables, dat.retro_positive_diagnosis)
names(dat.retro_diagnosis_type) <- c("diagnosis", "count")
dat.retro_diagnosis_type %>%
mutate(diagnosis_plot = fct_reorder(diagnosis, -count)) %>%
ggplot(aes(x = diagnosis_plot, y = count)) +
geom_bar(stat = "identity") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
theme_minimal() +
labs(x = "",
y = "")
Nrow(diamonds$clarity)
nrow(diamonds$clarity)
sum(diamonds$clarity)
seq_along(diamonds$clarity)
(diamonds$clarity)
head(diamonds)
dat.retro_diagnosis_type %>%
mutate(diagnosis_plot = fct_reorder(diagnosis, -count)) %>%
ggplot(aes(x = diagnosis_plot, y = count)) +
geom_bar(stat = "identity") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
theme_minimal() +
labs(x = "",
y = "")
dat.retro_diagnosis_type
dat.retro_diagnosis_type %>%
group_by(Sample_plot) %>%
mutate(diagnosis_plot = fct_reorder(diagnosis, -count)) %>%
ggplot(aes(x = diagnosis_plot, y = count)) +
geom_bar(stat = "identity") +
scale_x_discrete(guide = guide_axis(n.dodge = 3)) +
theme_minimal() +
labs(x = "",
y = "")
dat.retro %>%
group_by(Sample_plot) %>%
ggplot(data = dat.retro_diagnosis_type, aes(x = diagnosis, y = count)) +
geom_bar()
