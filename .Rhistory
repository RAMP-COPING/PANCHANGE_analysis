dat.retro_PD_by_sample <- dat.retro %>%
group_by(Sample_plot) %>%
select(personality_disorder_numeric) %>%
filter(personality_disorder_numeric == 1)
dat.retro_PD_by_sample <- dat.retro_PD_by_sample %>%
group_by(Sample_plot) %>%
summarise("Personality disorders" = n())
dat.retro_BD_by_sample <- dat.retro %>%
group_by(Sample_plot) %>%
select(mhd.mania_hypomania_bipolar_or_manicdepression_numeric) %>%
filter(mhd.mania_hypomania_bipolar_or_manicdepression_numeric == 1)
dat.retro_BD_by_sample <- dat.retro_BD_by_sample %>%
group_by(Sample_plot) %>%
summarise("Bipolar disorders" = n())
dat.retro_PTSD_by_sample <- dat.retro %>%
group_by(Sample_plot) %>%
select(mhd.posttraumatic_stress_disorder_ptsd_numeric) %>%
filter(mhd.posttraumatic_stress_disorder_ptsd_numeric == 1)
dat.retro_PTSD_by_sample <- dat.retro_PTSD_by_sample %>%
group_by(Sample_plot) %>%
summarise("PTSD" = n())
dat.retro_control_by_sample <- dat.retro %>%
group_by(Sample_plot) %>%
select(control_numeric) %>%
filter(control_numeric == 1)
dat.retro_control_by_sample <- dat.retro_control_by_sample %>%
group_by(Sample_plot) %>%
summarise("No diagnosis" = n())
dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_mdd_by_sample,
dat.retro_anxi_by_sample,
by = "Sample_plot")
dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
dat.retro_ED_by_sample,
by = "Sample_plot")
dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
dat.retro_OCD_by_sample,
by = "Sample_plot")
dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
dat.retro_psychosis_by_sample,
by = "Sample_plot")
dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
dat.retro_ASD_by_sample,
by = "Sample_plot")
dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
dat.retro_ADHD_by_sample,
by = "Sample_plot")
dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
dat.retro_PD_by_sample,
by = "Sample_plot")
dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
dat.retro_BD_by_sample,
by = "Sample_plot")
dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
dat.retro_PTSD_by_sample,
by = "Sample_plot")
dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
dat.retro_control_by_sample,
by = "Sample_plot")
head(dat.retro_positive_diagnosis_by_sample)
dat.retro_positive_diagnosis_by_sample <- dat.retro_positive_diagnosis_by_sample %>%
gather('Depressive disorders', 'Anxiety disorders', 'Eating disorders', 'OCDRs', 'Psychotic disorders', 'ASD', 'ADHD', 'Personality disorders', 'Bipolar disorders', 'PTSD', 'No diagnosis', key = "Diagnosis", value = positive_n)
head(dat.retro_positive_diagnosis_by_sample, 9)
retro_diagnosis_plot <- dat.retro_positive_diagnosis_by_sample %>%
ggplot(aes(x = reorder(Diagnosis, -positive_n, sum), y = positive_n, fill = Sample_plot)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(x = "Mental health diagnosis",
y = "N participants") +
ylim(0, 20000) +
theme(axis.text.x = element_text(angle = 70, vjust = 0.5)) +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
geom_text(aes(label = stat(y), group = Diagnosis),
stat = "summary",
fun = sum,
vjust = -1,
colour = "black") +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
arranged_gender_plot <- retro_gender_plot +
theme(legend.position = "none") +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
expand = expansion(mult = c(0.3, 0.4)))
arranged_employ_plot <- retro_employ_plot +
theme(legend.position = "none") +
scale_x_discrete(guide = guide_axis(n.dodge = 2))
#Combine retro age, gender and employ together
ggarrange(retro_age_plot,
ggarrange(arranged_gender_plot, arranged_employ_plot, ncol = 2),
nrow = 2,
common.legend = TRUE)
dat.retro_gender_distribution <- dat.retro %>%
group_by(Gender_collapsed, Sample_plot) %>%
summarise(n = n())
labelled_arranged_gender_plot <- dat.retro_gender_distribution %>%
ggplot(aes(x = Gender_collapsed, y = n, fill = Sample_plot)) +
geom_bar(position = "dodge", stat = "identity") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(x = "Participant Gender",
y = "N participants") +
theme(legend.position = "none") +
theme(legend.title = element_blank()) +
geom_text(aes(label = n),
size = 3,
position = position_dodge(width=0.9),
vjust=-0.25) +
scale_x_discrete(guide = guide_axis(n.dodge = 2),
expand = expansion(mult = c(0.3, 0.4))) +
scale_y_continuous(expand = expansion(mult = c(0, 0.1)))
#Combine retro age, gender and employ together
ggarrange(retro_age_plot,
ggarrange(labelled_arranged_gender_plot, arranged_employ_plot, ncol = 2),
nrow = 2,
common.legend = TRUE)
arranged_retro_ethnicity_white <- dat.retro_ethnicity_white %>%
ggplot(aes(x = Ethnicity_collapsed, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "",
x = "Ethnic origin",
y = "N participants") +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(legend.position = "none") +
theme(legend.title = element_blank()) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))# +
#  geom_text(aes(label = n),
#            size = 3,
#            position = position_dodge(width=0.9),
#            vjust=-0.25)
#Graph 2
arranged_retro_ethnicity_non_white <- dat.retro_ethnicity_non_white %>%
ggplot(aes(x = Ethnicity_collapsed, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "",
x = "Ethnic origin",
y = "N participants") +
theme(legend.position = "bottom") +
theme(legend.title = element_blank()) +
#theme(legend.title = element_blank()) +
geom_text(aes(label = n),
size = 3,
position = position_dodge(width=0.9),
vjust=-0.25) +
scale_y_continuous(expand = expansion(mult = c(0.1, 0.2))) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
#arranged_retro_ethnicity_plot <- plot_grid(arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white, labels = "")
arranged_retro_age_plot <- dat.retro %>%
ggplot(aes(x = age_category_collapsed, fill = Sample_plot)) +
geom_bar(position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(x = "Age (years)",
y = "N participants") +
theme(legend.position = "none") +
theme(legend.title = element_blank()) +
theme(axis.text.x = element_text(angle = 70, vjust = 0.5)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
dat.retro_gender_male_female <- dat.retro_gender_distribution %>%
filter(Gender_collapsed != "Non-binary/Self-defined")
arranged_collapsed_gender_plot <- dat.retro_gender_male_female %>%
ggplot(aes(x = Gender_collapsed, y = n, fill = Sample_plot)) +
geom_bar(position = "dodge", stat = "identity") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(x = "Participant Gender",
y = "N participants",
caption = "Non-binary/Self-defined
GLAD/EDGI (243); NBR (39); RAMP (92)") +
theme(legend.position = "none") +
theme(legend.title = element_blank())  +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
arranged_employ_plot <- dat.retro_employment_plot %>%
ggplot(aes(x = employment_prior_covid, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(x = "Employment status",
y = "N participants") +
theme(legend.position = "none") +
theme(legend.title = element_blank()) +
scale_y_continuous(breaks = seq(0, 6000, by = 1000)) +
scale_x_discrete(guide = guide_axis(n.dodge = 3),
expand = expansion(mult = c(0.2, 0.3))) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
retro_matrix <- matrix(c(1, 2, 3, 4, 5, 5), nrow = 2, byrow = TRUE)
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2)
#Remake gender plot without caption
arranged_collapsed_gender_plot <- dat.retro_gender_male_female %>%
ggplot(aes(x = Gender_collapsed, y = n, fill = Sample_plot)) +
geom_bar(position = "dodge", stat = "identity") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(x = "Participant Gender",
y = "N participants") +
theme(legend.position = "none") +
theme(legend.title = element_blank())  +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
bottom = textGrob("Non-binary/Self-defined: GLAD/EDGI (243); NBR (39); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
bottom = textGrob("Non-binary/Self-defined: GLAD/EDGI (243); NBR (39); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
library(grid)
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
bottom = textGrob("Non-binary/Self-defined: GLAD/EDGI (243); NBR (39); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
#Graph 2
arranged_retro_ethnicity_non_white <- dat.retro_ethnicity_non_white %>%
ggplot(aes(x = Ethnicity_collapsed, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "",
x = "Ethnic origin",
y = "N participants") +
theme(legend.justification = "right",
legend.margin = margin(t = 2, r = 0, b = 2, l = 2, unit = "mm")) +
#theme(legend.position = "bottom") +
theme(legend.title = element_blank()) +
#theme(legend.title = element_blank()) +
geom_text(aes(label = n),
size = 3,
position = position_dodge(width=0.9),
vjust=-0.25) +
scale_y_continuous(expand = expansion(mult = c(0.1, 0.2))) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2)
#Graph 2
arranged_retro_ethnicity_non_white <- dat.retro_ethnicity_non_white %>%
ggplot(aes(x = Ethnicity_collapsed, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "",
x = "Ethnic origin",
y = "N participants") +
theme(legend.justification = "bottom",
legend.margin = margin(t = 2, r = 0, b = 2, l = 2, unit = "mm")) +
#theme(legend.position = "bottom") +
theme(legend.title = element_blank()) +
#theme(legend.title = element_blank()) +
geom_text(aes(label = n),
size = 3,
position = position_dodge(width=0.9),
vjust=-0.25) +
scale_y_continuous(expand = expansion(mult = c(0.1, 0.2))) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2)
#Graph 2
arranged_retro_ethnicity_non_white <- dat.retro_ethnicity_non_white %>%
ggplot(aes(x = Ethnicity_collapsed, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "",
x = "Ethnic origin",
y = "N participants") +
theme(legend.position = "bottom") +
theme(legend.title = element_blank()) +
#theme(legend.title = element_blank()) +
geom_text(aes(label = n),
size = 3,
position = position_dodge(width=0.9),
vjust=-0.25) +
scale_y_continuous(expand = expansion(mult = c(0.1, 0.2))) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2)
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
ggarrange(common.legend = TRUE,
legend = "bottom"))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
ggarrange(common.legend = TRUE,
legend = "bottom"))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
ggarrange(common.legend = TRUE))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2) +
plot_layout(guides = "collect")
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1,1.2))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2)
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1,1.2))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2)
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1, 1, 1, 1, 1.5))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1, 1.5))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1, 1.2))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2)
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1, 1.2))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1, 1.1))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2)
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1,1.1))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1, 1.2))
arranged_collapsed_gender_plot <- dat.retro_gender_male_female %>%
ggplot(aes(x = Gender_collapsed, y = n, fill = Sample_plot)) +
geom_bar(position = "dodge", stat = "identity") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(x = "Participant Gender",
y = "N participants") +
theme(legend.position = "none") +
theme(legend.title = element_blank())  +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
bottom = textGrob("Non-binary/Self-defined: GLAD/EDGI (243); NBR (39); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1, 1.2),
bottom = textGrob("Non-binary/Self-defined: GLAD/EDGI (243); NBR (39); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1, 1.1),
bottom = textGrob("Non-binary/Self-defined: GLAD/EDGI (243); NBR (39); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1, 1.2),
bottom = textGrob("Non-binary/Self-defined: GLAD/EDGI (243); NBR (39); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
levels(dat.retro_ethnicity_non_white$Ethnicity_collapsed)
dat.retro_ethnicity_non_white <- dat.retro_ethnicity_non_white %>%
mutate(Ethnicity_collapsed =
fct_reorder(Ethnicity_collapsed,
"Mixed or multiple origins" = "Mixed or multiple ethnic origins"))
dat.retro_ethnicity_non_white <- dat.retro_ethnicity_non_white %>%
mutate(Ethnicity_collapsed =
fct_recode(Ethnicity_collapsed,
"Mixed or multiple origins" = "Mixed or multiple ethnic origins"))
arranged_retro_ethnicity_non_white <- dat.retro_ethnicity_non_white %>%
ggplot(aes(x = Ethnicity_collapsed, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(title = "",
x = "Ethnic origin",
y = "N participants") +
theme(legend.position = "bottom") +
theme(legend.title = element_blank()) +
#theme(legend.title = element_blank()) +
geom_text(aes(label = n),
size = 3,
position = position_dodge(width=0.9),
vjust=-0.25) +
scale_y_continuous(expand = expansion(mult = c(0.1, 0.2))) +
scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1, 1.2),
bottom = textGrob("Non-binary/Self-defined: GLAD/EDGI (243); NBR (39); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
heights=c(1, 1.1),
bottom = textGrob("Non-binary/Self-defined: GLAD/EDGI (243); NBR (39); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
grid.arrange(arranged_collapsed_gender_plot, arranged_retro_age_plot, arranged_employ_plot,
arranged_retro_ethnicity_white, arranged_retro_ethnicity_non_white,
layout_matrix = retro_matrix,
nrow = 2,
bottom = textGrob("Non-binary/Self-defined: GLAD/EDGI (243); NBR (39); RAMP (92)", x = 1,
hjust = 1,
gp = gpar(fontface = 3L, fontsize = 9)))
