Disorder_by_Ethnicity %>%
ggplot(mapping = aes(
x = Disorder,
y = n)
) +
geom_bar(
aes(fill = Ethnicity),
#    position = "dodge",
stat="identity",
binwidth = 1,
position = position_dodge2(preserve = "single")
) +
labs(
x = "Disorder",
y = "Number of participants",
fill = "Gender") +
theme_personal +
scale_fill_manual(
values = COPINGpalette6,
#    labels = c("Prepandemic", "Retrospective")
) +
coord_flip()
Ethnicity_by_Sample <- dat %>%
group_by(Ethnicity, Sample) %>%
count(Ethnicity)
Ethnicity_by_Sample <- dat %>%
group_by(Ethnicity, Sample) %>%
count(Ethnicity)
Ethnicity_by_Sample <- dat %>%
group_by(Ethnicity, Sample) %>%
count(Ethnicity)
Ethnicity_by_Sample
Ethnicity_by_Sample %>%
ggplot(mapping = aes(
x = Ethnicity,
y = n)
) +
geom_bar(
aes(fill = Sample),
#    position = "dodge",
stat="identity",
binwidth = 1,
position = position_dodge2(preserve = "single")
) +
labs(
x = "Ethnicity",
y = "Number of participants",
fill = "Sample") +
theme_personal +
scale_fill_manual(
values = COPINGpalette6,
#    labels = c("Prepandemic", "Retrospective")
) +
coord_flip()
Disorder_by_Gender %>%
ggplot(mapping = aes(
x = Disorder,
y = n)
) +
geom_bar(
aes(fill = Gender),
#    position = "dodge",
stat="identity",
binwidth = 1,
position = position_dodge2(preserve = "single")
) +
labs(
x = "Disorder",
y = "Number of participants",
fill = "Gender") +
theme_personal +
scale_fill_manual(
values = COPINGpalette4,
#    labels = c("Prepandemic", "Retrospective")
) +
coord_flip()
knitr::opts_chunk$set(echo = FALSE,
comment=NA,
prompt=FALSE,
cache=FALSE)
options(bitmapType = 'quartz') # to render fonts better
remove(list = ls())
date = Sys.Date()
#install.packages("summarytools")
#install.packages("tidyverse")
#install.packages("psych")
#install.packages("eeptools")
#install.packages("skimr")
library(knitr)
library(summarytools)
library(psych)
library(patchwork)
library(broom)
library(tidyverse)
COPINGpalette2 <- c("#78D9C5",
"#F5BE5E")
COPINGpalette3 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9")
COPINGpalette4 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73")
COPINGpalette5 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73",
"#FFED98")
COPINGpalette6 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73",
"#FFED98",
"#BFD2EB")
COPINGpalette7 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73",
"#FFED98",
"#BFD2EB",
"#808080")
COPINGpaletteGRAD <- c("#F5BE5E",
"#FFD284",
"#FFEED1",
"#B5B5B5",
"#DEFFF8",
"#94F6E1",
"#78D9C5")
COPINGNeuCenterpalette <- c("#78D9C5",
"#808080",
"#F5BE5E")
RAMPworseGRADpalette <- c("#78D9C5",
"#FFEED1",
"#F5BE5E",
"#FFB1B5")
GLADpalette = c("#efc00b",
"#b7dee8")
palette = COPINGpalette2
#source raw data directory: data.raw_path
source("../PANCHANGE_raw_path.R")
dat.raw <- readRDS(file = paste0(data_path, "/four_cohorts.rds"))
dim(dat.raw)
colnames(dat.raw)
dat.raw %>%
freq(
data_group_gad,
cumul = F)
dat.raw %>%
freq(
data_group_phq,
cumul = F)
dat.raw %>%
freq(
data_group_pcl,
cumul = F)
dat.raw %>%
freq(
data_group_ocir,
cumul = F)
dat <- dat.raw %>%
filter(
(data_group_gad == "Baseline and retrospective data" |
data_group_gad == "Prepandemic and baseline data" |
data_group_gad == "All prepandemic, baseline and retrospective data") |
(data_group_phq == "Baseline and retrospective data" |
data_group_phq == "Prepandemic and baseline data" |
data_group_phq == "All prepandemic, baseline and retrospective data") |
(data_group_pcl == "Baseline and retrospective data" |
data_group_pcl == "Prepandemic and baseline data" |
data_group_pcl == "All prepandemic, baseline and retrospective data") |
(data_group_ocir == "Baseline and retrospective data" |
data_group_ocir == "Prepandemic and baseline data" |
data_group_ocir == "All prepandemic, baseline and retrospective data")
)
dim(dat)
theme_personal <-  theme(
text = element_text(color = "black"),
axis.title = element_text(color = "black"),
axis.text = element_text(color = "black"),
axis.title.y = element_blank(),
legend.background = element_blank(),
legend.box.background = element_blank(),
panel.background = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_line(
colour = "gray",
linetype = "dashed",
size = 0.2
),
axis.ticks = element_blank()
)
dat %>%
group_by(Sample) %>%
summarise(Mean = mean(Age),
SD = sd(Age),
Min = min(Age),
Max = max(Age))
diff_score_cols <- dat %>%
select(contains("diff_score")) %>%
colnames()
diff_score_cols
phq.diff_score_cols <- dat %>%
select(contains("phq")) %>%
select(contains("diff_score")) %>%
colnames()
phq.diff_score_cols
gad.diff_score_cols <- dat %>%
select(contains("gad")) %>%
select(contains("diff_score")) %>%
colnames()
gad.diff_score_cols
ocir.diff_score_cols <- dat %>%
select(contains("ocir")) %>%
select(contains("diff_score")) %>%
colnames()
ocir.diff_score_cols
disorder_columns <- c(
"depressive_disorders_numeric",
"anxiety_disorders_numeric",
"eating_disorders_numeric",
"obsessive_compulsive_disorders_numeric",
"psychotic_disorders_numeric",
"mhd.mania_hypomania_bipolar_or_manicdepression_numeric",
"mhd.posttraumatic_stress_disorder_ptsd_numeric",
"mhd.autism_aspergers_or_autistic_spectrum_disorder_numeric",
"mhd.attention_deficit_hyperactivity_disorder_numeric",
"mhd.personality_disorder_numeric",
"control_numeric"
)
dat.long.psych <- dat %>%
gather(
key = "Disorder_raw",
value = "Diagnosis",
all_of(disorder_columns)) %>%
select(
ID,
Sample,
Gender,
Ethnicity,
all_of(diff_score_cols),
Disorder_raw,
Diagnosis
) %>%
mutate(Disorder =
recode_factor(
Disorder_raw,
anxiety_disorders_numeric = "Anxiety disorders",
depressive_disorders_numeric = "Depressive disorders",
eating_disorders_numeric = "Eating disorders",
obsessive_compulsive_disorders_numeric = "OCDs",
psychotic_disorders_numeric = "Psychotic disorders",
mhd.mania_hypomania_bipolar_or_manicdepression_numeric = "Bipolar disorders",
mhd.posttraumatic_stress_disorder_ptsd_numeric = "PTSD",
mhd.autism_aspergers_or_autistic_spectrum_disorder_numeric = "Autism",
mhd.attention_deficit_hyperactivity_disorder_numeric = "ADHD",
mhd.personality_disorder_numeric = "Personality disorders",
control_numeric = "Controls"
))
head(dat.long.psych)
Disorder_by_Gender <- dat.long.psych %>%
filter(Diagnosis == 1) %>%
group_by(Disorder, Gender) %>%
count(Disorder)
Disorder_by_Gender
Disorder_by_Gender %>%
ggplot(mapping = aes(
x = Disorder,
y = n)
) +
geom_bar(
aes(fill = Gender),
#    position = "dodge",
stat="identity",
binwidth = 1,
position = position_dodge2(preserve = "single")
) +
labs(
x = "Disorder",
y = "Number of participants",
fill = "Gender") +
theme_personal +
scale_fill_manual(
values = COPINGpalette4,
#    labels = c("Prepandemic", "Retrospective")
) +
coord_flip()
Disorder_by_Sample <- dat.long.psych %>%
filter(Diagnosis == 1) %>%
group_by(Disorder, Sample) %>%
count(Disorder)
Disorder_by_Sample %>%
ggplot(mapping = aes(
x = Disorder,
y = n)
) +
geom_bar(
aes(fill = Sample),
#    position = "dodge",
stat="identity",
binwidth = 1,
position = position_dodge2(preserve = "single")
) +
labs(
x = "Disorder",
y = "Number of participants",
fill = "Sample") +
theme_personal +
scale_fill_manual(
values = COPINGpalette4,
#    labels = c("Prepandemic", "Retrospective")
) +
coord_flip()
Disorder_by_Ethnicity <- dat.long.psych %>%
filter(Diagnosis == 1) %>%
group_by(Disorder, Ethnicity) %>%
count(Disorder)
Disorder_by_Ethnicity %>%
ggplot(mapping = aes(
x = Disorder,
y = n)
) +
geom_bar(
aes(fill = Ethnicity),
#    position = "dodge",
stat="identity",
binwidth = 1,
position = position_dodge2(preserve = "single")
) +
labs(
x = "Disorder",
y = "Number of participants",
fill = "Ethnicity") +
theme_personal +
scale_fill_manual(
values = COPINGpalette6,
#    labels = c("Prepandemic", "Retrospective")
) +
coord_flip()
Ethnicity_by_Sample <- dat %>%
group_by(Ethnicity, Sample) %>%
count(Ethnicity)
Ethnicity_by_Sample
Ethnicity_by_Sample %>%
ggplot(mapping = aes(
x = Ethnicity,
y = n)
) +
geom_bar(
aes(fill = Sample),
#    position = "dodge",
stat="identity",
binwidth = 1,
position = position_dodge2(preserve = "single")
) +
labs(
x = "Ethnicity",
y = "Number of participants",
fill = "Sample") +
theme_personal +
scale_fill_manual(
values = COPINGpalette6,
#    labels = c("Prepandemic", "Retrospective")
) +
coord_flip()
dat %>%
group_by(Gender, Sample) %>%
count(Gender)
dat %>%
group_by(highest_education, Sample) %>%
count(highest_education)
dat %>%
group_by(key_worker, Sample) %>%
count(key_worker)
dat %>%
group_by(respiratory.throat_swab_test_nose, Sample) %>%
count(respiratory.throat_swab_test_nose)
dat %>%
group_by(respiratory.results_antibody_test, Sample) %>%
count(respiratory.results_antibody_test)
dat %>%
group_by(covid_probable_case_incl_screening, Sample) %>%
count(covid_probable_case_incl_screening)
dat.long.gad.diff <- dat %>%
gather(
key = "Time_point_raw",
value = "gad.diff_score",
all_of(gad.diff_score_cols)) %>%
select(
ID,
Sample,
Gender,
Ethnicity,
Time_point_raw,
gad.diff_score
) %>%
mutate(Time_point = str_replace(Time_point_raw, "gad.diff_score_", "")) %>%
select(-Time_point_raw)
head(dat.long.gad.diff)
dat.long.gad.diff %>%
ggplot(mapping = aes(y = gad.diff_score)) +
geom_bar() +
theme_minimal() +
facet_wrap(facets = vars(Time_point))
dat.long.gad.diff %>%
filter(Time_point != "prepan_retro") %>%
ggplot(mapping = aes(
x = gad.diff_score,
y = stat(density*width),
fill = Time_point)) +
geom_histogram(
binwidth = 1,
position = position_dodge2(preserve = "single")
) +
labs(
x = "Difference GAD7 score",
y = "Percentage of participants",
fill = "Comparison:\nBaseline vs") +
theme_personal +
scale_fill_manual(values = palette, labels = c("Prepandemic", "Retrospective"))
dat.long.gad.diff %>%
filter(Time_point == "prepan_retro") %>%
ggplot(mapping = aes(
x = gad.diff_score,
y = stat(density*width),
fill = Time_point)) +
geom_histogram(
binwidth = 1,
position = position_dodge2(preserve = "single")
) +
labs(
x = "Difference GAD7 score",
y = "Percentage of participants",
fill = "Comparison:\nPrepandemic vs") +
theme_personal +
scale_fill_manual(values = palette, labels = c("Retrospective"))
dat.long.phq.diff <- dat %>%
gather(
key = "Time_point_raw",
value = "phq.diff_score",
all_of(phq.diff_score_cols)) %>%
select(
ID,
Sample,
Gender,
Ethnicity,
Time_point_raw,
phq.diff_score
) %>%
mutate(Time_point = str_replace(Time_point_raw, "phq.diff_score_", "")) %>%
select(-Time_point_raw) %>%
drop_na(phq.diff_score)
head(dat.long.phq.diff)
dat.long.phq.diff %>%
filter(Time_point != "prepan_retro") %>%
ggplot(mapping = aes(
x = phq.diff_score,
y = stat(density*width),
fill = Time_point)) +
geom_histogram(
binwidth = 1,
position = position_dodge2(preserve = "single")
) +
theme_minimal()
dat.long.phq.diff %>%
filter(Time_point == "prepan_retro") %>%
ggplot(mapping = aes(
x = phq.diff_score,
y = stat(density*width),
fill = Time_point)) +
geom_histogram(
binwidth = 1,
position = position_dodge2(preserve = "single")
) +
theme_minimal()
dat.long.ocir.diff <- dat %>%
gather(
key = "Time_point_raw",
value = "ocir.diff_score",
all_of(ocir.diff_score_cols)) %>%
select(
ID,
Sample,
Gender,
Ethnicity,
Time_point_raw,
ocir.diff_score
) %>%
mutate(Time_point = str_replace(Time_point_raw, "ocir.diff_score_", "")) %>%
select(-Time_point_raw)
head(dat.long.ocir.diff)
dat.long.ocir.diff %>%
ggplot(mapping = aes(y = ocir.diff_score)) +
geom_bar() +
theme_minimal() +
facet_wrap(facets = vars(Time_point))
gad.diff_score_prepan_base_plot <- dat %>%
ggplot(mapping = aes(y = gad.diff_score_prepan_base)) +
geom_bar() +
theme_minimal()
gad.diff_score_prepan_retro_plot <- dat %>%
ggplot(mapping = aes(y = gad.diff_score_prepan_retro)) +
geom_bar() +
theme_minimal()
gad.diff_score_prepan_base_plot <- dat %>%
ggplot(mapping = aes(y = gad.diff_score_prepan_base)) +
geom_bar() +
theme_minimal()
gad.diff_score_prepan_base_plot /
gad.diff_score_prepan_retro_plot /
gad.diff_score_prepan_base_plot +
plot_layout(guides = "collect", heights = c(1,1,1)) +
plot_annotation(tag_levels = "A")
