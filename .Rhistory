dat.retro_september_sign_up)
#Gather the variables
dat.retro_sign_up <- dat.retro_sign_up %>%
gather(key = "month", value = "n")
dat.retro_sign_up
#Merge results into one tibble
dat.retro_sign_up <- dat.retro_april_sign_up %>%
left_join(dat.retro_may_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_june_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_july_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_august_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_september_sign_up,
by = "Sample_plot")
#Gather the variables
dat.retro_sign_up <- dat.retro_sign_up %>%
gather(key = "month", value = "n")
dat.retro_sign_up
dat.retro_sign_up <- dat.retro_april_sign_up %>%
left_join(dat.retro_may_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_june_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_july_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_august_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_september_sign_up,
by = "Sample_plot")
dat.retro_sign_up
#Gather the variables
dat.retro_sign_up <- dat.retro_sign_up %>%
gather(key = "month", value = "n")
dat.retro_sign_up
dat.retro_sign_up <- dat.retro_april_sign_up %>%
left_join(dat.retro_may_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_june_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_july_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_august_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_september_sign_up,
by = "Sample_plot")
dat.retro_sign_up
#Gather the variables
dat.retro_sign_up <- dat.retro_sign_up %>%
gather(key = "month",
value = "n",
c(-Sample_plot))
dat.retro_sign_up
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black"))
dat.retro_employment_plot %>%
ggplot(aes(x = employment_prior_covid, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
labs(x = "Employment status",
y = "N participants") +
theme(legend.position = "bottom") +
theme(legend.title = element_blank()) +
scale_y_continuous(breaks = seq(0, 6000, by = 1000)) +
theme(axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
geom_text(aes(label = stat(y), group = Sample_plot),
stat = "summary",
fun = sum,
vjust = -1,
colour = "black")
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
geom_text(aes(label = stat(y), group = Sample_plot),
stat = "summary",
fun = sum,
vjust = -1,
colour = "black")
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
geom_text(aes(label = stat(y), group = Sample_plot),
stat = "summary",
fun = sum,
vjust = -1,
colour = "black")
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
geom_text(aes(label = stat(y), group = month),
stat = "summary",
fun = sum,
vjust = -1,
colour = "black")
dat.retro_sign_up
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
geom_text(aes(label = stat(y), group = month),
stat = "summary",
fun = sum,
vjust = -1,
colour = "black")
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
geom_text(aes(label = stat(y), group = sample_plot),
stat = "summary",
fun = sum,
vjust = -1,
colour = "black")
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
geom_text(aes(label = stat(y), group = Sample_plot),
stat = "summary",
fun = sum,
vjust = -1,
colour = "black")
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot, label = n)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
geom_text(aes(label = stat(y), group = Sample_plot),
stat = "summary",
fun = sum,
vjust = -1,
colour = "black")
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
geom_text(aes(label = n),
size = 3,
position = position_dodge(width=0.9),
vjust=-0.25)
dat.retro_may_sign_up
dat.retro_sign_up
dat.retro_sign_up$month <- factor(dat.retro_sign_up$month,
levels = c("April", "May", "June", "July", "August",
"September"))
dat.retro_sign_up
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
geom_text(aes(label = n),
size = 3,
position = position_dodge(width=0.9),
vjust=-0.25)
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
scale_y_continuous(breaks = seq(0, 15000, by = 2500)) +
geom_text(aes(label = n),
size = 3,
position = position_dodge(width=0.9),
vjust=-0.25)
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
geom_text(aes(label = n),
size = 3,
position = position_dodge(width=0.9),
vjust=-0.25)
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
scale_y_continuous(breaks = seq(0, 15000, by = 2500)) +
geom_text(aes(label = n),
size = 3,
position = position_dodge(width=0.9),
vjust=-0.25)
knitr::opts_chunk$set(echo = TRUE)
remove(list = ls())
#install.packages("multipanelfigure")
# Read in data
library(knitr)
library(summarytools)
library(psych)
library(polycor)
library(corrplot)
library(patchwork)
library(broom)
library(tidyverse)
library(ggpubr)
library(cowplot)
library(gridExtra)
# get file info
source("../PANCHANGE_raw_path.R")
alldat <- readRDS(file = paste0(data_path, "/four_cohorts_variables_exclusion.rds"))
COPINGpalette2 <- c("#78D9C5",
"#F5BE5E")
COPINGpalette3 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9")
COPINGpalette4 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73")
COPINGpalette5 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73",
"#FFED98")
COPINGpalette6 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73",
"#FFED98",
"#BFD2EB")
COPINGpalette7 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73",
"#FFED98",
"#BFD2EB",
"#808080")
COPINGpalette9 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73",
"#FFED98",
"#BFD2EB",
"#808080",
"#cccccc",
"3B47DA")
COPINGpalette11 <- c("#78D9C5",
"#F5BE5E",
"#EEB6E9",
"#DBDB73",
"#FFED98",
"#BFD2EB",
"#808080",
"#cccccc",
"3B47DA",
"#b7dee8",
"#F567F3")
COPINGpaletteGRAD <- c("#F5BE5E",
"#FFD284",
"#FFEED1",
"#B5B5B5",
"#DEFFF8",
"#94F6E1",
"#78D9C5")
COPINGNeuCenterpalette <- c("#78D9C5",
"#808080",
"#F5BE5E")
RAMPworseGRADpalette <- c("#78D9C5",
"#FFEED1",
"#F5BE5E",
"#FFB1B5")
GLADpalette = c("#efc00b",
"#b7dee8")
# impute retro for those who did not change
alldat$gad.sum_score_retro <- ifelse(alldat$gad.pandemic_felt_feelings == "No different", alldat$gad.sum_score_base,alldat$gad.sum_score_retro)
alldat$phq.sum_score_retro <- ifelse(alldat$phq.pandemic_felt_feelings == "No different", alldat$phq.sum_score_base,alldat$phq.sum_score_retro)
dat.retro <- alldat %>%
filter(
((data_group_gad == "Baseline and retrospective data" |
data_group_gad == "All prepandemic, baseline and retrospective data") |
(data_group_phq == "Baseline and retrospective data" |
data_group_phq == "All prepandemic, baseline and retrospective data") |
(data_group_pcl == "Baseline data only" |
data_group_pcl == "Baseline and retrospective data" |
data_group_pcl == "Prepandemic and baseline data" |
data_group_pcl == "All prepandemic, baseline and retrospective data"))
)
dim(dat.retro)
dat.prepan <- alldat %>%
filter(
((data_group_gad == "Prepandemic and baseline data" |
data_group_gad == "All prepandemic, baseline and retrospective data") |
(data_group_phq == "Prepandemic and baseline data" |
data_group_phq == "All prepandemic, baseline and retrospective data") |
(data_group_pcl == "Prepandemic and baseline data" |
data_group_pcl == "All prepandemic, baseline and retrospective data") ) &
prepandemic_march_1_numeric == 1 # Exclude participants that signed up after the 1. March
)
dim(dat.prepan)
## Subset samples by study
GLAD.prepan <- dat.prepan %>%
filter(Sample == "GLAD" |
Sample == "EDGI")
NBR.prepan <- dat.prepan %>%
filter(Sample == "NBR")
RAMP.prepan <- dat.prepan %>%
filter(Sample == "RAMP")
### retro
GLAD.retro <- dat.retro %>%
filter(Sample == "GLAD" |
Sample == "EDGI")
NBR.retro <- dat.retro %>%
filter(Sample == "NBR")
RAMP.retro <- dat.retro %>%
filter(Sample == "RAMP")
#Merge GLAD and EDGI Samples into one sample
dat.retro <- dat.retro %>%
mutate(Sample_plot =
case_when(
dat.retro$Sample == "GLAD" ~ "GLAD/EDGI",
dat.retro$Sample == "EDGI" ~ "GLAD/EDGI",
dat.retro$Sample == "NBR" ~ "NBR",
dat.retro$Sample == "RAMP" ~ "RAMP"
))
#Check that it worked
dat.retro %>%
group_by(Sample_plot) %>%
summarise(N = n())
#Visualise some dates when participants completed the questionnaire
head(dat.retro$startDate.coping, 10)
#Divide the data by sign up per month and summarise the amount of pt's completing the survey that month
dat.retro_april_sign_up <- dat.retro[str_detect(dat.retro$startDate.coping, "-04-"), ] %>%
select(Sample_plot, startDate.coping) %>%
group_by(Sample_plot) %>%
summarise(April = n())
dat.retro_may_sign_up <- dat.retro[str_detect(dat.retro$startDate.coping, "-05-"), ] %>%
select(Sample_plot, startDate.coping) %>%
group_by(Sample_plot) %>%
summarise(May = n())
dat.retro_june_sign_up <- dat.retro[str_detect(dat.retro$startDate.coping, "-06-"), ] %>%
select(Sample_plot, startDate.coping) %>%
group_by(Sample_plot) %>%
summarise(June = n())
dat.retro_july_sign_up <- dat.retro[str_detect(dat.retro$startDate.coping, "-07-"), ] %>%
select(Sample_plot, startDate.coping) %>%
group_by(Sample_plot) %>%
summarise(July = n())
dat.retro_august_sign_up <- dat.retro[str_detect(dat.retro$startDate.coping, "-08-"), ] %>%
select(Sample_plot, startDate.coping) %>%
group_by(Sample_plot) %>%
summarise(August = n())
dat.retro_september_sign_up <- dat.retro[str_detect(dat.retro$startDate.coping, "-09-"), ] %>%
select(Sample_plot, startDate.coping) %>%
group_by(Sample_plot) %>%
summarise(September = n())
sign_up_NBR_empty_row_April <- tibble(
Sample_plot = "NBR",
April = 0
)
sign_up_NBR_empty_row_August <- tibble(
Sample_plot = "NBR",
August = 0
)
sign_up_NBR_empty_row_September <- tibble(
Sample_plot = "NBR",
September = 0
)
dat.retro_april_sign_up <- dat.retro_april_sign_up %>%
rbind(sign_up_NBR_empty_row_April)
dat.retro_august_sign_up <- dat.retro_august_sign_up %>%
rbind(sign_up_NBR_empty_row_August)
dat.retro_september_sign_up <- dat.retro_september_sign_up %>%
rbind(sign_up_NBR_empty_row_September)
#Merge results into one tibble
dat.retro_sign_up <- dat.retro_april_sign_up %>%
left_join(dat.retro_may_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_june_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_july_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_august_sign_up,
by = "Sample_plot")
dat.retro_sign_up <- dat.retro_sign_up %>%
left_join(dat.retro_september_sign_up,
by = "Sample_plot")
#Gather the variables
dat.retro_sign_up <- dat.retro_sign_up %>%
gather(key = "month",
value = "n",
c(-Sample_plot))
dat.retro_sign_up$month <- factor(dat.retro_sign_up$month,
levels = c("April", "May", "June", "July", "August",
"September"))
dat.retro_sign_up %>%
ggplot(aes(x = month, y = n, fill = Sample_plot)) +
geom_bar(stat = "identity", position = "dodge") +
scale_fill_manual(values = COPINGpalette3) +
theme_classic() +
labs(x = "Month of sign up",
y = "N participants") +
theme(legend.position = "top",
legend.title = element_blank(),
axis.text.x = element_text(colour = "black"),
axis.text.y = element_text(colour = "black")) +
scale_y_continuous(breaks = seq(0, 15000, by = 2500)) +
geom_text(aes(label = n),
size = 3,
position = position_dodge(width=0.9),
vjust=-0.25)
