---
title: "Placeholder"
author: "Steven Bright"
date: "05/02/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Clean environment}

remove(list = ls())

```


# Set up 
 
```{r read in data } 

# Read in data
library(knitr)
library(summarytools)
library(psych)
library(polycor)
library(corrplot)
library(patchwork)
library(broom)
library(tidyverse)
library(ggpubr)


# get file info
source("../PANCHANGE_raw_path.R")


alldat <-  readRDS(file = paste0(data_path, "/four_cohorts_variables_exclusion.rds"))

```


```{r Colour palettes: COPING}

COPINGpalette2 <- c("#78D9C5",
                    "#F5BE5E")

COPINGpalette3 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9")

COPINGpalette4 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73")

COPINGpalette5 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73", 
                    "#FFED98")

COPINGpalette6 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73",
                    "#FFED98",
                    "#BFD2EB")

COPINGpalette7 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73", 
                    "#FFED98",
                    "#BFD2EB", 
                    "#808080")

COPINGpalette9 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73", 
                    "#FFED98",
                    "#BFD2EB", 
                    "#808080",
                    "#cccccc",
                    "3B47DA")

COPINGpaletteGRAD <- c("#F5BE5E",
                       "#FFD284",
                       "#FFEED1",
                       "#B5B5B5",
                       "#DEFFF8",
                       "#94F6E1",
                       "#78D9C5")

COPINGNeuCenterpalette <- c("#78D9C5",
                            "#808080",
                            "#F5BE5E")

RAMPworseGRADpalette <- c("#78D9C5",
                          "#FFEED1",
                          "#F5BE5E",
                          "#FFB1B5")
GLADpalette = c("#efc00b", 
                "#b7dee8")  
```


# Impute and subset data

Impute retrospective scores if no change reported

```{r impute retro}

# impute retro for those who did not change

alldat$gad.sum_score_retro <- ifelse(alldat$gad.pandemic_felt_feelings == "No different", alldat$gad.sum_score_base,alldat$gad.sum_score_retro)

alldat$phq.sum_score_retro <- ifelse(alldat$phq.pandemic_felt_feelings == "No different", alldat$phq.sum_score_base,alldat$phq.sum_score_retro)

```


subsample for retro-baseline analysis
exclude those who do not have complete responses for both baseline and retrospective
in addition to those already excluded for NA in age, gender and MH diagnosis.

RETROSPECTIVE
```{r subset retrospective data }

dat.retro <- alldat %>%
  filter(
    ((data_group_gad == "Baseline and retrospective data" |
        data_group_gad == "All prepandemic, baseline and retrospective data") |
       (data_group_phq == "Baseline and retrospective data" |
          data_group_phq == "All prepandemic, baseline and retrospective data") |
        (data_group_pcl == "Baseline data only" |
           data_group_pcl == "Baseline and retrospective data" |
            data_group_pcl == "Prepandemic and baseline data" |
      data_group_pcl == "All prepandemic, baseline and retrospective data"))
  )

dim(dat.retro)

```


subsample for prepan-baseline analysis
exclude those who do not have complete responses for both baseline and prepandemic
in addition to those already excluded for NA in age, gender and MH diagnosis.

PREPANDEMIC
```{r subset prepandemic}

dat.prepan <- alldat %>%
  filter(
    ((data_group_gad == "Prepandemic and baseline data" |
        data_group_gad == "All prepandemic, baseline and retrospective data") |
       (data_group_phq == "Prepandemic and baseline data" |
          data_group_phq == "All prepandemic, baseline and retrospective data") |
       (data_group_pcl == "Prepandemic and baseline data" |
          data_group_pcl == "All prepandemic, baseline and retrospective data") ) &
      prepandemic_march_1_numeric == 1 # Exclude participants that signed up after the 1. March
  )

dim(dat.prepan)

```


Subset by study

```{r subset by study}

## Subset samples by study

GLAD.prepan <- dat.prepan %>%
  filter(Sample == "GLAD" | 
           Sample == "EDGI")

NBR.prepan <- dat.prepan %>%
  filter(Sample == "NBR")

RAMP.prepan <- dat.prepan %>%
  filter(Sample == "RAMP")

### retro
GLAD.retro <- dat.retro %>%
  filter(Sample == "GLAD" | 
           Sample == "EDGI")

NBR.retro <- dat.retro %>%
  filter(Sample == "NBR")

RAMP.retro <- dat.retro %>%
  filter(Sample == "RAMP")

```

#Histograms

```{r Merge GLAD/EDGI samples together for plot}

#Merge GLAD and EDGI Samples into one sample

dat.retro <- dat.retro %>% 
  mutate(Sample_plot = 
           case_when(
             dat.retro$Sample == "GLAD" ~ "GLAD/EDGI",
             dat.retro$Sample == "EDGI" ~ "GLAD/EDGI",
             dat.retro$Sample == "NBR" ~ "NBR",
             dat.retro$Sample == "RAMP" ~ "RAMP"
           ))

#Check that it worked

dat.retro %>% 
  group_by(Sample_plot) %>% 
  summarise(N = n())

```

##Gender
###Prepan

```{r GLAD/EDGI gender prepan}

GLAD.prepan %>%
  ggplot(aes(x = Gender)) +
  geom_bar(fill = COPINGpalette4) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(title = "Gender distribution of the GLAD/EDGI prepan cohort",
       subtitle = paste("N =", dim(GLAD.prepan)[1]),
       x = "",
       y = "N participants")
  
```

###Retrospective

```{r GLAD/EDGI gender retro}

GLAD.retro %>%
  ggplot(aes(x = Gender)) +
  geom_bar(fill = COPINGpalette4) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(title = "Gender distribution of the GLAD/EDGI retro cohort",
       subtitle = paste("N =", dim(GLAD.retro)[1]),
       x = "",
       y = "N participants")

```

```{r NBR gender retro}

NBR.retro %>%
  ggplot(aes(x = Gender)) +
  geom_bar(fill = COPINGpalette4) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(title = "Gender distribution of the NBR retro cohort",
       subtitle = paste("N =", dim(NBR.retro)[1]),
       x = "",
       y = "N participants")

```

```{r RAMP gender retro}

RAMP.retro %>%
  ggplot(aes(x = Gender)) +
  geom_bar(fill = COPINGpalette4) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(title = "Gender distribution of the RAMP retro cohort",
       subtitle = paste("N =", dim(RAMP.retro)[1]),
       x = "",
       y = "N participants")

```


```{r Retro gender together}

dat.retro %>% 
  ggplot(aes(x = Gender, fill = Sample_plot)) +
  geom_bar(position = "dodge") +
  scale_fill_manual(values = COPINGpalette4) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(title = "Gender distribution of the retro cohorts",
       x = "",
       y = "") +
  theme(legend.position = "bottom") + 
  theme(legend.title = element_blank())

```


##Age
###Prepan

```{r GLAD/EDGI age prepan}

GLAD.prepan %>% 
  ggplot(aes(x = age_category_collapsed)) +
  geom_bar(fill = COPINGpalette9) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(title = "Age distribution of the GLAD/EDGI prepan cohort",
       subtitle = paste("N =", dim(GLAD.prepan)[1]),
       x = "",
       y = "")

```

###Retro

```{r GLAD/EDGI NBR and RAMP age}

dat.retro %>% 
  ggplot(aes(x = age_category_collapsed, fill = Sample_plot)) +
  geom_bar(position = "dodge") +
  scale_fill_manual(values = COPINGpalette3) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(title = "Age distribution of the retro cohorts",
       x = "",
       y = "") +
  theme(legend.position = "bottom") + 
  theme(legend.title = element_blank())

```

##Ethinicity
###Prepan

```{r GLAD/EDGI ethnicity prepan}

GLAD.prepan %>% 
  ggplot(aes(x = Ethnicity_collapsed)) +
  geom_bar(fill = COPINGpalette6) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(title = "Ethnic distribution of the GLAD/EDGI prepan cohort",
       subtitle = paste("N =", dim(GLAD.prepan)[1]),
       x = "",
       y = "N participants") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2))

```

###Retro

```{r GLAD/EDGI NBR and RAMP ethnicity}

dat.retro %>% 
  ggplot(aes(x = Ethnicity_collapsed, fill = Sample_plot)) +
  geom_bar(position = "dodge") +
  scale_fill_manual(values = COPINGpalette3) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(title = "Ethnic distribution of the retro cohorts",
       x = "",
       y = "") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme(legend.position = "bottom") + 
  theme(legend.title = element_blank())

```

##Employment
###Prepan

```{r GLAD/EDGI employment prepan}

GLAD.prepan %>% 
  ggplot(aes(x = employment_prior_covid)) +
  geom_bar(fill = COPINGpalette6) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(title = "Employment of the GLAD/EDGI prepan cohort",
       subtitle = paste("N =", dim(GLAD.prepan)[1]),
       x = "",
       y = "")

```

###Retro

```{r GLAD/EDGI NBR and RAMP retro employment}

dat.retro %>% 
  ggplot(aes(x = employment_prior_covid, fill = Sample_plot)) +
  geom_bar(position = "dodge") +
  scale_fill_manual(values = COPINGpalette3) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(title = "Employment distribution of the retro cohorts",
       x = "",
       y = "") +
  theme(legend.position = "bottom") + 
  theme(legend.title = element_blank())

```

##Diagnoses

```{r Collapse personality disorder clusters for prepan data}

GLAD.prepan <- GLAD.prepan %>% 
  mutate(personality_disorder_numeric =
           case_when(
             personality_cluster_a_numeric == 1 | personality_cluster_b_numeric == 1 | personality_cluster_c_numeric == 1 ~ 1,
             personality_cluster_a_numeric == 0 & personality_cluster_b_numeric == 0 & personality_cluster_c_numeric == 0 ~ 0
           ))

#Check that it worked
head(GLAD.prepan$personality_cluster_a_numeric, 15)
head(GLAD.prepan$personality_cluster_b_numeric, 15)
head(GLAD.prepan$personality_cluster_c_numeric, 15)
head(GLAD.prepan$personality_disorder_numeric, 15)

```

```{r Collapse personality disorder clusters for retro data}

dat.retro <- dat.retro %>% 
  mutate(personality_disorder_numeric =
           case_when(
             personality_cluster_a_numeric == 1 | personality_cluster_b_numeric == 1 | personality_cluster_c_numeric == 1 ~ 1,
             personality_cluster_a_numeric == 0 & personality_cluster_b_numeric == 0 & personality_cluster_c_numeric == 0 ~ 0
           ))

#Check that it worked
head(dat.retro$personality_cluster_a_numeric, 15)
head(dat.retro$personality_cluster_b_numeric, 15)
head(dat.retro$personality_cluster_c_numeric, 15)
head(dat.retro$personality_disorder_numeric, 15)

```
###Prepan

```{r Get depression positive for GLAD/EDGI}

GLAD.prepan_mdd_positive <- GLAD.prepan %>%
  select(depressive_disorders_numeric) %>% 
  filter(depressive_disorders_numeric == 1)
  
GLAD.prepan_mdd_positive <- GLAD.prepan_mdd_positive %>% 
  summarise("Depressive disorders" = n())

```

```{r Get anxiety positive for GLAD/EDGI}

GLAD.prepan_anxi_positive <- GLAD.prepan %>%
  select(anxiety_disorders_numeric) %>% 
  filter(anxiety_disorders_numeric == 1)
  
GLAD.prepan_anxi_positive <- GLAD.prepan_anxi_positive %>% 
  summarise("Anxiety disorders" = n())

```

```{r Get eating disorders positive for GLAD/EDGI}

GLAD.prepan_ED_positive <- GLAD.prepan %>%
  select(eating_disorders_numeric) %>% 
  filter(eating_disorders_numeric == 1)
  
GLAD.prepan_ED_positive <- GLAD.prepan_ED_positive %>% 
  summarise("Eating disorders" = n())

```

```{r Get OCDs positive for GLAD/EDGI}

GLAD.prepan_OCD_positive <- GLAD.prepan %>%
  select(obsessive_compulsive_disorders_numeric) %>% 
  filter(obsessive_compulsive_disorders_numeric == 1)
  
GLAD.prepan_OCD_positive <- GLAD.prepan_OCD_positive %>% 
  summarise("OCDs" = n())

```

```{r Get psychosis positive for GLAD/EDGI}

GLAD.prepan_psychosis_positive <- GLAD.prepan %>%
  select(psychotic_disorders_numeric) %>% 
  filter(psychotic_disorders_numeric == 1)
  
GLAD.prepan_psychosis_positive <- GLAD.prepan_psychosis_positive %>% 
  summarise("Psychotic disorders" = n())

```

```{r Get ASD positive for GLAD/EDGI}

GLAD.prepan_ASD_positive <- GLAD.prepan %>%
  select(autism_spectrum_disorder_numeric) %>% 
  filter(autism_spectrum_disorder_numeric == 1)
  
GLAD.prepan_ASD_positive <- GLAD.prepan_ASD_positive %>% 
  summarise("ASD" = n())

```

```{r Get ADHD positive for GLAD/EDGI}

GLAD.prepan_ADHD_positive <- GLAD.prepan %>%
  select(mhd.attention_deficit_hyperactivity_disorder_numeric) %>% 
  filter(mhd.attention_deficit_hyperactivity_disorder_numeric == 1)
  
GLAD.prepan_ADHD_positive <- GLAD.prepan_ADHD_positive %>% 
  summarise("ADHD" = n())

```

```{r Get PD positive for GLAD/EDGI}

GLAD.prepan_PD_positive <- GLAD.prepan %>%
  select(personality) %>% 
  filter(psychotic_disorders_numeric == 1)
  
GLAD.prepan_psychosis_positive <- GLAD.prepan_psychosis_positive %>% 
  summarise("Psychotic disorders" = n())

```

###Retro

```{r Get MDD positive by sample}

dat.retro_mdd_by_sample <- dat.retro %>%
  group_by(Sample_plot) %>% 
  select(depressive_disorders_numeric) %>% 
  filter(depressive_disorders_numeric == 1)
  
dat.retro_mdd_by_sample <- dat.retro_mdd_by_sample %>% 
  group_by(Sample_plot) %>% 
  summarise("Depressive disorders" = n())

```


```{r Get anxiety positive by sample}

dat.retro_anxi_by_sample <- dat.retro %>%
  group_by(Sample_plot) %>% 
  select(anxiety_disorders_numeric) %>% 
  filter(anxiety_disorders_numeric == 1)
  
dat.retro_anxi_by_sample <- dat.retro_anxi_by_sample %>% 
  group_by(Sample_plot) %>% 
  summarise("Anxiety disorders" = n())

```

```{r Get eating disorder positive by sample}

dat.retro_ED_by_sample <- dat.retro %>%
  group_by(Sample_plot) %>% 
  select(eating_disorders_numeric) %>% 
  filter(eating_disorders_numeric == 1)
  
dat.retro_ED_by_sample <- dat.retro_ED_by_sample %>% 
  group_by(Sample_plot) %>% 
  summarise("Eating disorders" = n())

```


```{r Get OCDs positive by sample}

dat.retro_OCD_by_sample <- dat.retro %>%
  group_by(Sample_plot) %>% 
  select(obsessive_compulsive_disorders_numeric) %>% 
  filter(obsessive_compulsive_disorders_numeric == 1)
  
dat.retro_OCD_by_sample <- dat.retro_OCD_by_sample %>% 
  group_by(Sample_plot) %>% 
  summarise("OCDs" = n())

```


```{r Get psychotic disorder positive by sample}

dat.retro_psychosis_by_sample <- dat.retro %>%
  group_by(Sample_plot) %>% 
  select(psychotic_disorders_numeric) %>% 
  filter(psychotic_disorders_numeric == 1)
  
dat.retro_psychosis_by_sample <- dat.retro_psychosis_by_sample %>% 
  group_by(Sample_plot) %>% 
  summarise("Psychotic disorders" = n())

```


```{r Get ASD positive by sample}

dat.retro_ASD_by_sample <- dat.retro %>%
  group_by(Sample_plot) %>% 
  select(autism_spectrum_disorder_numeric) %>% 
  filter(autism_spectrum_disorder_numeric == 1)
  
dat.retro_ASD_by_sample <- dat.retro_ASD_by_sample %>% 
  group_by(Sample_plot) %>% 
  summarise("ASD" = n())

```


```{r Get ADHD positive by sample}

dat.retro_ADHD_by_sample <- dat.retro %>%
  group_by(Sample_plot) %>% 
  select(mhd.attention_deficit_hyperactivity_disorder_numeric) %>% 
  filter(mhd.attention_deficit_hyperactivity_disorder_numeric == 1)
  
dat.retro_ADHD_by_sample <- dat.retro_ADHD_by_sample %>% 
  group_by(Sample_plot) %>% 
  summarise("ADHD" = n())

```


```{r Get personality disorders positive by sample}

dat.retro_PD_by_sample <- dat.retro %>%
  group_by(Sample_plot) %>% 
  select(personality_disorder_numeric) %>% 
  filter(personality_disorder_numeric == 1)
  
dat.retro_PD_by_sample <- dat.retro_PD_by_sample %>% 
  group_by(Sample_plot) %>% 
  summarise("Personality disorders" = n())

```


```{r Get Bipolar disorders positive by sample}

dat.retro_BD_by_sample <- dat.retro %>%
  group_by(Sample_plot) %>% 
  select(mhd.mania_hypomania_bipolar_or_manicdepression_numeric) %>% 
  filter(mhd.mania_hypomania_bipolar_or_manicdepression_numeric == 1)
  
dat.retro_BD_by_sample <- dat.retro_BD_by_sample %>% 
  group_by(Sample_plot) %>% 
  summarise("Bipolar disorders" = n())

```


```{r Get PTSD positive by sample}

dat.retro_PTSD_by_sample <- dat.retro %>%
  group_by(Sample_plot) %>% 
  select(mhd.posttraumatic_stress_disorder_ptsd_numeric) %>% 
  filter(mhd.posttraumatic_stress_disorder_ptsd_numeric == 1)
  
dat.retro_PTSD_by_sample <- dat.retro_PTSD_by_sample %>% 
  group_by(Sample_plot) %>% 
  summarise("PTSD" = n())

```


```{r Get control positive by sample}

dat.retro_control_by_sample <- dat.retro %>%
  group_by(Sample_plot) %>% 
  select(control_numeric) %>% 
  filter(control_numeric == 1)
  
dat.retro_control_by_sample <- dat.retro_control_by_sample %>% 
  group_by(Sample_plot) %>% 
  summarise("No diagnosis" = n())

```


```{r Merge the positive sample/diagnosis tibbles}

dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_mdd_by_sample,
                                                    dat.retro_anxi_by_sample,
                                                    by = "Sample_plot")

dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
                                                    dat.retro_ED_by_sample,
                                                    by = "Sample_plot")

dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
                                                    dat.retro_OCD_by_sample,
                                                    by = "Sample_plot")

dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
                                                    dat.retro_psychosis_by_sample,
                                                    by = "Sample_plot")

dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
                                                    dat.retro_ASD_by_sample,
                                                    by = "Sample_plot")

dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
                                                    dat.retro_ADHD_by_sample,
                                                    by = "Sample_plot")

dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
                                                    dat.retro_PD_by_sample,
                                                    by = "Sample_plot")

dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
                                                    dat.retro_BD_by_sample,
                                                    by = "Sample_plot")

dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
                                                    dat.retro_PTSD_by_sample,
                                                    by = "Sample_plot")

dat.retro_positive_diagnosis_by_sample <- left_join(dat.retro_positive_diagnosis_by_sample,
                                                    dat.retro_control_by_sample,
                                                    by = "Sample_plot")

head(dat.retro_positive_diagnosis_by_sample)

```


```{r Re-organise the positive diagnosis by sample tib}

dat.retro_positive_diagnosis_by_sample <- dat.retro_positive_diagnosis_by_sample %>% 
  gather('Depressive disorders', 'Anxiety disorders', 'Eating disorders', 'OCDs', 'Psychotic disorders', 'ASD', 'ADHD', 'Personality disorders', 'Bipolar disorders', 'PTSD', 'No diagnosis', key = "Diagnosis", value = positive_n)

head(dat.retro_positive_diagnosis_by_sample, 9)

```

#### Plot Style 1

```{r GLAD/EDGI NBR and RAMP retro diagnosis}

dat.retro_positive_diagnosis_by_sample %>% 
  ggplot(aes(x = reorder(Diagnosis, -positive_n), y = positive_n, fill = Sample_plot)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = COPINGpalette3) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(x = "",
       y = "") +
  ylim(0, 20000) +
  theme(axis.text.x = element_text(angle = 70, vjust = 0.5)) +
  theme(legend.position = "top") + 
  theme(legend.title = element_blank())

```

####Plot Style 2

```{r GLAD/EDGI NBR and RAMP retro diagnosis}

dat.retro_positive_diagnosis_by_sample %>% 
  ggplot(aes(x = reorder(Diagnosis, -positive_n), y = positive_n, fill = Sample_plot)) +
  geom_bar(stat = "identity") +
  scale_fill_manual(values = COPINGpalette3) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        plot.subtitle = element_text(hjust = 0.5)) +
  labs(x = "",
       y = "") +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme(legend.position = "top") + 
  theme(legend.title = element_blank()) +
  ylim(0, 20000)

```