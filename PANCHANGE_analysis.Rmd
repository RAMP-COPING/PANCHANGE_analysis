---
title: "PANCHANGE_analysis"
author: "Katherine N Thompson, Christopher HÃ¼ebel, Molly R Davies, Kirstin L Purves"
date: Sys.Date()
output:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: 2
    toc_float:
      collapsed: false
    number_sections: false
    highlight: monochrome
    theme: cerulean
code_folding: show

html_notebook:
  theme: cerulean
toc: yes
---

This is the analysis script to prepare the data to run analyses for the project "Anxiety, depression and trauma symptom change during the COVID-19 pandemic: retrospective versus objective assessment" - Young et al (2020)

Script written by K L Purves, K N Thompson, C Huebel and M Davies.
Email: kirstin.purves@kcl.ac.uk, katie.thompson@kcl.ac.uk, christopher.1.huebel@kcl.ac.uk, molly.davies@kcl.ac.uk

#Set up
```{r Setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      comment=NA,
                      prompt=FALSE,
                      cache=FALSE)


options(bitmapType = 'quartz') # to render fonts better
```

Clear global environment
```{r Clear global environment}
remove(list = ls())
```

Retrieve the current date to use it for file endings to not overwrite files when one exports files
```{r Recent date}
date = Sys.Date()
```

#Packages
Install packages (if they are not available in your version of R)
```{r Installing packages}
#install.packages("summarytools")
#install.packages("tidyverse")
#install.packages("psych")
#install.packages("broom")
#install.packages("skimr")
#install.packages("polycor")
#install.packages("corrplot")
#install.packages("patchwork")
#install.packages("ggpubr")
```

Load packages
```{r Load packages}
library(knitr)
library(summarytools)
library(psych)
library(polycor)
library(corrplot)
library(patchwork)
library(broom)
library(tidyverse)
library(ggpubr)
```

# Colour palettes
Define colours for plotting this are the standard coping colours
```{r Colour palettes: COPING}
COPINGpalette2 <- c("#78D9C5",
                    "#F5BE5E")

COPINGpalette3 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9")

COPINGpalette4 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73")

COPINGpalette5 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73",
                    "#FFED98")

COPINGpalette6 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73",
                    "#FFED98",
                    "#BFD2EB")

COPINGpalette7 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73",
                    "#FFED98",
                    "#BFD2EB",
                    "#808080")

COPINGpaletteGRAD <- c("#F5BE5E",
                       "#FFD284",
                       "#FFEED1",
                       "#B5B5B5",
                       "#DEFFF8",
                       "#94F6E1",
                       "#78D9C5")

COPINGNeuCenterpalette <- c("#78D9C5",
                            "#808080",
                            "#F5BE5E")

RAMPworseGRADpalette <- c("#78D9C5",
                          "#FFEED1",
                          "#F5BE5E",
                          "#FFB1B5")
GLADpalette = c("#efc00b",
                "#b7dee8")
```

Choose in this chunk which palette to use
04.07.2020 - Default to 2 colour COPING palette
```{r Choose colour palette}
palette = COPINGpalette2
```

# ggplot theme
Set up ggplot theme for the plots
```{r ggplot theme}
theme_personal <-  theme(
    text = element_text(color = "black"),
    axis.title = element_text(color = "black"),
    axis.text = element_text(color = "black"),
    axis.title.y = element_blank(),
    legend.background = element_blank(),
    legend.box.background = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.major.x = element_line(
      colour = "gray",
      linetype = "dashed",
      size = 0.2
      ),
    axis.ticks = element_blank()
    )
```



# Data import

## Source data file paths

```{r source file path}
#source data directory: data_path
source("../PANCHANGE_raw_path.R")
```


## Read in data
```{r read in data}
dat <- readRDS(file = paste0(data_path, "/four_cohorts_variables_exclusion.rds"))
dim(dat)
colnames(dat)
```

## Important vectors with collections of columns

## Vectors for sum_score

```{r Vectors with sum_score_cols}
sum_score_cols <- dat %>%
  select(contains("sum_score")) %>%
  select(-ends_with("raw")) %>%
  colnames()

sum_score_cols

phq.sum_score_cols <- dat %>%
  select(contains("phq")) %>%
  select(contains("sum_score")) %>%
  select(-ends_with("raw")) %>%
  select(-contains("8items")) %>%
  colnames()

phq.sum_score_cols

gad.sum_score_cols <- dat %>%
  select(contains("gad")) %>%
  select(contains("sum_score")) %>%
  select(-ends_with("raw")) %>%
  colnames()

gad.sum_score_cols

ocir.sum_score_cols <- dat %>%
  select(contains("ocir")) %>%
  select(contains("sum_score")) %>%
  select(-ends_with("raw")) %>%
  colnames()

ocir.sum_score_cols

pcl.sum_score_cols <- dat %>%
  select(contains("pcl")) %>%
  select(contains("sum_score")) %>%
  select(-ends_with("raw")) %>%
  colnames()

pcl.sum_score_cols
```

## Vectors for diff_score

```{r Vectors with diff_score_cols}
diff_score_cols <- dat %>%
  select(contains("diff_score")) %>%
  colnames()

diff_score_cols

phq.diff_score_cols <- dat %>%
  select(contains("phq")) %>%
  select(contains("diff_score")) %>%
  colnames()

phq.diff_score_cols

gad.diff_score_cols <- dat %>%
  select(contains("gad")) %>%
  select(contains("diff_score")) %>%
  colnames()

gad.diff_score_cols

ocir.diff_score_cols <- dat %>%
  select(contains("ocir")) %>%
  select(contains("diff_score")) %>%
  colnames()

ocir.diff_score_cols
```

#ANALYSIS PLAN
1. Calculate mean change per disorder group
    i. Disorders (9)
      a. Rank the disorders by the size of the change
    ii. Sex
    iii. Age (13; RAMP; potentially collapse above 65 depending on group sizes)
    iv. Ethnicity groups (5; White European, Black (British), Asian, Arab, Mixed)

# 1. Questionnaire comparions: Calculate mean change per group

## gad
### Summary scores
```{r descriptives gad.sum_score_cols}
gad.sum_score_numeric_table <- dat %>%
  group_by(gad.change_binary) %>%
  summarise_at(
    vars(
      "Prepan" = gad.sum_score_prepan,
      "Base" = gad.sum_score_base,
      "Retro" = gad.sum_score_retro
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

gad.sum_score_numeric_table
```

```{r gad sum score smart numeric summary tables}
# reshape the table
gad.sum_score_numeric_summary_table_reshaped <- gad.sum_score_numeric_table %>%
  gather(key, value, -gad.change_binary) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    Change = Gad.change_binary,
    SD = Sd
  )

gad.sum_score_numeric_summary_table_reshaped
```

Table for knitting
gad sum score summary table
```{r gad sum score summary table}
kable(gad.sum_score_numeric_summary_table_reshaped)
```

### Differences scores

```{r descriptives gad.diff_score_cols}
gad.numeric_table <- dat %>%
  group_by(gad.change_binary) %>%
  summarise_at(
    vars(
      "Base - prepan" = gad.diff_score_base_prepan,
      "Base - retro" = gad.diff_score_base_retro,
      "Prepan - retro" = gad.diff_score_retro_prepan
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

gad.numeric_table
```

```{r gad diff score smart numeric summary tables}
# reshape the table
gad.numeric_summary_table_reshaped <- gad.numeric_table %>%
  gather(key, value, -gad.change_binary) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
    ) %>%
  # or we can individually rename variables
  rename(
    Change = Gad.change_binary,
    SD = Sd
  )

gad.numeric_summary_table_reshaped
```

Table for knitting
gad diff summary table
```{r gad diff summary table}
kable(gad.numeric_summary_table_reshaped)
```

### Long format

```{r gad gather to long format Time_points gad.diff_score}
dat.long.gad.diff <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "gad.diff_score",
    all_of(gad.diff_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    gad.diff_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "gad.diff_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.gad.diff)
```

```{r gad gather to long format Time_points gad.sum_score}
dat.long.gad.sum <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "gad.sum_score",
    all_of(gad.sum_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    gad.sum_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "gad.sum_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.gad.sum)
```


### Plots diff

makes this into percentages
```{r gad absolut plot}
dat.long.gad.diff %>%
  ggplot(mapping = aes(y = gad.diff_score)) +
  geom_bar() +
  theme_minimal() +
  facet_wrap(facets = vars(Time_point))
```

```{r gad percentage plot retro_prepan diff}
dat.long.gad.diff %>%
  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = gad.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference GAD7 score",
    y = "Percentage of participants",
    fill = "Comparison:\nBaseline vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic", "Retrospective"))
```


```{r gad percentage plot retro_prepan resized, fig.height=6, fig.width=10}
dat.long.gad.diff %>%
  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = gad.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference GAD7 score",
    y = "Percentage of participants",
    fill = "Comparison:\nBaseline vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic", "Retrospective")) +
  facet_wrap("Disorder_hierarchical")
```



```{r gad plot retro_prepan diff}
dat.long.gad.diff %>%
  filter(Time_point == "retro_prepan") %>%
  ggplot(mapping = aes(
    x = gad.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference GAD7 score",
    y = "Percentage of participants",
    fill = "Comparison:\nRetrospective vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic"))
```

### Plots sum

```{r gad percentage plot retro_prepan sum}
dat.long.gad.sum %>%
#  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = gad.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "GAD7 scores",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
    )
```

```{r gad percentage plot retro_prepan sum resized, fig.height=6, fig.width=10}
dat.long.gad.sum %>%
#  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = gad.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "GAD7 score",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
    ) +
  facet_wrap("Disorder_hierarchical")
```


## phq

### Summary scores
```{r descriptives phq.sum_score}
phq.sum_score_numeric_table <- dat %>%
  group_by(phq.change_binary) %>%
  summarise_at(
    vars(
      "Prepan" = phq.sum_score_prepan,
      "Base" = phq.sum_score_base,
      "Retro" = phq.sum_score_retro
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

phq.sum_score_numeric_table
```

```{r phq sum score smart numeric summary tables}
# reshape the table
phq.sum_score_numeric_summary_table_reshaped <- phq.sum_score_numeric_table %>%
  gather(key, value, -phq.change_binary) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    SD = Sd
  )

phq.sum_score_numeric_summary_table_reshaped
```

Table for knitting
phq sum score summary table
```{r phq sum score summary table}
kable(phq.sum_score_numeric_summary_table_reshaped)
```

### Differences score

```{r descriptives phq.diff_score_cols}
phq.numeric_table <- dat %>%
  group_by(phq.change_binary) %>%
  summarise_at(
    vars(
      "Base - prepan" = phq.diff_score_base_prepan,
      "Base - retro" = phq.diff_score_base_retro,
      "Prepan - retro" = phq.diff_score_retro_prepan
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

phq.numeric_table
```

```{r phq diff score smart numeric summary tables}
# reshape the table
phq.numeric_summary_table_reshaped <- phq.numeric_table %>%
  gather(key, value, -phq.change_binary) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    SD = Sd
  )

phq.numeric_summary_table_reshaped
```

Table for knitting
phq diff summary table
```{r phq diff summary table}
kable(phq.numeric_summary_table_reshaped)
```

### Long format

```{r phq gather to long format Time_points}
dat.long.phq.diff <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "phq.diff_score",
    all_of(phq.diff_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    phq.diff_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "phq.diff_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.phq.diff)
```

```{r phq gather to long format Time_points phq.sum_score}
dat.long.phq.sum <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "phq.sum_score",
    all_of(phq.sum_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    phq.sum_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "phq.sum_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.phq.sum)
```

### Plots

makes this into percentages
```{r phq absolut plot}
dat.long.phq.diff %>%
  ggplot(mapping = aes(y = phq.diff_score)) +
  geom_bar() +
  theme_minimal() +
  facet_wrap(facets = vars(Time_point))
```


```{r phq percentage plot retro_prepan}
dat.long.phq.diff %>%
  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = phq.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference PHQ9 score",
    y = "Percentage of participants",
    fill = "Comparison:\nBaseline vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic", "Retrospective"))
```

```{r phq plot retro_prepan diff}
dat.long.phq.diff %>%
  filter(Time_point == "retro_prepan") %>%
  ggplot(mapping = aes(
    x = phq.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference phq7 score",
    y = "Percentage of participants",
    fill = "Comparison:\nPrepandemic vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Retrospective"))
```

```{r phq percentage plot retro_prepan resized, fig.height=6, fig.width=10}
dat.long.phq.diff %>%
  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = phq.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference PHQ9 score",
    y = "Percentage of participants",
    fill = "Comparison:\nBaseline vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic", "Retrospective")
    ) +
  facet_wrap("Disorder_hierarchical")
```

### Plots sum

```{r phq percentage plot retro_prepan sum}
dat.long.phq.sum %>%
  #  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = phq.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "PHQ9 scores",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
  )
```

```{r phq percentage plot retro_prepan sum resized, fig.height=6, fig.width=10}
dat.long.phq.sum %>%
  #  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = phq.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "PHQ9 score",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
  ) +
  facet_wrap("Disorder_hierarchical")
```

## ocir

### Summary scores
```{r descriptives ocir.sum_score}
ocir.sum_score_numeric_table <- dat %>%
  group_by(ocir.change_binary) %>%
  summarise_at(
    vars(
      "Prepan" = ocir.sum_score_prepan,
      "Base" = ocir.sum_score_base,
      "Retro" = ocir.sum_score_retro
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

ocir.sum_score_numeric_table
```

```{r ocir sum score smart numeric summary tables}
# reshape the table
ocir.sum_score_numeric_summary_table_reshaped <- ocir.sum_score_numeric_table %>%
  filter(ocir.change_binary == "Worsening") %>%
  select(-ocir.change_binary) %>%
  gather(key, value) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    SD = Sd
  )

ocir.sum_score_numeric_summary_table_reshaped
```

Table for knitting
ocir sum score summary table
```{r ocir sum score summary table}
kable(ocir.sum_score_numeric_summary_table_reshaped)
```

### Differences scores

```{r descriptives ocir.diff_score_cols}
ocir.numeric_table <- dat %>%
  #  group_by(dem.sex) %>%
  summarise_at(
    vars(
      "Base - prepan" = ocir.diff_score_base_prepan,
      "Base - retro" = ocir.diff_score_base_retro,
      "Prepan - retro" = ocir.diff_score_retro_prepan
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

ocir.numeric_table
```

```{r ocir diff score smart numeric summary tables}
# reshape the table
ocir.numeric_summary_table_reshaped <- ocir.numeric_table %>%
  gather(key, value) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    SD = Sd
  )

ocir.numeric_summary_table_reshaped
```

Table for knitting
ocir diff summary table
```{r ocir diff summary table}
kable(ocir.numeric_summary_table_reshaped)
```

### Long format

```{r ocir gather to long format Time_points}
dat.long.ocir.diff <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "ocir.diff_score",
    all_of(ocir.diff_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    ocir.diff_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "ocir.diff_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.ocir.diff)
```

```{r ocir gather to long format Time_points ocir.sum_score}
dat.long.ocir.sum <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "ocir.sum_score",
    all_of(ocir.sum_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    ocir.sum_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "ocir.sum_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.ocir.sum)
```

### Plots

makes this into percentages
```{r ocir absolut plot}
dat.long.ocir.diff %>%
  ggplot(mapping = aes(y = ocir.diff_score)) +
  geom_bar() +
  theme_minimal() +
  facet_wrap(facets = vars(Time_point))
```

```{r ocir percentage plot retro_prepan}
dat.long.ocir.diff %>%
  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = ocir.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference OCI-R score",
    y = "Percentage of participants",
    fill = "Comparison:\nBaseline vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic", "Retrospective"))
```

```{r ocir plot retro_prepan diff}
dat.long.ocir.diff %>%
  filter(Time_point == "retro_prepan") %>%
  ggplot(mapping = aes(
    x = ocir.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference ocir7 score",
    y = "Percentage of participants",
    fill = "Comparison:\nPrepandemic vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Retrospective"))
```

```{r ocir percentage plot retro_prepan resized, fig.height=6, fig.width=10}
dat.long.ocir.diff %>%
  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = ocir.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference OCI-R score",
    y = "Percentage of participants",
    fill = "Comparison:\nBaseline vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic", "Retrospective")) +
  facet_wrap("Disorder_hierarchical")
```

### Plots sum

```{r ocir percentage plot retro_prepan sum}
dat.long.ocir.sum %>%
  ggplot(mapping = aes(
    x = ocir.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "OCI-R scores",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
  )
```

```{r ocir percentage plot retro_prepan sum resized, fig.height=6, fig.width=10}
dat.long.ocir.sum %>%
  ggplot(mapping = aes(
    x = ocir.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "OCI-R score",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
  ) +
  facet_wrap("Disorder_hierarchical")
```



++CH: Rank the disorders by the size of the change



PCL:
Calculate the total GLAD, COPING, RAMP baseline
## PCL

```{r descriptives pcl.diff_score_cols}
pcl.numeric_table <- dat %>%
#    group_by(Sample) %>%
  summarise_at(
    vars(
      "Base - prepan" = pcl.diff_score_base_prepan
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

pcl.numeric_table
```

```{r pcl sum score smart numeric summary tables}
# reshape the table
pcl.numeric_summary_table_reshaped <- pcl.numeric_table %>%
  gather(key, value) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    SD = Sd
  )

pcl.numeric_summary_table_reshaped
```

Table for knitting
pcl sum score summary table
```{r pcl sum score summary table}
kable(pcl.numeric_summary_table_reshaped)
```


```{r descriptives pcl.sum_score}
pcl.sum_score_numeric_table <- dat %>%
#    group_by(Sample) %>%
  summarise_at(
    vars(
      "Prepan" = pcl.sum_score_prepan,
      "Base" = pcl.sum_score_base
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

pcl.numeric_table
```

```{r pcl diff score smart numeric summary tables}
# reshape the table
pcl.sum_score_numeric_summary_table_reshaped <- pcl.sum_score_numeric_table %>%
  gather(key, value) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    SD = Sd
  )

pcl.sum_score_numeric_summary_table_reshaped
```

Table for knitting
pcl diff summary table
```{r pcl diff summary table}
kable(pcl.sum_score_numeric_summary_table_reshaped)
```

```{r pcl gather to long format Time_points pcl.sum_score}
dat.long.pcl.sum <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "pcl.sum_score",
    all_of(pcl.sum_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    pcl.sum_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "pcl.sum_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.pcl.sum)
```

For each item
present percentages of how say that this is due to the pandemic
```{r pcl percentages due to pandemic}
pcl.retro.items <- c(
  "pcl.stressful_experience_upset_reminded_retro_numeric",
  "pcl.stressful_experience_repeated_images_retro_numeric",
  "pcl.stressful_situation_avoiding_activities_retro_numeric",
  "pcl.cut_people_feeling_distant_retro_numeric",
  "pcl.difficulty_concentrating_retro_numeric",
  "pcl.feeling_irritable_or_having_angry_outbursts_retro_numeric"
)

pcl.percentages.summary <- dat %>%
  select(
    all_of(pcl.retro.items)
  ) %>%
  gather(
    key = "PCL Item",
    value = "Binary_score",
    all_of(pcl.retro.items)
  ) %>%
  mutate(Binary_score = fct_explicit_na(as.factor(Binary_score), na_level = "Missing")) %>%
  group_by(`PCL Item`) %>%
  count(`PCL Item`, Binary_score) %>%
  mutate(prop = round(n/sum(n), 3)*100) %>%
  mutate(n_prop = paste0(n," (",prop, "%)"))

kable(pcl.percentages.summary)
pcl.percentages.summary
```


### Plots sum

```{r pcl percentage plot retro_prepan sum}
dat.long.pcl.sum %>%
  ggplot(mapping = aes(
    x = pcl.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "PCL scores",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
  )
```

```{r pcl percentage plot retro_prepan sum resized, fig.height=6, fig.width=10}
dat.long.pcl.sum %>%
  ggplot(mapping = aes(
    x = pcl.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "PCL score",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
  ) +
  facet_wrap("Disorder_hierarchical")
```



# Create subsets of data for analyses
Filter data frame to create 2 additional datasets. Additional exclusion criteria (beyond those listed above) are specified below:

  1. Retrospective - baseline change anlyses
        i. Exclude individuals missing retrospective and/or baseline data
  2. Prepandemic - baseline change analyses
          i. Exclude individuals missing pandemic and/or baseline data
          ii. Exclude individuals with prepandemic data collected after 1st March.

Retro-baseline analyses


```{r subsample for retro-baseline analysis}
dat.retro <- dat %>%
  filter(
    ((data_group_gad == "Baseline and retrospective data" |
      data_group_gad == "All prepandemic, baseline and retrospective data") |
      (data_group_phq == "Baseline and retrospective data" |
      data_group_phq == "All prepandemic, baseline and retrospective data") |
      (data_group_pcl == "Baseline and retrospective data" |
      data_group_pcl == "All prepandemic, baseline and retrospective data") |
      (data_group_ocir == "Baseline and retrospective data" |
      data_group_ocir == "All prepandemic, baseline and retrospective data"))
  )

dim(dat.retro)
```

Prepan-baseline analyses
Exclude individuals with NA for MHD, age, gender; exclude if prepan data collected after 1 March

```{r subsample for prepan-baseline analysis}
dat.prepan <- dat %>%
  filter(
    ((data_group_gad == "Baseline and retrospective data" |
      data_group_gad == "Prepandemic and baseline data" |
      data_group_gad == "All prepandemic, baseline and retrospective data") |
      (data_group_phq == "Baseline and retrospective data" |
      data_group_phq == "Prepandemic and baseline data" |
      data_group_phq == "All prepandemic, baseline and retrospective data") |
      (data_group_pcl == "Baseline and retrospective data" |
      data_group_pcl == "Prepandemic and baseline data" |
      data_group_pcl == "All prepandemic, baseline and retrospective data") |
      (data_group_ocir == "Baseline and retrospective data" |
      data_group_ocir == "Prepandemic and baseline data" |
      data_group_ocir == "All prepandemic, baseline and retrospective data")) &
      prepandemic_march_1_numeric == 1
  )

dim(dat.prepan)
```


2. Regression models (Regress covariates out of the change? Which?)
    i. Model 0: Disorders
    ii. Model 1: Model 0 + Sex + Age + Ethnicity + Time registration and baseline

3. Re-calculate change

4. Re-rank the change again

5. PCL:
    i. Calculate the total GLAD, COPING, RAMP baseline
    ii. For each item:
          a. present percentages of how say that this is due to the pandemic
          b. Calculate a variable PCL pandemic score
          c. If one item is highly endorsed due to pandemic -> exclude in sensitivity analysis



# 2. Regression
Regress covariates out of the change? Which?

Model naming conventions:
0 - unadjusted
1 - adjusted
a - hierarchical disorders
b - overlapping disorder categories

++MD: We may want to exclude disorders from Model b that aren't including in the hierarchy (e.g. ADHD, ASD)

# Functions

```{r model0a function}
model0a.estimates <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model0a"),
         lm( formula = glm.formula,
              data = get(data_set)
              )
  )

  assign(paste0(outcome,"model0a_estimates"),
         tidy(get(paste0(outcome,".model0a")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "Disorder_hierarchicalAnxiety disorders" = "Anxiety disorders",
               "Disorder_hierarchicalEating disorders" = "Eating disorders",
               "Disorder_hierarchicalOCDs" = "OCDs",
               "Disorder_hierarchicalPTSD" = "PTSD",
               "Disorder_hierarchicalDepressive disorders" = "Depressive disorders",
               "Disorder_hierarchicalBipolar disorders" = "Bipolar disorders"
             ),
    "Estimate" = format(
      round(estimate,
            digits = 2),
      nsmall = 2),
    "95% CI low" = format(
      round(conf.low,
            digits = 2),
      nsmall = 2),
    "95% CI up" = format(
      round(conf.high,
            digits = 2),
      nsmall = 2),
    "SE" = format(
      round(std.error,
            digits = 2),
      nsmall = 2),
    "z score" = format(
      round(statistic,
            digits = 2),
      nsmall = 2),
    "p value" = case_when(
      p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
      p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
      p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
  )
  ) %>%
  select(
    "Indepent variable",
    "Estimate",
    "95% CI low",
    "95% CI up",
    "SE",
#    "z score",
    "p value"
  )
  )

  return(get(paste0(outcome,"model0a_estimates")))
}

model0a.reg.stats <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model0a"),
         lm( formula = glm.formula,
              data = get(data_set)
              )
  )

  assign(paste0(outcome,"model0a_reg_stats"),
         glance(get(paste0(outcome,".model0a"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,"model0a_reg_stats")))
}
```


```{r model0b function}
model0b.estimates <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("depression_and_anxiety",
                             "eating_disorders",
                             "obsessive_compulsive_disorders",
                             "bipolar_and_schizophrenia",
                             "mhd.posttraumatic_stress_disorder_ptsd",
                             "autism_spectrum_disorder",
                             "mhd.attention_deficit_hyperactivity_disorder",
                             "mhd.personality_disorder"
                                )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model0b"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model0b_estimates"),
         tidy(get(paste0(outcome,".model0b")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "anxiety_disordersAnxiety disorder" = "Anxiety disorders",
               "depressive_disordersDepressive disorder" = "Depressive disorders",
               "depression_and_anxietyDepressive and anxiety disorder" = "Depressive and anxiety disorder",
               "depression_and_anxietyOnly depressive disorder" = "Only depressive disorder",
               "depression_and_anxietyOnly anxiety disorder" = "Only anxiety disorder",
               "eating_disordersEating disorder" = "Eating disorders",
               "obsessive_compulsive_disordersObsessive compulsive disorder" = "OCDs",
               "bipolar_and_schizophreniaPsychotic and bipolar disorder" = "Psychotic and bipolar disorder",
               "bipolar_and_schizophreniaOnly psychotic disorder" = "Only psychotic disorder",
               "bipolar_and_schizophreniaOnly bipolar disorder" = "Only bipolar disorder",
               "psychotic_disordersPsychotic disorder" = "Psychotic disorder",
               "mhd.mania_hypomania_bipolar_or_manicdepressionMania, hypomania, bipolar or manic-depression" = "Bipolar disorder",
               "mhd.posttraumatic_stress_disorder_ptsdPost-traumatic stress disorder (PTSD)" = "PTSD",
               "autism_spectrum_disorderAutism spectrum disorder" = "ASD",
               "mhd.attention_deficit_hyperactivity_disorderAttention deficit or attention deficit and hyperactivity disorder (ADD/ADHD)" = "ADHD",
               "mhd.personality_disorderPersonality disorder" = "Personality disorder"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,"model0b_estimates")))
}

model0b.reg.stats <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model0b"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model0b_reg_stats"),
         glance(get(paste0(outcome,".model0b"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,"model0b_reg_stats")))
}
```

```{r model1a function}
model1a.estimates <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical",
                            "Gender_collapsed",
                            "age_category_collapsed",
                            "Ethnicity_collapsed",
                            "time_diff_coping_lockdown_march_23"
                            )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model1a"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model1a_estimates"),
         tidy(get(paste0(outcome,".model1a")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "Disorder_hierarchicalAnxiety disorders" = "Anxiety disorders",
               "Disorder_hierarchicalEating disorders" = "Eating disorders",
               "Disorder_hierarchicalOCDs" = "OCDs",
               "Disorder_hierarchicalPTSD" = "PTSD",
               "Disorder_hierarchicalDepressive disorders" = "Depressive disorders",
               "Disorder_hierarchicalBipolar disorders" = "Bipolar disorders",
               "Gender_collapsedFemale" = "Female",
               "Gender_collapsedNon-binary/Self-defined" = "Non-binary/Self-defined",
               "age_category_collapsed19-25" = "19-25 years",
               "age_category_collapsed26-35" = "26-35 years",
               "age_category_collapsed36-45" = "36-45 years",
               "age_category_collapsed46-55" = "46-55 years",
               "age_category_collapsed56-65" = "56-65 years",
               "age_category_collapsed66-70" = "66-70 years",
               "age_category_collapsed71-75" = "71-75 years",
               "age_category_collapsed76+" = "76+ years",
               "Ethnicity_collapsedMixed or multiple ethnic origins" = "Mixed or multiple ethnic origins",
               "Ethnicity_collapsedAsian or Asian British" = "Asian or Asian British",
               "Ethnicity_collapsedAfrican or African British" = "African or African British",
               "Ethnicity_collapsedOther" = "Other ethnicity",
               "time_diff_coping_lockdown_march_23" = "Time difference: Lockdown to baseline"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,"model1a_estimates")))
}

model1a.reg.stats <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model1a"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model1a_reg_stats"),
         glance(get(paste0(outcome,".model1a"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,"model1a_reg_stats")))
}
```


```{r model1b function}
model1b.estimates <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("depression_and_anxiety",
                             "eating_disorders",
                             "obsessive_compulsive_disorders",
                             "bipolar_and_schizophrenia",
                             "mhd.posttraumatic_stress_disorder_ptsd",
                             "autism_spectrum_disorder",
                             "mhd.attention_deficit_hyperactivity_disorder",
                             "mhd.personality_disorder",
                             "Gender_collapsed",
                             "age_category_collapsed",
                             "Ethnicity_collapsed",
                             "key_worker",
                             "time_diff_coping_lockdown_march_23"
                                )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model1b"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model1b_estimates"),
         tidy(get(paste0(outcome,".model1b")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "anxiety_disordersAnxiety disorder" = "Anxiety disorders",
               "depressive_disordersDepressive disorder" = "Depressive disorders",
               "depression_and_anxietyDepressive and anxiety disorder" = "Depressive and anxiety disorder",
               "depression_and_anxietyOnly depressive disorder" = "Only depressive disorder",
               "depression_and_anxietyOnly anxiety disorder" = "Only anxiety disorder",
               "eating_disordersEating disorder" = "Eating disorders",
               "obsessive_compulsive_disordersObsessive compulsive disorder" = "OCDs",
               "bipolar_and_schizophreniaPsychotic and bipolar disorder" = "Psychotic and bipolar disorder",
               "bipolar_and_schizophreniaOnly psychotic disorder" = "Only psychotic disorder",
               "bipolar_and_schizophreniaOnly bipolar disorder" = "Only bipolar disorder",
               "psychotic_disordersPsychotic disorder" = "Psychotic disorder",
               "mhd.mania_hypomania_bipolar_or_manicdepressionMania, hypomania, bipolar or manic-depression" = "Bipolar disorder",
               "mhd.posttraumatic_stress_disorder_ptsdPost-traumatic stress disorder (PTSD)" = "PTSD",
               "autism_spectrum_disorderAutism spectrum disorder" = "ASD",
               "mhd.attention_deficit_hyperactivity_disorderAttention deficit or attention deficit and hyperactivity disorder (ADD/ADHD)" = "ADHD",
               "mhd.personality_disorderPersonality disorder" = "Personality disorder",
               "Gender_collapsedFemale" = "Female",
               "Gender_collapsedNon-binary/Self-defined" = "Non-binary/Self-defined",
               "age_category_collapsed19-25" = "19-25 years",
               "age_category_collapsed26-35" = "26-35 years",
               "age_category_collapsed36-45" = "36-45 years",
               "age_category_collapsed46-55" = "46-55 years",
               "age_category_collapsed56-65" = "56-65 years",
               "age_category_collapsed66-70" = "66-70 years",
               "age_category_collapsed71-75" = "71-75 years",
               "age_category_collapsed76+" = "76+ years",
               "Ethnicity_collapsedMixed or multiple ethnic origins" = "Mixed or multiple ethnic origins",
               "Ethnicity_collapsedAsian or Asian British" = "Asian or Asian British",
               "Ethnicity_collapsedAfrican or African British" = "African or African British",
               "Ethnicity_collapsedOther" = "Other ethnicity",
               "key_workerKey worker" = "Key worker",
               "time_diff_coping_lockdown_march_23" = "Time difference: Lockdown to baseline"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,"model1b_estimates")))
}

model1b.reg.stats <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model1b"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model1b_reg_stats"),
         glance(get(paste0(outcome,".model1b"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,"model1b_reg_stats")))
}
```


```{r model0a.explan function}
model0a.explan.estimates <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c(explan_var, "Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model0a.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model0a.explan_estimates"),
         tidy(get(paste0(outcome,".",explan_var,".model0a.explan")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "Disorder_hierarchicalAnxiety disorders" = "Anxiety disorders",
               "Disorder_hierarchicalEating disorders" = "Eating disorders",
               "Disorder_hierarchicalOCDs" = "OCDs",
               "Disorder_hierarchicalPTSD" = "PTSD",
               "Disorder_hierarchicalDepressive disorders" = "Depressive disorders",
               "Disorder_hierarchicalBipolar disorders" = "Bipolar disorders"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model0a.explan_estimates")))
}

model0a.explan.reg.stats <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c(explan_var, "Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model0a.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model0a.explan_reg_stats"),
         glance(get(paste0(outcome,".",explan_var,".model0a.explan"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model0a.explan_reg_stats")))
}
```


```{r model0b.explan function}
model0b.explan.estimates <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c(explan_var,
                             "depression_and_anxiety",
                             "eating_disorders",
                             "obsessive_compulsive_disorders",
                             "bipolar_and_schizophrenia",
                             "mhd.posttraumatic_stress_disorder_ptsd",
                             "autism_spectrum_disorder",
                             "mhd.attention_deficit_hyperactivity_disorder",
                             "mhd.personality_disorder"
  )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model0b.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model0b.explan_estimates"),
         tidy(get(paste0(outcome,".",explan_var,".model0b.explan")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "anxiety_disordersAnxiety disorder" = "Anxiety disorders",
               "depressive_disordersDepressive disorder" = "Depressive disorders",
               "depression_and_anxietyDepressive and anxiety disorder" = "Depressive and anxiety disorder",
               "depression_and_anxietyOnly depressive disorder" = "Only depressive disorder",
               "depression_and_anxietyOnly anxiety disorder" = "Only anxiety disorder",
               "eating_disordersEating disorder" = "Eating disorders",
               "obsessive_compulsive_disordersObsessive compulsive disorder" = "OCDs",
               "bipolar_and_schizophreniaPsychotic and bipolar disorder" = "Psychotic and bipolar disorder",
               "bipolar_and_schizophreniaOnly psychotic disorder" = "Only psychotic disorder",
               "bipolar_and_schizophreniaOnly bipolar disorder" = "Only bipolar disorder",
               "psychotic_disordersPsychotic disorder" = "Psychotic disorder",
               "mhd.mania_hypomania_bipolar_or_manicdepressionMania, hypomania, bipolar or manic-depression" = "Bipolar disorder",
               "mhd.posttraumatic_stress_disorder_ptsdPost-traumatic stress disorder (PTSD)" = "PTSD",
               "autism_spectrum_disorderAutism spectrum disorder" = "ASD",
               "mhd.attention_deficit_hyperactivity_disorderAttention deficit or attention deficit and hyperactivity disorder (ADD/ADHD)" = "ADHD",
               "mhd.personality_disorderPersonality disorder" = "Personality disorder"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model0b.explan_estimates")))
}

model0b.explan.reg.stats <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model0b.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model0b.explan_reg_stats"),
         glance(get(paste0(outcome,".",explan_var,".model0b.explan"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model0b.explan_reg_stats")))
}
```



```{r model1a.explan function}
model1a.explan.estimates <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c(explan_var,
                             "Disorder_hierarchical",
                             "Gender_collapsed",
                             "age_category_collapsed",
                             "Ethnicity_collapsed",
                             "key_worker",
                             "time_diff_coping_lockdown_march_23"
  )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model1a.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model1a.explan_estimates"),
         tidy(get(paste0(outcome,".",explan_var,".model1a.explan")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "Disorder_hierarchicalAnxiety disorders" = "Anxiety disorders",
               "Disorder_hierarchicalEating disorders" = "Eating disorders",
               "Disorder_hierarchicalOCDs" = "OCDs",
               "Disorder_hierarchicalPTSD" = "PTSD",
               "Disorder_hierarchicalDepressive disorders" = "Depressive disorders",
               "Disorder_hierarchicalBipolar disorders" = "Bipolar disorders",
               "Gender_collapsedFemale" = "Female",
               "Gender_collapsedNon-binary/Self-defined" = "Non-binary/Self-defined",
               "age_category_collapsed19-25" = "19-25 years",
               "age_category_collapsed26-35" = "26-35 years",
               "age_category_collapsed36-45" = "36-45 years",
               "age_category_collapsed46-55" = "46-55 years",
               "age_category_collapsed56-65" = "56-65 years",
               "age_category_collapsed66-70" = "66-70 years",
               "age_category_collapsed71-75" = "71-75 years",
               "age_category_collapsed76+" = "76+ years",
               "Ethnicity_collapsedMixed or multiple ethnic origins" = "Mixed or multiple ethnic origins",
               "Ethnicity_collapsedAsian or Asian British" = "Asian or Asian British",
               "Ethnicity_collapsedAfrican or African British" = "African or African British",
               "Ethnicity_collapsedOther" = "Other ethnicity",
               "key_workerKey worker" = "Key worker",
               "time_diff_coping_lockdown_march_23" = "Time difference: Lockdown to baseline"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model1a.explan_estimates")))
}

model1a.explan.reg.stats <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model1a.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model1a.explan_reg_stats"),
         glance(get(paste0(outcome,".",explan_var,".model1a.explan"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model1a.explan_reg_stats")))
}
```


```{r model1b.explan function}
model1b.explan.estimates <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c(explan_var,
                             "depression_and_anxiety",
                             "eating_disorders",
                             "obsessive_compulsive_disorders",
                             "bipolar_and_schizophrenia",
                             "mhd.posttraumatic_stress_disorder_ptsd",
                             "autism_spectrum_disorder",
                             "mhd.attention_deficit_hyperactivity_disorder",
                             "mhd.personality_disorder",
                             "Gender_collapsed",
                             "age_category_collapsed",
                             "Ethnicity_collapsed",
                             "key_worker",
                             "time_diff_coping_lockdown_march_23"
  )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model1b.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model1b.explan_estimates"),
         tidy(get(paste0(outcome,".",explan_var,".model1b.explan")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "anxiety_disordersAnxiety disorder" = "Anxiety disorders",
               "depressive_disordersDepressive disorder" = "Depressive disorders",
               "depression_and_anxietyDepressive and anxiety disorder" = "Depressive and anxiety disorder",
               "depression_and_anxietyOnly depressive disorder" = "Only depressive disorder",
               "depression_and_anxietyOnly anxiety disorder" = "Only anxiety disorder",
               "eating_disordersEating disorder" = "Eating disorders",
               "obsessive_compulsive_disordersObsessive compulsive disorder" = "OCDs",
               "bipolar_and_schizophreniaPsychotic and bipolar disorder" = "Psychotic and bipolar disorder",
               "bipolar_and_schizophreniaOnly psychotic disorder" = "Only psychotic disorder",
               "bipolar_and_schizophreniaOnly bipolar disorder" = "Only bipolar disorder",
               "psychotic_disordersPsychotic disorder" = "Psychotic disorder",
               "mhd.mania_hypomania_bipolar_or_manicdepressionMania, hypomania, bipolar or manic-depression" = "Bipolar disorder",
               "mhd.posttraumatic_stress_disorder_ptsdPost-traumatic stress disorder (PTSD)" = "PTSD",
               "autism_spectrum_disorderAutism spectrum disorder" = "ASD",
               "mhd.attention_deficit_hyperactivity_disorderAttention deficit or attention deficit and hyperactivity disorder (ADD/ADHD)" = "ADHD",
               "mhd.personality_disorderPersonality disorder" = "Personality disorder",
               "Gender_collapsedFemale" = "Female",
               "Gender_collapsedNon-binary/Self-defined" = "Non-binary/Self-defined",
               "age_category_collapsed19-25" = "19-25 years",
               "age_category_collapsed26-35" = "26-35 years",
               "age_category_collapsed36-45" = "36-45 years",
               "age_category_collapsed46-55" = "46-55 years",
               "age_category_collapsed56-65" = "56-65 years",
               "age_category_collapsed66-70" = "66-70 years",
               "age_category_collapsed71-75" = "71-75 years",
               "age_category_collapsed76+" = "76+ years",
               "Ethnicity_collapsedMixed or multiple ethnic origins" = "Mixed or multiple ethnic origins",
               "Ethnicity_collapsedAsian or Asian British" = "Asian or Asian British",
               "Ethnicity_collapsedAfrican or African British" = "African or African British",
               "Ethnicity_collapsedOther" = "Other ethnicity",
               "key_workerKey worker" = "Key worker",
               "time_diff_coping_lockdown_march_23" = "Time difference: Lockdown to baseline"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model1b.explan_estimates")))
}

model1b.explan.reg.stats <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model1b.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model1b.explan_reg_stats"),
         glance(get(paste0(outcome,".",explan_var,".model1b.explan"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model1b.explan_reg_stats")))
}
```


# GAD baseline, not controlling for prior symptoms
### Model 0a: Disorder_hierarchical, Unadjusted
```{r gad model0a absolute whole sample}
# Regression coefficients
gad_baseline_model0a_estimates <- model0a.estimates(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model0a_estimates)
gad_baseline_model0a_estimates

# Regression diagnostic statistics
gad_baseline_model0a_reg_stats <- model0a.reg.stats(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model0a_reg_stats)
gad_baseline_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r gad model0b absolute whole sample}
# Regression coefficients
gad_baseline_model0b_estimates <- model0b.estimates(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model0b_estimates)
gad_baseline_model0b_estimates

# Regression diagnostic statistics
gad_baseline_model0b_reg_stats <- model0b.reg.stats(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model0b_reg_stats)
gad_baseline_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad model1a absolute whole sample}
# Regression coefficients
gad_baseline_model1a_estimates <- model1a.estimates(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model1a_estimates)
gad_baseline_model1a_estimates

# Regression diagnostic statistics
gad_baseline_model1a_reg_stats <- model1a.reg.stats(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model1a_reg_stats)
gad_baseline_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad model1b absolute whole sample}
# Regression coefficients
gad_baseline_model1b_estimates <- model1b.estimates(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model1b_estimates)
gad_baseline_model1b_estimates

# Regression diagnostic statistics
gad_baseline_model1b_reg_stats <- model1b.reg.stats(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model1b_reg_stats)
gad_baseline_model1b_reg_stats
```


# GAD prepan
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r gad model0a diff_score prepan}
# Regression coefficients
gad_prepan_model0a_estimates <- model0a.estimates(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model0a_estimates)
gad_prepan_model0a_estimates

# Regression diagnostic statistics
gad_prepan_model0a_reg_stats <- model0a.reg.stats(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model0a_reg_stats)
gad_prepan_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r gad model0b diff_score prepan}
# Regression coefficients
gad_prepan_model0b_estimates <- model0b.estimates(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model0b_estimates)
gad_prepan_model0b_estimates

# Regression diagnostic statistics
gad_prepan_model0b_reg_stats <- model0b.reg.stats(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model0b_reg_stats)
gad_prepan_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad model1a diff_score prepan}
# Regression coefficients
gad_prepan_model1a_estimates <- model1a.estimates(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model1a_estimates)
gad_prepan_model1a_estimates

# Regression diagnostic statistics
gad_prepan_model1a_reg_stats <- model1a.reg.stats(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model1a_reg_stats)
gad_prepan_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad model1b diff_score prepan}
# Regression coefficients
gad_prepan_model1b_estimates <- model1b.estimates(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model1b_estimates)
gad_prepan_model1b_estimates

# Regression diagnostic statistics
gad_prepan_model1b_reg_stats <- model1b.reg.stats(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model1b_reg_stats)
gad_prepan_model1b_reg_stats
```

## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r gad model0a sum_score prepan}
# Regression coefficients
gad_prepan_model0a_explan_estimates <- model0a.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model0a_explan_estimates)
gad_prepan_model0a_explan_estimates

# Regression diagnostic statistics
gad_prepan_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model0a_explan_reg_stats)
gad_prepan_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r gad model0b sum_score prepan}
# Regression coefficients
gad_prepan_model0b_explan_estimates <- model0b.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model0b_explan_estimates)
gad_prepan_model0b_explan_estimates

# Regression diagnostic statistics
gad_prepan_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model0b_explan_reg_stats)
gad_prepan_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad model1a sum_score prepan}
# Regression coefficients
gad_prepan_model1a_explan_estimates <- model1a.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model1a_explan_estimates)
gad_prepan_model1a_explan_estimates

# Regression diagnostic statistics
gad_prepan_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model1a_explan_reg_stats)
gad_prepan_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad model1b sum_score prepan}
# Regression coefficients
gad_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model1b_explan_estimates)
gad_prepan_model1b_explan_estimates

# Regression diagnostic statistics
gad_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model1b_explan_reg_stats)
gad_prepan_model1b_explan_reg_stats
```


# GAD retro
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r gad model0a diff_score retro}
# Regression coefficients
gad_retro_model0a_estimates <- model0a.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model0a_estimates)
gad_retro_model0a_estimates

# Regression diagnostic statistics
gad_retro_model0a_reg_stats <- model0a.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model0a_reg_stats)
gad_retro_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r gad model0b diff_score retro}
# Regression coefficients
gad_retro_model0b_estimates <- model0b.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model0b_estimates)
gad_retro_model0b_estimates

# Regression diagnostic statistics
gad_retro_model0b_reg_stats <- model0b.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model0b_reg_stats)
gad_retro_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad model1a diff_score retro}
# Regression coefficients
gad_retro_model1a_estimates <- model1a.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model1a_estimates)
gad_retro_model1a_estimates

# Regression diagnostic statistics
gad_retro_model1a_reg_stats <- model1a.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model1a_reg_stats)
gad_retro_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad model1b diff_score retro}
# Regression coefficients
gad_retro_model1b_estimates <- model1b.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model1b_estimates)
gad_retro_model1b_estimates

# Regression diagnostic statistics
gad_retro_model1b_reg_stats <- model1b.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model1b_reg_stats)
gad_retro_model1b_reg_stats
```


## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r gad model0a sum_score retro}
# Regression coefficients
gad_retro_model0a_explan_estimates <- model0a.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model0a_explan_estimates)
gad_retro_model0a_explan_estimates

# Regression diagnostic statistics
gad_retro_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model0a_explan_reg_stats)
gad_retro_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r gad model0b sum_score retro}
# Regression coefficients
gad_retro_model0b_explan_estimates <- model0b.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model0b_explan_estimates)
gad_retro_model0b_explan_estimates

# Regression diagnostic statistics
gad_retro_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model0b_explan_reg_stats)
gad_retro_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad model1a sum_score retro}
# Regression coefficients
gad_retro_model1a_explan_estimates <- model1a.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model1a_explan_estimates)
gad_retro_model1a_explan_estimates

# Regression diagnostic statistics
gad_retro_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model1a_explan_reg_stats)
gad_retro_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad model1b sum_score retro}
# Regression coefficients
gad_retro_model1b_explan_estimates <- model1b.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model1b_explan_estimates)
gad_retro_model1b_explan_estimates

# Regression diagnostic statistics
gad_retro_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model1b_explan_reg_stats)
gad_retro_model1b_explan_reg_stats
```

# PHQ baseline, not controlling for prior symptoms
### Model 0a: Disorder_hierarchical, Unadjusted
```{r phq model0a absolute whole sample}
# Regression coefficients
phq_baseline_model0a_estimates <- model0a.estimates(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model0a_estimates)
phq_baseline_model0a_estimates

# Regression diagnostic statistics
phq_baseline_model0a_reg_stats <- model0a.reg.stats(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model0a_reg_stats)
phq_baseline_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r phq model0b absolute whole sample}
# Regression coefficients
phq_baseline_model0b_estimates <- model0b.estimates(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model0b_estimates)
phq_baseline_model0b_estimates

# Regression diagnostic statistics
phq_baseline_model0b_reg_stats <- model0b.reg.stats(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model0b_reg_stats)
phq_baseline_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq model1a absolute whole sample}
# Regression coefficients
phq_baseline_model1a_estimates <- model1a.estimates(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model1a_estimates)
phq_baseline_model1a_estimates

# Regression diagnostic statistics
phq_baseline_model1a_reg_stats <- model1a.reg.stats(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model1a_reg_stats)
phq_baseline_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq model1b absolute whole sample}
# Regression coefficients
phq_baseline_model1b_estimates <- model1b.estimates(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model1b_estimates)
phq_baseline_model1b_estimates

# Regression diagnostic statistics
phq_baseline_model1b_reg_stats <- model1b.reg.stats(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model1b_reg_stats)
phq_baseline_model1b_reg_stats
```




# PHQ prepan
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r phq model0a diff_score prepan}
# Regression coefficients
phq_prepan_model0a_estimates <- model0a.estimates(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model0a_estimates)
phq_prepan_model0a_estimates

# Regression diagnostic statistics
phq_prepan_model0a_reg_stats <- model0a.reg.stats(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model0a_reg_stats)
phq_prepan_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r phq model0b diff_score prepan}
# Regression coefficients
phq_prepan_model0b_estimates <- model0b.estimates(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model0b_estimates)
phq_prepan_model0b_estimates

# Regression diagnostic statistics
phq_prepan_model0b_reg_stats <- model0b.reg.stats(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model0b_reg_stats)
phq_prepan_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq model1a diff_score prepan}
# Regression coefficients
phq_prepan_model1a_estimates <- model1a.estimates(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model1a_estimates)
phq_prepan_model1a_estimates

# Regression diagnostic statistics
phq_prepan_model1a_reg_stats <- model1a.reg.stats(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model1a_reg_stats)
phq_prepan_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq model1b diff_score prepan}
# Regression coefficients
phq_prepan_model1b_estimates <- model1b.estimates(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model1b_estimates)
phq_prepan_model1b_estimates

# Regression diagnostic statistics
phq_prepan_model1b_reg_stats <- model1b.reg.stats(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model1b_reg_stats)
phq_prepan_model1b_reg_stats
```

## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r phq model0a sum_score prepan}
# Regression coefficients
phq_prepan_model0a_explan_estimates <- model0a.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model0a_explan_estimates)
phq_prepan_model0a_explan_estimates

# Regression diagnostic statistics
phq_prepan_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model0a_explan_reg_stats)
phq_prepan_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r phq model0b sum_score prepan}
# Regression coefficients
phq_prepan_model0b_explan_estimates <- model0b.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model0b_explan_estimates)
phq_prepan_model0b_explan_estimates

# Regression diagnostic statistics
phq_prepan_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model0b_explan_reg_stats)
phq_prepan_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq model1a sum_score prepan}
# Regression coefficients
phq_prepan_model1a_explan_estimates <- model1a.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model1a_explan_estimates)
phq_prepan_model1a_explan_estimates

# Regression diagnostic statistics
phq_prepan_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model1a_explan_reg_stats)
phq_prepan_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq model1b sum_score prepan}
# Regression coefficients
phq_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model1b_explan_estimates)
phq_prepan_model1b_explan_estimates

# Regression diagnostic statistics
phq_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model1b_explan_reg_stats)
phq_prepan_model1b_explan_reg_stats
```


# PHQ retro
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r phq model0a diff_score retro}
# Regression coefficients
phq_retro_model0a_estimates <- model0a.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model0a_estimates)
phq_retro_model0a_estimates

# Regression diagnostic statistics
phq_retro_model0a_reg_stats <- model0a.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model0a_reg_stats)
phq_retro_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r phq model0b diff_score retro}
# Regression coefficients
phq_retro_model0b_estimates <- model0b.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model0b_estimates)
phq_retro_model0b_estimates

# Regression diagnostic statistics
phq_retro_model0b_reg_stats <- model0b.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model0b_reg_stats)
phq_retro_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq model1a diff_score retro}
# Regression coefficients
phq_retro_model1a_estimates <- model1a.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model1a_estimates)
phq_retro_model1a_estimates

# Regression diagnostic statistics
phq_retro_model1a_reg_stats <- model1a.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model1a_reg_stats)
phq_retro_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq model1b diff_score retro}
# Regression coefficients
phq_retro_model1b_estimates <- model1b.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model1b_estimates)
phq_retro_model1b_estimates

# Regression diagnostic statistics
phq_retro_model1b_reg_stats <- model1b.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model1b_reg_stats)
phq_retro_model1b_reg_stats
```

## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r phq model0a sum_score retro}
# Regression coefficients
phq_retro_model0a_explan_estimates <- model0a.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model0a_explan_estimates)
phq_retro_model0a_explan_estimates

# Regression diagnostic statistics
phq_retro_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model0a_explan_reg_stats)
phq_retro_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r phq model0b sum_score retro}
# Regression coefficients
phq_retro_model0b_explan_estimates <- model0b.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model0b_explan_estimates)
phq_retro_model0b_explan_estimates

# Regression diagnostic statistics
phq_retro_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model0b_explan_reg_stats)
phq_retro_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq model1a sum_score retro}
# Regression coefficients
phq_retro_model1a_explan_estimates <- model1a.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model1a_explan_estimates)
phq_retro_model1a_explan_estimates

# Regression diagnostic statistics
phq_retro_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model1a_explan_reg_stats)
phq_retro_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq model1b sum_score retro}
# Regression coefficients
phq_retro_model1b_explan_estimates <- model1b.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model1b_explan_estimates)
phq_retro_model1b_explan_estimates

# Regression diagnostic statistics
phq_retro_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model1b_explan_reg_stats)
phq_retro_model1b_explan_reg_stats
```

# OCI-R baseline, not controlling for prior symptoms
### Model 0a: Disorder_hierarchical, Unadjusted
```{r ocir model0a absolute whole sample}
# Regression coefficients
ocir_baseline_model0a_estimates <- model0a.estimates(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model0a_estimates)
ocir_baseline_model0a_estimates

# Regression diagnostic statistics
ocir_baseline_model0a_reg_stats <- model0a.reg.stats(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model0a_reg_stats)
ocir_baseline_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r ocir model0b absolute whole sample}
# Regression coefficients
ocir_baseline_model0b_estimates <- model0b.estimates(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model0b_estimates)
ocir_baseline_model0b_estimates

# Regression diagnostic statistics
ocir_baseline_model0b_reg_stats <- model0b.reg.stats(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model0b_reg_stats)
ocir_baseline_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1a absolute whole sample}
# Regression coefficients
ocir_baseline_model1a_estimates <- model1a.estimates(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model1a_estimates)
ocir_baseline_model1a_estimates

# Regression diagnostic statistics
ocir_baseline_model1a_reg_stats <- model1a.reg.stats(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model1a_reg_stats)
ocir_baseline_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1b absolute whole sample}
# Regression coefficients
ocir_baseline_model1b_estimates <- model1b.estimates(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model1b_estimates)
ocir_baseline_model1b_estimates

# Regression diagnostic statistics
ocir_baseline_model1b_reg_stats <- model1b.reg.stats(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model1b_reg_stats)
ocir_baseline_model1b_reg_stats
```


# OCIR prepan
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r ocir model0a diff_score prepan}
# Regression coefficients
ocir_prepan_model0a_estimates <- model0a.estimates(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model0a_estimates)
ocir_prepan_model0a_estimates

# Regression diagnostic statistics
ocir_prepan_model0a_reg_stats <- model0a.reg.stats(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model0a_reg_stats)
ocir_prepan_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r ocir model0b diff_score prepan}
# Regression coefficients
ocir_prepan_model0b_estimates <- model0b.estimates(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model0b_estimates)
ocir_prepan_model0b_estimates

# Regression diagnostic statistics
ocir_prepan_model0b_reg_stats <- model0b.reg.stats(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model0b_reg_stats)
ocir_prepan_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1a diff_score prepan}
# Regression coefficients
ocir_prepan_model1a_estimates <- model1a.estimates(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model1a_estimates)
ocir_prepan_model1a_estimates

# Regression diagnostic statistics
ocir_prepan_model1a_reg_stats <- model1a.reg.stats(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model1a_reg_stats)
ocir_prepan_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1b diff_score prepan}
# Regression coefficients
ocir_prepan_model1b_estimates <- model1b.estimates(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model1b_estimates)
ocir_prepan_model1b_estimates

# Regression diagnostic statistics
ocir_prepan_model1b_reg_stats <- model1b.reg.stats(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model1b_reg_stats)
ocir_prepan_model1b_reg_stats
```

## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r ocir model0a sum_score prepan}
# Regression coefficients
ocir_prepan_model0a_explan_estimates <- model0a.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model0a_explan_estimates)
ocir_prepan_model0a_explan_estimates

# Regression diagnostic statistics
ocir_prepan_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model0a_explan_reg_stats)
ocir_prepan_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r ocir model0b sum_score prepan}
# Regression coefficients
ocir_prepan_model0b_explan_estimates <- model0b.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model0b_explan_estimates)
ocir_prepan_model0b_explan_estimates

# Regression diagnostic statistics
ocir_prepan_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model0b_explan_reg_stats)
ocir_prepan_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1a sum_score prepan}
# Regression coefficients
ocir_prepan_model1a_explan_estimates <- model1a.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1a_explan_estimates)
ocir_prepan_model1a_explan_estimates

# Regression diagnostic statistics
ocir_prepan_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1a_explan_reg_stats)
ocir_prepan_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1b sum_score prepan}
# Regression coefficients
ocir_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1b_explan_estimates)
ocir_prepan_model1b_explan_estimates

# Regression diagnostic statistics
ocir_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1b_explan_reg_stats)
ocir_prepan_model1b_explan_reg_stats
```


# OCIR retro
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r ocir model0a diff_score retro}
# Regression coefficients
ocir_retro_model0a_estimates <- model0a.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model0a_estimates)
ocir_retro_model0a_estimates

# Regression diagnostic statistics
ocir_retro_model0a_reg_stats <- model0a.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model0a_reg_stats)
ocir_retro_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r ocir model0b diff_score retro}
# Regression coefficients
ocir_retro_model0b_estimates <- model0b.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model0b_estimates)
ocir_retro_model0b_estimates

# Regression diagnostic statistics
ocir_retro_model0b_reg_stats <- model0b.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model0b_reg_stats)
ocir_retro_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1a diff_score retro}
# Regression coefficients
ocir_retro_model1a_estimates <- model1a.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model1a_estimates)
ocir_retro_model1a_estimates

# Regression diagnostic statistics
ocir_retro_model1a_reg_stats <- model1a.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model1a_reg_stats)
ocir_retro_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1b diff_score retro}
# Regression coefficients
ocir_retro_model1b_estimates <- model1b.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model1b_estimates)
ocir_retro_model1b_estimates

# Regression diagnostic statistics
ocir_retro_model1b_reg_stats <- model1b.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model1b_reg_stats)
ocir_retro_model1b_reg_stats
```

## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r ocir model0a sum_score retro}
# Regression coefficients
ocir_retro_model0a_explan_estimates <- model0a.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model0a_explan_estimates)
ocir_retro_model0a_explan_estimates

# Regression diagnostic statistics
ocir_retro_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model0a_explan_reg_stats)
ocir_retro_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r ocir model0b sum_score retro}
# Regression coefficients
ocir_retro_model0b_explan_estimates <- model0b.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model0b_explan_estimates)
ocir_retro_model0b_explan_estimates

# Regression diagnostic statistics
ocir_retro_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model0b_explan_reg_stats)
ocir_retro_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1a sum_score retro}
# Regression coefficients
ocir_retro_model1a_explan_estimates <- model1a.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model1a_explan_estimates)
ocir_retro_model1a_explan_estimates

# Regression diagnostic statistics
ocir_retro_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model1a_explan_reg_stats)
ocir_retro_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1b sum_score retro}
# Regression coefficients
ocir_retro_model1b_explan_estimates <- model1b.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model1b_explan_estimates)
ocir_retro_model1b_explan_estimates

# Regression diagnostic statistics
ocir_retro_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model1b_explan_reg_stats)
ocir_retro_model1b_explan_reg_stats
```



# PCL baseline, not controlling for prior symptoms
### Model 0a: Disorder_hierarchical, Unadjusted
```{r pcl model0a absolute whole sample}
# Regression coefficients
pcl_baseline_model0a_estimates <- model0a.estimates(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model0a_estimates)
pcl_baseline_model0a_estimates

# Regression diagnostic statistics
pcl_baseline_model0a_reg_stats <- model0a.reg.stats(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model0a_reg_stats)
pcl_baseline_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r pcl model0b absolute whole sample}
# Regression coefficients
pcl_baseline_model0b_estimates <- model0b.estimates(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model0b_estimates)
pcl_baseline_model0b_estimates

# Regression diagnostic statistics
pcl_baseline_model0b_reg_stats <- model0b.reg.stats(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model0b_reg_stats)
pcl_baseline_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r pcl model1a absolute whole sample}
# Regression coefficients
pcl_baseline_model1a_estimates <- model1a.estimates(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model1a_estimates)
pcl_baseline_model1a_estimates

# Regression diagnostic statistics
pcl_baseline_model1a_reg_stats <- model1a.reg.stats(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model1a_reg_stats)
pcl_baseline_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r pcl model1b absolute whole sample}
# Regression coefficients
pcl_baseline_model1b_estimates <- model1b.estimates(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model1b_estimates)
pcl_baseline_model1b_estimates

# Regression diagnostic statistics
pcl_baseline_model1b_reg_stats <- model1b.reg.stats(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model1b_reg_stats)
pcl_baseline_model1b_reg_stats
```

# PCL prepan
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r pcl model0a diff_score prepan}
# Regression coefficients
pcl_prepan_model0a_estimates <- model0a.estimates(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model0a_estimates)
pcl_prepan_model0a_estimates

# Regression diagnostic statistics
pcl_prepan_model0a_reg_stats <- model0a.reg.stats(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model0a_reg_stats)
pcl_prepan_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r pcl model0b diff_score prepan}
# Regression coefficients
pcl_prepan_model0b_estimates <- model0b.estimates(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model0b_estimates)
pcl_prepan_model0b_estimates

# Regression diagnostic statistics
pcl_prepan_model0b_reg_stats <- model0b.reg.stats(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model0b_reg_stats)
pcl_prepan_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r pcl model1a diff_score prepan}
# Regression coefficients
pcl_prepan_model1a_estimates <- model1a.estimates(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model1a_estimates)
pcl_prepan_model1a_estimates

# Regression diagnostic statistics
pcl_prepan_model1a_reg_stats <- model1a.reg.stats(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model1a_reg_stats)
pcl_prepan_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r pcl model1b diff_score prepan}
# Regression coefficients
pcl_prepan_model1b_estimates <- model1b.estimates(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model1b_estimates)
pcl_prepan_model1b_estimates

# Regression diagnostic statistics
pcl_prepan_model1b_reg_stats <- model1b.reg.stats(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model1b_reg_stats)
pcl_prepan_model1b_reg_stats
```

## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r pcl model0a sum_score prepan}
# Regression coefficients
pcl_prepan_model0a_explan_estimates <- model0a.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model0a_explan_estimates)
pcl_prepan_model0a_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model0a_explan_reg_stats)
pcl_prepan_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r pcl model0b sum_score prepan}
# Regression coefficients
pcl_prepan_model0b_explan_estimates <- model0b.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model0b_explan_estimates)
pcl_prepan_model0b_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model0b_explan_reg_stats)
pcl_prepan_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r pcl model1a sum_score prepan}
# Regression coefficients
pcl_prepan_model1a_explan_estimates <- model1a.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1a_explan_estimates)
pcl_prepan_model1a_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1a_explan_reg_stats)
pcl_prepan_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r pcl model1b sum_score prepan}
# Regression coefficients
pcl_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1b_explan_estimates)
pcl_prepan_model1b_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1b_explan_reg_stats)
pcl_prepan_model1b_explan_reg_stats
```
