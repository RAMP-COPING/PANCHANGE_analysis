---
title: "PANCHANGE_analysis"
author: "Katherine N Thompson, Christopher HÃ¼ebel, Molly R Davies, Kirstin L Purves"
date: '`r format(Sys.time(), "%d %B, %Y")`'
output:
  html_document:
    df_print: paged
    toc: yes
    toc_depth: 2
    toc_float:
      collapsed: false
    number_sections: false
    highlight: monochrome
    theme: cerulean
code_folding: show

html_notebook:
  theme: cerulean
toc: yes
---

This is the analysis script to prepare the data to run analyses for the project "Anxiety, depression and trauma symptom change during the COVID-19 pandemic: retrospective versus objective assessment" - Young et al (2020)

Script written by K L Purves, K N Thompson, C Huebel and M Davies.
Email: kirstin.purves@kcl.ac.uk, katie.thompson@kcl.ac.uk, christopher.1.huebel@kcl.ac.uk, molly.davies@kcl.ac.uk

#Set up
```{r Setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      comment=NA,
                      prompt=FALSE,
                      cache=FALSE)


options(bitmapType = 'quartz') # to render fonts better
```

Clear global environment
```{r Clear global environment}
remove(list = ls())
```

Retrieve the current date to use it for file endings to not overwrite files when one exports files
```{r Recent date}
date = Sys.Date()
```

#Packages
Install packages (if they are not available in your version of R)
```{r Installing packages}
#install.packages("summarytools")
#install.packages("tidyverse")
#install.packages("psych")
#install.packages("broom")
#install.packages("skimr")
#install.packages("polycor")
#install.packages("corrplot")
#install.packages("patchwork")
#install.packages("ggpubr")
```

Load packages
```{r Load packages}
library(knitr)
library(summarytools)
library(psych)
library(polycor)
library(corrplot)
library(patchwork)
library(broom)
library(tidyverse)
library(ggpubr)
```

# R functions
## Half-violin plot
```{r Half-violin plot}
source("https://raw.githubusercontent.com/datavizpyr/data/master/half_flat_violinplot.R")
```


# Colour palettes
Define colours for plotting this are the standard coping colours
```{r Colour palettes: COPING}
COPINGpalette2 <- c("#78D9C5",
                    "#F5BE5E")

COPINGpalette3 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9")

COPINGpalette4 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73")

COPINGpalette5 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73",
                    "#FFED98")

COPINGpalette6 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73",
                    "#FFED98",
                    "#BFD2EB")

COPINGpalette7 <- c("#78D9C5",
                    "#F5BE5E",
                    "#EEB6E9",
                    "#DBDB73",
                    "#FFED98",
                    "#BFD2EB",
                    "#808080")

COPINGpaletteGRAD <- c("#F5BE5E",
                       "#FFD284",
                       "#FFEED1",
                       "#B5B5B5",
                       "#DEFFF8",
                       "#94F6E1",
                       "#78D9C5")

COPINGNeuCenterpalette <- c("#78D9C5",
                            "#808080",
                            "#F5BE5E")

RAMPworseGRADpalette <- c("#78D9C5",
                          "#FFEED1",
                          "#F5BE5E",
                          "#FFB1B5")
GLADpalette = c("#efc00b",
                "#b7dee8")
```

Choose in this chunk which palette to use
04.07.2020 - Default to 2 colour COPING palette
```{r Choose colour palette}
palette = COPINGpalette2
```

# ggplot theme
Set up ggplot theme for the plots
```{r ggplot theme}
theme_personal <-  theme(
    text = element_text(color = "black"),
    axis.title = element_text(color = "black"),
    axis.text = element_text(color = "black"),
    axis.title.y = element_blank(),
    legend.background = element_blank(),
    legend.box.background = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.major.x = element_line(
      colour = "gray",
      linetype = "dashed",
      size = 0.2
      ),
    axis.ticks = element_blank()
    )
```

# Function for split violin plot
```{r Function for split violin plot}
GeomSplitViolin <- ggproto("GeomSplitViolin", GeomViolin, 
                           draw_group = function(self, data, ..., draw_quantiles = NULL) {
  data <- transform(data, xminv = x - violinwidth * (x - xmin), xmaxv = x + violinwidth * (xmax - x))
  grp <- data[1, "group"]
  newdata <- plyr::arrange(transform(data, x = if (grp %% 2 == 1) xminv else xmaxv), if (grp %% 2 == 1) y else -y)
  newdata <- rbind(newdata[1, ], newdata, newdata[nrow(newdata), ], newdata[1, ])
  newdata[c(1, nrow(newdata) - 1, nrow(newdata)), "x"] <- round(newdata[1, "x"])

  if (length(draw_quantiles) > 0 & !scales::zero_range(range(data$y))) {
    stopifnot(all(draw_quantiles >= 0), all(draw_quantiles <=
      1))
    quantiles <- ggplot2:::create_quantile_segment_frame(data, draw_quantiles)
    aesthetics <- data[rep(1, nrow(quantiles)), setdiff(names(data), c("x", "y")), drop = FALSE]
    aesthetics$alpha <- rep(1, nrow(quantiles))
    both <- cbind(quantiles, aesthetics)
    quantile_grob <- GeomPath$draw_panel(both, ...)
    ggplot2:::ggname("geom_split_violin", grid::grobTree(GeomPolygon$draw_panel(newdata, ...), quantile_grob))
  }
  else {
    ggplot2:::ggname("geom_split_violin", GeomPolygon$draw_panel(newdata, ...))
  }
})

geom_split_violin <- function(mapping = NULL, data = NULL, stat = "ydensity", position = "identity", ..., 
                              draw_quantiles = NULL, trim = TRUE, scale = "area", na.rm = FALSE, 
                              show.legend = NA, inherit.aes = TRUE) {
  layer(data = data, mapping = mapping, stat = stat, geom = GeomSplitViolin, 
        position = position, show.legend = show.legend, inherit.aes = inherit.aes, 
        params = list(trim = trim, scale = scale, draw_quantiles = draw_quantiles, na.rm = na.rm, ...))
}
```



# Data import

## Source data file paths

```{r source file path}
#source data directory: data_path
source("../PANCHANGE_raw_path.R")

print(data_path)

```


## Read in data
```{r read in data}
dat <- readRDS(file = paste0(data_path, "/four_cohorts_variables_exclusion.rds"))
dim(dat)
colnames(dat)
```

## Important vectors with collections of columns

## Vectors for sum_score

```{r Vectors with sum_score_cols}
sum_score_cols <- dat %>%
  select(contains("sum_score")) %>%
  select(-ends_with("raw")) %>%
  colnames()

sum_score_cols

phq.sum_score_cols <- dat %>%
  select(contains("phq")) %>%
  select(contains("sum_score")) %>%
  select(-ends_with("raw")) %>%
  select(-contains("8items")) %>%
  colnames()

phq.sum_score_cols

gad.sum_score_cols <- dat %>%
  select(contains("gad")) %>%
  select(contains("sum_score")) %>%
  select(-ends_with("raw")) %>%
  colnames()

gad.sum_score_cols

ocir.sum_score_cols <- dat %>%
  select(contains("ocir")) %>%
  select(contains("sum_score")) %>%
  select(-ends_with("raw")) %>%
  colnames()

ocir.sum_score_cols

pcl.sum_score_cols <- dat %>%
  select(contains("pcl")) %>%
  select(contains("sum_score")) %>%
  select(-ends_with("raw")) %>%
  colnames()

pcl.sum_score_cols
```

## Vectors for diff_score

```{r Vectors with diff_score_cols}
diff_score_cols <- dat %>%
  select(contains("diff_score")) %>%
  colnames()

diff_score_cols

phq.diff_score_cols <- dat %>%
  select(contains("phq")) %>%
  select(contains("diff_score")) %>%
  colnames()

phq.diff_score_cols

gad.diff_score_cols <- dat %>%
  select(contains("gad")) %>%
  select(contains("diff_score")) %>%
  colnames()

gad.diff_score_cols

ocir.diff_score_cols <- dat %>%
  select(contains("ocir")) %>%
  select(contains("diff_score")) %>%
  colnames()

ocir.diff_score_cols
```

#ANALYSIS PLAN
1. Calculate mean change per disorder group
    i. Disorders (9)
      a. Rank the disorders by the size of the change
    ii. Sex
    iii. Age (13; RAMP; potentially collapse above 65 depending on group sizes)
    iv. Ethnicity groups (5; White European, Black (British), Asian, Arab, Mixed)

# 1. Questionnaire comparions: Calculate mean change per group

## gad
### Summary scores
```{r descriptives gad.sum_score_cols}
gad.sum_score_numeric_table <- dat %>%
  group_by(gad.change_binary) %>%
  summarise_at(
    vars(
      "Prepan" = gad.sum_score_prepan,
      "Base" = gad.sum_score_base,
      "Retro" = gad.sum_score_retro
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

gad.sum_score_numeric_table
```

```{r gad sum score smart numeric summary tables}
# reshape the table
gad.sum_score_numeric_summary_table_reshaped <- gad.sum_score_numeric_table %>%
  gather(key, value, -gad.change_binary) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    Change = Gad.change_binary,
    SD = Sd
  )

gad.sum_score_numeric_summary_table_reshaped
```

Table for knitting
gad sum score summary table
```{r gad sum score summary table}
kable(gad.sum_score_numeric_summary_table_reshaped)
```

### Differences scores

```{r descriptives gad.diff_score_cols}
gad.numeric_table <- dat %>%
  group_by(gad.change_binary) %>%
  summarise_at(
    vars(
      "Base - prepan" = gad.diff_score_base_prepan,
      "Base - retro" = gad.diff_score_base_retro,
      "Prepan - retro" = gad.diff_score_retro_prepan
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

gad.numeric_table
```

```{r gad diff score smart numeric summary tables}
# reshape the table
gad.numeric_summary_table_reshaped <- gad.numeric_table %>%
  gather(key, value, -gad.change_binary) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
    ) %>%
  # or we can individually rename variables
  rename(
    Change = Gad.change_binary,
    SD = Sd
  )

gad.numeric_summary_table_reshaped
```

Table for knitting
gad diff summary table
```{r gad diff summary table}
kable(gad.numeric_summary_table_reshaped)
```

### Long format

```{r gad gather to long format Time_points gad.diff_score}
dat.long.gad.diff <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "gad.diff_score",
    all_of(gad.diff_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    gad.diff_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "gad.diff_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.gad.diff)
```

```{r gad gather to long format Time_points gad.sum_score}
dat.long.gad.sum <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "gad.sum_score",
    all_of(gad.sum_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    gad.sum_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "gad.sum_score_", "")) %>%
  select(-Time_point_raw) %>%
  add_column(Full_cohort = as.factor("Full cohort")) %>%
  mutate(Time_point_dup = Time_point)

head(dat.long.gad.sum)
```


### Plots diff

makes this into percentages
```{r gad absolut plot}
dat.long.gad.diff %>%
  ggplot(mapping = aes(y = gad.diff_score)) +
  geom_bar() +
  theme_minimal() +
  facet_wrap(facets = vars(Time_point))
```

```{r gad percentage plot retro_prepan diff}
dat.long.gad.diff %>%
  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = gad.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference GAD7 score",
    y = "Percentage of participants",
    fill = "Comparison:\nBaseline vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic", "Retrospective"))
```


```{r gad percentage plot retro_prepan resized, fig.height=6, fig.width=10}
dat.long.gad.diff %>%
  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = gad.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference GAD7 score",
    y = "Percentage of participants",
    fill = "Comparison:\nBaseline vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic", "Retrospective")) +
  facet_wrap("Disorder_hierarchical")
```



```{r gad plot retro_prepan diff}
dat.long.gad.diff %>%
  filter(Time_point == "retro_prepan") %>%
  ggplot(mapping = aes(
    x = gad.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference GAD7 score",
    y = "Percentage of participants",
    fill = "Comparison:\nRetrospective vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic"))
```

### Plots sum

```{r gad percentage plot retro_prepan sum}
dat.long.gad.sum %>%
#  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = gad.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "GAD7 scores",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
    )
```

```{r gad percentage plot retro_prepan sum resized, fig.height=6, fig.width=10}
dat.long.gad.sum %>%
#  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = gad.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "GAD7 score",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
    ) +
  facet_wrap("Disorder_hierarchical")
```

### Violin plots

```{r gad.sum violin plot}
dat.long.gad.sum %>%
  mutate(Time_point_renamed = fct_recode(Time_point, 
            "Prepandemic" = "prepan",
            "Retrospective" = "retro",
            "Baseline" = "base")
         ) %>%
         mutate(Time_point_reordered = fct_relevel(Time_point_renamed, 
            "Baseline",
            "Retrospective",
            "Prepandemic")
         ) %>%
  ggplot(mapping = aes(
    x = Time_point_reordered,
    y = gad.sum_score,
    fill = Time_point_reordered)) +
  geom_hline(yintercept = 5, linetype = "dashed", color = "gray") +
  geom_hline(yintercept = 10, linetype = "dashed", color = "gray") +
  geom_hline(yintercept = 15, linetype = "dashed", color = "gray") +
  geom_flat_violin(
    position = position_nudge(x = .2, y = 0),
    trim = FALSE,
    alpha = 0.5
    ) +
  geom_point(
    aes(
      y = gad.sum_score,
      color = Time_point_reordered),
    position = position_jitter(width = .15),
    size = .5,
    alpha = 0.8) +
#  geom_boxplot(
#    width = .1,
#    guides = FALSE,
#    outlier.shape = NA,
#    alpha = 0.5) +
 stat_summary(fun.y = mean,
              fun.ymin = function(x) mean(x) - sd(x), 
              fun.ymax = function(x) mean(x) + sd(x), 
              geom = "pointrange"
              ) +
  labs(
    y = "GAD7 scores",
    fill = "Time point") +
  theme_personal +
  theme(
    axis.text.y = element_blank()
  ) +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline")
) +
  scale_alpha(guide = 'none') +
  scale_size(guide = 'none') +
  scale_color_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline"),
    guide = "none") +
  coord_flip()
```

```{r gad.sum violin plot Sample, fig.height=14, fig.width=8}
dat.long.gad.sum %>%
  mutate(Time_point_renamed = fct_recode(Time_point, 
            "Prepandemic" = "prepan",
            "Retrospective" = "retro",
            "Baseline" = "base")
         ) %>%
         mutate(Time_point_reordered = fct_relevel(Time_point_renamed, 
            "Baseline",
            "Retrospective",
            "Prepandemic")
         ) %>%
  ggplot(mapping = aes(
    x = Time_point_reordered,
    y = gad.sum_score,
    fill = Time_point_reordered)) +
  geom_hline(yintercept = 5, linetype = "dashed", color = "gray") +
  geom_hline(yintercept = 10, linetype = "dashed", color = "gray") +
  geom_hline(yintercept = 15, linetype = "dashed", color = "gray") +
  geom_flat_violin(
    position = position_nudge(x = .2, y = 0),
    trim = FALSE,
    alpha = 0.5
    ) +
  geom_point(
    aes(
      y = gad.sum_score,
      color = Time_point_reordered),
    position = position_jitter(width = .15),
    size = .5,
    alpha = 0.8) +
#  geom_boxplot(
#    width = .1,
#    guides = FALSE,
#    outlier.shape = NA,
#    alpha = 0.5) +
 stat_summary(fun.y = mean,
              fun.ymin = function(x) mean(x) - sd(x), 
              fun.ymax = function(x) mean(x) + sd(x), 
              geom = "pointrange"
              ) +
  labs(
    y = "GAD7 scores",
    fill = "Time point") +
  theme_personal +
  theme(
    axis.text.y = element_blank()
  ) +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline")) +
  scale_alpha(guide = 'none') +
  scale_size(guide = 'none') +
  scale_color_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline"),
    guide = "none") +
  facet_wrap(facets = vars(Sample),
             nrow = 4
             ) +
  coord_flip()

```

```{r gad.sum violin plot Disorder_hierarchical, fig.height=18, fig.width=20}
dat.long.gad.sum %>%
  mutate(Time_point_renamed = fct_recode(Time_point, 
            "Prepandemic" = "prepan",
            "Retrospective" = "retro",
            "Baseline" = "base")
         ) %>%
         mutate(Time_point_reordered = fct_relevel(Time_point_renamed, 
            "Baseline",
            "Retrospective",
            "Prepandemic")
         ) %>%
  ggplot(mapping = aes(
    x = Time_point_reordered,
    y = gad.sum_score,
    fill = Time_point_reordered)) +
  geom_hline(yintercept = 5, linetype = "dashed", color = "gray") +
  geom_hline(yintercept = 10, linetype = "dashed", color = "gray") +
  geom_hline(yintercept = 15, linetype = "dashed", color = "gray") +
  geom_flat_violin(
    position = position_nudge(x = .2, y = 0),
    trim = FALSE,
    alpha = 0.5
    ) +
  geom_point(
    aes(
      y = gad.sum_score,
      color = Time_point_reordered),
    position = position_jitter(width = .15),
    size = .5,
    alpha = 0.8) +
#  geom_boxplot(
#    width = .1,
#    guides = FALSE,
#    outlier.shape = NA,
#    alpha = 0.5) +
 stat_summary(fun.y = mean,
              fun.ymin = function(x) mean(x) - sd(x), 
              fun.ymax = function(x) mean(x) + sd(x), 
              geom = "pointrange"
              ) +
  labs(
    y = "GAD7 scores",
    fill = "Time point") +
  theme_personal +
  theme(
    axis.text.y = element_blank()
  ) +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline")) +
  scale_alpha(guide = 'none') +
  scale_size(guide = 'none') +
  scale_color_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline"),
    guide = "none") +
  facet_wrap(facets = vars(Disorder_hierarchical)
             ) +
  coord_flip()
```



## phq

### Summary scores
```{r descriptives phq.sum_score}
phq.sum_score_numeric_table <- dat %>%
  group_by(phq.change_binary) %>%
  summarise_at(
    vars(
      "Prepan" = phq.sum_score_prepan,
      "Base" = phq.sum_score_base,
      "Retro" = phq.sum_score_retro
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

phq.sum_score_numeric_table
```

```{r phq sum score smart numeric summary tables}
# reshape the table
phq.sum_score_numeric_summary_table_reshaped <- phq.sum_score_numeric_table %>%
  gather(key, value, -phq.change_binary) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    SD = Sd
  )

phq.sum_score_numeric_summary_table_reshaped
```

Table for knitting
phq sum score summary table
```{r phq sum score summary table}
kable(phq.sum_score_numeric_summary_table_reshaped)
```

### Differences score

```{r descriptives phq.diff_score_cols}
phq.numeric_table <- dat %>%
  group_by(phq.change_binary) %>%
  summarise_at(
    vars(
      "Base - prepan" = phq.diff_score_base_prepan,
      "Base - retro" = phq.diff_score_base_retro,
      "Prepan - retro" = phq.diff_score_retro_prepan
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

phq.numeric_table
```

```{r phq diff score smart numeric summary tables}
# reshape the table
phq.numeric_summary_table_reshaped <- phq.numeric_table %>%
  gather(key, value, -phq.change_binary) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    SD = Sd
  )

phq.numeric_summary_table_reshaped
```

Table for knitting
phq diff summary table
```{r phq diff summary table}
kable(phq.numeric_summary_table_reshaped)
```

### Long format

```{r phq gather to long format Time_points}
dat.long.phq.diff <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "phq.diff_score",
    all_of(phq.diff_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    phq.diff_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "phq.diff_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.phq.diff)
```

```{r phq gather to long format Time_points phq.sum_score}
dat.long.phq.sum <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "phq.sum_score",
    all_of(phq.sum_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    phq.sum_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "phq.sum_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.phq.sum)
```

### Plots

makes this into percentages
```{r phq absolut plot}
dat.long.phq.diff %>%
  ggplot(mapping = aes(y = phq.diff_score)) +
  geom_bar() +
  theme_minimal() +
  facet_wrap(facets = vars(Time_point))
```


```{r phq percentage plot retro_prepan}
dat.long.phq.diff %>%
  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = phq.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference PHQ9 score",
    y = "Percentage of participants",
    fill = "Comparison:\nBaseline vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic", "Retrospective"))
```

```{r phq plot retro_prepan diff}
dat.long.phq.diff %>%
  filter(Time_point == "retro_prepan") %>%
  ggplot(mapping = aes(
    x = phq.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference phq7 score",
    y = "Percentage of participants",
    fill = "Comparison:\nPrepandemic vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Retrospective"))
```

```{r phq percentage plot retro_prepan resized, fig.height=6, fig.width=10}
dat.long.phq.diff %>%
  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = phq.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference PHQ9 score",
    y = "Percentage of participants",
    fill = "Comparison:\nBaseline vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic", "Retrospective")
    ) +
  facet_wrap("Disorder_hierarchical")
```

### Plots sum

```{r phq percentage plot retro_prepan sum}
dat.long.phq.sum %>%
  #  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = phq.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "PHQ9 scores",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
  )
```

```{r phq percentage plot retro_prepan sum resized, fig.height=6, fig.width=10}
dat.long.phq.sum %>%
  #  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = phq.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "PHQ9 score",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
  ) +
  facet_wrap("Disorder_hierarchical")
```


### Violin plots

```{r phq.sum violin plot}
dat.long.phq.sum %>%
  mutate(Time_point_renamed = fct_recode(Time_point, 
                                         "Prepandemic" = "prepan",
                                         "Retrospective" = "retro",
                                         "Baseline" = "base")
  ) %>%
  mutate(Time_point_reordered = fct_relevel(Time_point_renamed, 
                                            "Baseline",
                                            "Retrospective",
                                            "Prepandemic")
  ) %>%
  ggplot(mapping = aes(
    x = Time_point_reordered,
    y = phq.sum_score,
    fill = Time_point_reordered)) +
  geom_hline(yintercept = 8, linetype = "dashed", color = "gray") +
  geom_hline(yintercept = 11, linetype = "dashed", color = "gray") +
#  geom_hline(yintercept = 15, linetype = "dashed", color = "gray") +
  geom_flat_violin(
    position = position_nudge(x = .2, y = 0),
    trim = FALSE,
    alpha = 0.5
  ) +
  geom_point(
    aes(
      y = phq.sum_score,
      color = Time_point_reordered),
    position = position_jitter(width = .15),
    size = .5,
    alpha = 0.8) +
  #  geom_boxplot(
  #    width = .1,
  #    guides = FALSE,
  #    outlier.shape = NA,
  #    alpha = 0.5) +
  stat_summary(fun.y = mean,
               fun.ymin = function(x) mean(x) - sd(x), 
               fun.ymax = function(x) mean(x) + sd(x), 
               geom = "pointrange"
  ) +
  labs(
    y = "PHQ9 scores",
    fill = "Time point") +
  theme_personal +
  theme(
    axis.text.y = element_blank()
  ) +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline")
  ) +
  scale_alpha(guide = 'none') +
  scale_size(guide = 'none') +
  scale_color_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline"),
    guide = "none") +
  coord_flip()
```

```{r phq.sum violin plot Sample, fig.height=14, fig.width=8}
dat.long.phq.sum %>%
  mutate(Time_point_renamed = fct_recode(Time_point, 
                                         "Prepandemic" = "prepan",
                                         "Retrospective" = "retro",
                                         "Baseline" = "base")
  ) %>%
  mutate(Time_point_reordered = fct_relevel(Time_point_renamed, 
                                            "Baseline",
                                            "Retrospective",
                                            "Prepandemic")
  ) %>%
  ggplot(mapping = aes(
    x = Time_point_reordered,
    y = phq.sum_score,
    fill = Time_point_reordered)) +
  geom_hline(yintercept = 8, linetype = "dashed", color = "gray") +
  geom_hline(yintercept = 11, linetype = "dashed", color = "gray") +
#  geom_hline(yintercept = 15, linetype = "dashed", color = "gray") +
  geom_flat_violin(
    position = position_nudge(x = .2, y = 0),
    trim = FALSE,
    alpha = 0.5
  ) +
  geom_point(
    aes(
      y = phq.sum_score,
      color = Time_point_reordered),
    position = position_jitter(width = .15),
    size = .5,
    alpha = 0.8) +
  #  geom_boxplot(
  #    width = .1,
  #    guides = FALSE,
  #    outlier.shape = NA,
  #    alpha = 0.5) +
  stat_summary(fun.y = mean,
               fun.ymin = function(x) mean(x) - sd(x), 
               fun.ymax = function(x) mean(x) + sd(x), 
               geom = "pointrange"
  ) +
  labs(
    y = "PHQ9 scores",
    fill = "Time point") +
  theme_personal +
  theme(
    axis.text.y = element_blank()
  ) +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline")) +
  scale_alpha(guide = 'none') +
  scale_size(guide = 'none') +
  scale_color_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline"),
    guide = "none") +
  facet_wrap(facets = vars(Sample),
             nrow = 4
  ) +
  coord_flip()
```

```{r phq.sum violin plot Disorder_hierarchical, fig.height=18, fig.width=20}
dat.long.phq.sum %>%
  mutate(Time_point_renamed = fct_recode(Time_point, 
                                         "Prepandemic" = "prepan",
                                         "Retrospective" = "retro",
                                         "Baseline" = "base")
  ) %>%
  mutate(Time_point_reordered = fct_relevel(Time_point_renamed, 
                                            "Baseline",
                                            "Retrospective",
                                            "Prepandemic")
  ) %>%
  ggplot(mapping = aes(
    x = Time_point_reordered,
    y = phq.sum_score,
    fill = Time_point_reordered)) +
  geom_hline(yintercept = 8, linetype = "dashed", color = "gray") +
  geom_hline(yintercept = 11, linetype = "dashed", color = "gray") +
#  geom_hline(yintercept = 15, linetype = "dashed", color = "gray") +
  geom_flat_violin(
    position = position_nudge(x = .2, y = 0),
    trim = FALSE,
    alpha = 0.5
  ) +
  geom_point(
    aes(
      y = phq.sum_score,
      color = Time_point_reordered),
    position = position_jitter(width = .15),
    size = .5,
    alpha = 0.8) +
  #  geom_boxplot(
  #    width = .1,
  #    guides = FALSE,
  #    outlier.shape = NA,
  #    alpha = 0.5) +
  stat_summary(fun.y = mean,
               fun.ymin = function(x) mean(x) - sd(x), 
               fun.ymax = function(x) mean(x) + sd(x), 
               geom = "pointrange"
  ) +
  labs(
    y = "PHQ9 scores",
    fill = "Time point") +
  theme_personal +
  theme(
    axis.text.y = element_blank()
  ) +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline")) +
  scale_alpha(guide = 'none') +
  scale_size(guide = 'none') +
  scale_color_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline"),
    guide = "none") +
  facet_wrap(facets = vars(Disorder_hierarchical)
  ) +
  coord_flip()
```


## ocir

### Summary scores
```{r descriptives ocir.sum_score}
ocir.sum_score_numeric_table <- dat %>%
  group_by(ocir.change_binary) %>%
  summarise_at(
    vars(
      "Prepan" = ocir.sum_score_prepan,
      "Base" = ocir.sum_score_base,
      "Retro" = ocir.sum_score_retro
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

ocir.sum_score_numeric_table
```

```{r ocir sum score smart numeric summary tables}
# reshape the table
ocir.sum_score_numeric_summary_table_reshaped <- ocir.sum_score_numeric_table %>%
  filter(ocir.change_binary == "Worsening") %>%
  select(-ocir.change_binary) %>%
  gather(key, value) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    SD = Sd
  )

ocir.sum_score_numeric_summary_table_reshaped
```

Table for knitting
ocir sum score summary table
```{r ocir sum score summary table}
kable(ocir.sum_score_numeric_summary_table_reshaped)
```

### Differences scores

```{r descriptives ocir.diff_score_cols}
ocir.numeric_table <- dat %>%
  #  group_by(dem.sex) %>%
  summarise_at(
    vars(
      "Base - prepan" = ocir.diff_score_base_prepan,
      "Base - retro" = ocir.diff_score_base_retro,
      "Prepan - retro" = ocir.diff_score_retro_prepan
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

ocir.numeric_table
```

```{r ocir diff score smart numeric summary tables}
# reshape the table
ocir.numeric_summary_table_reshaped <- ocir.numeric_table %>%
  gather(key, value) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    SD = Sd
  )

ocir.numeric_summary_table_reshaped
```

Table for knitting
ocir diff summary table
```{r ocir diff summary table}
kable(ocir.numeric_summary_table_reshaped)
```

### Long format

```{r ocir gather to long format Time_points}
dat.long.ocir.diff <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "ocir.diff_score",
    all_of(ocir.diff_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    ocir.diff_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "ocir.diff_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.ocir.diff)
```

```{r ocir gather to long format Time_points ocir.sum_score}
dat.long.ocir.sum <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "ocir.sum_score",
    all_of(ocir.sum_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    ocir.sum_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "ocir.sum_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.ocir.sum)
```

### Plots

makes this into percentages
```{r ocir absolut plot}
dat.long.ocir.diff %>%
  ggplot(mapping = aes(y = ocir.diff_score)) +
  geom_bar() +
  theme_minimal() +
  facet_wrap(facets = vars(Time_point))
```

```{r ocir percentage plot retro_prepan}
dat.long.ocir.diff %>%
  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = ocir.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference OCI-R score",
    y = "Percentage of participants",
    fill = "Comparison:\nBaseline vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic", "Retrospective"))
```

```{r ocir plot retro_prepan diff}
dat.long.ocir.diff %>%
  filter(Time_point == "retro_prepan") %>%
  ggplot(mapping = aes(
    x = ocir.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference ocir7 score",
    y = "Percentage of participants",
    fill = "Comparison:\nPrepandemic vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Retrospective"))
```

```{r ocir percentage plot retro_prepan resized, fig.height=6, fig.width=10}
dat.long.ocir.diff %>%
  filter(Time_point != "retro_prepan") %>%
  ggplot(mapping = aes(
    x = ocir.diff_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "Difference OCI-R score",
    y = "Percentage of participants",
    fill = "Comparison:\nBaseline vs") +
  theme_personal +
  scale_fill_manual(
    values = palette,
    labels = c("Prepandemic", "Retrospective")) +
  facet_wrap("Disorder_hierarchical")
```

### Plots sum

```{r ocir percentage plot retro_prepan sum}
dat.long.ocir.sum %>%
  ggplot(mapping = aes(
    x = ocir.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "OCI-R scores",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
  )
```

```{r ocir percentage plot retro_prepan sum resized, fig.height=6, fig.width=10}
dat.long.ocir.sum %>%
  ggplot(mapping = aes(
    x = ocir.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "OCI-R score",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
  ) +
  facet_wrap("Disorder_hierarchical")
```


### Violin plots

```{r ocir.sum violin plot}
dat.long.ocir.sum %>%
  mutate(Time_point_renamed = fct_recode(Time_point, 
                                         "Prepandemic" = "prepan",
                                         "Retrospective" = "retro",
                                         "Baseline" = "base")
  ) %>%
  mutate(Time_point_reordered = fct_relevel(Time_point_renamed, 
                                            "Baseline",
                                            "Retrospective",
                                            "Prepandemic")
  ) %>%
  ggplot(mapping = aes(
    x = Time_point_reordered,
    y = ocir.sum_score,
    fill = Time_point_reordered)) +
  geom_hline(yintercept = 21, linetype = "dashed", color = "gray") +
#  geom_hline(yintercept = 10, linetype = "dashed", color = "gray") +
#  geom_hline(yintercept = 15, linetype = "dashed", color = "gray") +
  geom_flat_violin(
    position = position_nudge(x = .2, y = 0),
    trim = FALSE,
    alpha = 0.5
  ) +
  geom_point(
    aes(
      y = ocir.sum_score,
      color = Time_point_reordered),
    position = position_jitter(width = .15),
    size = .5,
    alpha = 0.8) +
  #  geom_boxplot(
  #    width = .1,
  #    guides = FALSE,
  #    outlier.shape = NA,
  #    alpha = 0.5) +
  stat_summary(fun.y = mean,
               fun.ymin = function(x) mean(x) - sd(x), 
               fun.ymax = function(x) mean(x) + sd(x), 
               geom = "pointrange"
  ) +
  labs(
    y = "OCI-R scores",
    fill = "Time point") +
  theme_personal +
  theme(
    axis.text.y = element_blank()
  ) +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline")
  ) +
  scale_alpha(guide = 'none') +
  scale_size(guide = 'none') +
  scale_color_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline"),
    guide = "none") +
  coord_flip()
```

```{r ocir.sum violin plot Sample, fig.height=14, fig.width=8}
dat.long.ocir.sum %>%
  mutate(Time_point_renamed = fct_recode(Time_point, 
                                         "Prepandemic" = "prepan",
                                         "Retrospective" = "retro",
                                         "Baseline" = "base")
  ) %>%
  mutate(Time_point_reordered = fct_relevel(Time_point_renamed, 
                                            "Baseline",
                                            "Retrospective",
                                            "Prepandemic")
  ) %>%
  ggplot(mapping = aes(
    x = Time_point_reordered,
    y = ocir.sum_score,
    fill = Time_point_reordered)) +
  geom_hline(yintercept = 21, linetype = "dashed", color = "gray") +
#  geom_hline(yintercept = 10, linetype = "dashed", color = "gray") +
#  geom_hline(yintercept = 15, linetype = "dashed", color = "gray") +
  geom_flat_violin(
    position = position_nudge(x = .2, y = 0),
    trim = FALSE,
    alpha = 0.5
  ) +
  geom_point(
    aes(
      y = ocir.sum_score,
      color = Time_point_reordered),
    position = position_jitter(width = .15),
    size = .5,
    alpha = 0.8) +
  #  geom_boxplot(
  #    width = .1,
  #    guides = FALSE,
  #    outlier.shape = NA,
  #    alpha = 0.5) +
  stat_summary(fun.y = mean,
               fun.ymin = function(x) mean(x) - sd(x), 
               fun.ymax = function(x) mean(x) + sd(x), 
               geom = "pointrange"
  ) +
  labs(
    y = "OCI-R scores",
    fill = "Time point") +
  theme_personal +
  theme(
    axis.text.y = element_blank()
  ) +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline")) +
  scale_alpha(guide = 'none') +
  scale_size(guide = 'none') +
  scale_color_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline"),
    guide = "none") +
  facet_wrap(facets = vars(Sample),
             nrow = 4
  ) +
  coord_flip()
```

```{r ocir.sum violin plot Disorder_hierarchical, fig.height=18, fig.width=20}
dat.long.ocir.sum %>%
  mutate(Time_point_renamed = fct_recode(Time_point, 
                                         "Prepandemic" = "prepan",
                                         "Retrospective" = "retro",
                                         "Baseline" = "base")
  ) %>%
  mutate(Time_point_reordered = fct_relevel(Time_point_renamed, 
                                            "Baseline",
                                            "Retrospective",
                                            "Prepandemic")
  ) %>%
  ggplot(mapping = aes(
    x = Time_point_reordered,
    y = ocir.sum_score,
    fill = Time_point_reordered)) +
  geom_hline(yintercept = 21, linetype = "dashed", color = "gray") +
#  geom_hline(yintercept = 10, linetype = "dashed", color = "gray") +
#  geom_hline(yintercept = 15, linetype = "dashed", color = "gray") +
  geom_flat_violin(
    position = position_nudge(x = .2, y = 0),
    trim = FALSE,
    alpha = 0.5
  ) +
  geom_point(
    aes(
      y = ocir.sum_score,
      color = Time_point_reordered),
    position = position_jitter(width = .15),
    size = .5,
    alpha = 0.8) +
  #  geom_boxplot(
  #    width = .1,
  #    guides = FALSE,
  #    outlier.shape = NA,
  #    alpha = 0.5) +
  stat_summary(fun.y = mean,
               fun.ymin = function(x) mean(x) - sd(x), 
               fun.ymax = function(x) mean(x) + sd(x), 
               geom = "pointrange"
  ) +
  labs(
    y = "OCI-R scores",
    fill = "Time point") +
  theme_personal +
  theme(
    axis.text.y = element_blank()
  ) +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline")) +
  scale_alpha(guide = 'none') +
  scale_size(guide = 'none') +
  scale_color_manual(
    values = COPINGpalette3,
    breaks = c("Prepandemic", "Retrospective", "Baseline"),
    guide = "none") +
  facet_wrap(facets = vars(Disorder_hierarchical)
  ) +
  coord_flip()
```

++CH: Rank the disorders by the size of the change



PCL:
Calculate the total GLAD, COPING, RAMP baseline
## PCL

```{r descriptives pcl.diff_score_cols}
pcl.numeric_table <- dat %>%
#    group_by(Sample) %>%
  summarise_at(
    vars(
      "Base - prepan" = pcl.diff_score_base_prepan
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

pcl.numeric_table
```

```{r pcl sum score smart numeric summary tables}
# reshape the table
pcl.numeric_summary_table_reshaped <- pcl.numeric_table %>%
  gather(key, value) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    SD = Sd
  )

pcl.numeric_summary_table_reshaped
```

Table for knitting
pcl sum score summary table
```{r pcl sum score summary table}
kable(pcl.numeric_summary_table_reshaped)
```


```{r descriptives pcl.sum_score}
pcl.sum_score_numeric_table <- dat %>%
#    group_by(Sample) %>%
  summarise_at(
    vars(
      "Prepan" = pcl.sum_score_prepan,
      "Base" = pcl.sum_score_base
    ),
    .funs =
      list(
        ~mean(., na.rm = T),
        ~sd(., na.rm = T),
        ~median(., na.rm = T),
        ~min(., na.rm = T),
        ~max(., na.rm = T),
        ~skew(., na.rm = T),
        kurtosis = ~kurtosi(., na.rm = T)
      )
  )

pcl.numeric_table
```

```{r pcl diff score smart numeric summary tables}
# reshape the table
pcl.sum_score_numeric_summary_table_reshaped <- pcl.sum_score_numeric_table %>%
  gather(key, value) %>%
  separate(key, c("variable", "measure"), sep = "_") %>%
  mutate(measure = factor(
    x = measure,
    levels =  c( # this is the order I want my columns to appear in
      "missing",
      "min",
      "max",
      "mean",
      "median",
      "mode",
      "sd",
      "skew",
      "kurtosis"
    ))) %>%
  spread(measure, value) %>%
  # we can apply a function to all variables to edit them so that they are publication ready
  rename_all(
    .funs = ~str_to_title(.)
  ) %>%
  # or we can individually rename variables
  rename(
    SD = Sd
  )

pcl.sum_score_numeric_summary_table_reshaped
```

Table for knitting
pcl diff summary table
```{r pcl diff summary table}
kable(pcl.sum_score_numeric_summary_table_reshaped)
```

```{r pcl gather to long format Time_points pcl.sum_score}
dat.long.pcl.sum <- dat %>%
  gather(
    key = "Time_point_raw",
    value = "pcl.sum_score",
    all_of(pcl.sum_score_cols)) %>%
  select(
    ID,
    Sample,
    Gender_collapsed,
    Ethnicity_collapsed,
    Disorder_hierarchical,
    Time_point_raw,
    pcl.sum_score
  ) %>%
  mutate(Time_point = str_replace(Time_point_raw, "pcl.sum_score_", "")) %>%
  select(-Time_point_raw)

head(dat.long.pcl.sum)
```

For each item
present percentages of how say that this is due to the pandemic
```{r pcl percentages due to pandemic}
pcl.retro.items <- c(
  "pcl.stressful_experience_upset_reminded_retro_numeric",
  "pcl.stressful_experience_repeated_images_retro_numeric",
  "pcl.stressful_situation_avoiding_activities_retro_numeric",
  "pcl.cut_people_feeling_distant_retro_numeric",
  "pcl.difficulty_concentrating_retro_numeric",
  "pcl.feeling_irritable_or_having_angry_outbursts_retro_numeric"
)

pcl.percentages.summary <- dat %>%
  select(
    all_of(pcl.retro.items)
  ) %>%
  gather(
    key = "PCL Item",
    value = "Binary_score",
    all_of(pcl.retro.items)
  ) %>%
  mutate(Binary_score = fct_explicit_na(as.factor(Binary_score), na_level = "Missing")) %>%
  group_by(`PCL Item`) %>%
  count(`PCL Item`, Binary_score) %>%
  mutate(prop = round(n/sum(n), 3)*100) %>%
  mutate(n_prop = paste0(n," (",prop, "%)"))

kable(pcl.percentages.summary)
pcl.percentages.summary
```


### Plots sum

```{r pcl percentage plot retro_prepan sum}
dat.long.pcl.sum %>%
  ggplot(mapping = aes(
    x = pcl.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "PCL scores",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
  )
```

```{r pcl percentage plot retro_prepan sum resized, fig.height=6, fig.width=10}
dat.long.pcl.sum %>%
  ggplot(mapping = aes(
    x = pcl.sum_score,
    y = stat(density*width),
    fill = Time_point)) +
  geom_histogram(
    binwidth = 1,
    position = position_dodge2(preserve = "single")
  ) +
  labs(
    x = "PCL score",
    y = "Percentage of participants",
    fill = "Time point") +
  theme_personal +
  scale_fill_manual(
    values = COPINGpalette3,
    breaks = c("prepan", "retro", "base"),
    labels = c("base" = "Baseline", "prepan" = "Prepandemic", "retro" = "Retrospective")
  ) +
  facet_wrap("Disorder_hierarchical")
```



# Create subsets of data for analyses
Filter data frame to create 2 additional datasets. Additional exclusion criteria (beyond those listed above) are specified below:

  1. Retrospective - baseline change anlyses
        i. Exclude individuals missing retrospective and/or baseline data
  2. Prepandemic - baseline change analyses
          i. Exclude individuals missing pandemic and/or baseline data
          ii. Exclude individuals with prepandemic data collected after 1st March.

Retro-baseline analyses


```{r subsample for retro-baseline analysis}
dat.retro <- dat %>%
  filter(
    ((data_group_gad == "Baseline and retrospective data" |
      data_group_gad == "All prepandemic, baseline and retrospective data") |
      (data_group_phq == "Baseline and retrospective data" |
      data_group_phq == "All prepandemic, baseline and retrospective data") |
      (data_group_pcl == "Baseline and retrospective data" |
      data_group_pcl == "All prepandemic, baseline and retrospective data") |
      (data_group_ocir == "Baseline and retrospective data" |
      data_group_ocir == "All prepandemic, baseline and retrospective data"))
  )

dim(dat.retro)
```

Prepan-baseline analyses
Exclude individuals with NA for MHD, age, gender; exclude if prepan data collected after 1 March

```{r subsample for prepan-baseline analysis}
dat.prepan <- dat %>%
  filter(
    ((data_group_gad == "Baseline and retrospective data" |
      data_group_gad == "Prepandemic and baseline data" |
      data_group_gad == "All prepandemic, baseline and retrospective data") |
      (data_group_phq == "Baseline and retrospective data" |
      data_group_phq == "Prepandemic and baseline data" |
      data_group_phq == "All prepandemic, baseline and retrospective data") |
      (data_group_pcl == "Baseline and retrospective data" |
      data_group_pcl == "Prepandemic and baseline data" |
      data_group_pcl == "All prepandemic, baseline and retrospective data") |
      (data_group_ocir == "Baseline and retrospective data" |
      data_group_ocir == "Prepandemic and baseline data" |
      data_group_ocir == "All prepandemic, baseline and retrospective data")) &
      prepandemic_march_1_numeric == 1 # Exclude participants that signed up after the 1. March
  )

dim(dat.prepan)
```

Prepan-baseline analyses
Exclude individuals with NA for MHD, age, gender; exclude if prepan data collected after 1 March (to ensure comparability with prepan analyses)

```{r subsample for retro sensitivity analysis}
dat.retro_sensitivity <- dat %>%
  filter(
    ((data_group_gad == "All prepandemic, baseline and retrospective data") |
      (data_group_phq == "All prepandemic, baseline and retrospective data") |
      (data_group_pcl == "All prepandemic, baseline and retrospective data") |
      (data_group_ocir == "All prepandemic, baseline and retrospective data")) &
      prepandemic_march_1_numeric == 1 # Exclude participants that signed up after the 1. March
  )

dim(dat.retro_sensitivity)
```
age^2 sensitivity 
Exclude individuals with NA for continuous Age variable
```{r}
dat_age_sensitivity <- dat %>%
  filter(!is.na(Age))
dim(dat_age_sensitivity)

dat.retro_age_sensitivity <- dat.retro %>%
  filter(!is.na(Age))
dim(dat.retro_age_sensitivity)

dat.prepan_age_sensitivity <- dat.prepan %>%
  filter(!is.na(Age))
dim(dat.prepan_age_sensitivity)
```

Sensitivity analysis for individuals who signed up to GLAD (prepan) either 3, 6 or 9 months before the pendemic began. 
```{r subsample for pre-pan sensitivity analysis}
# Participants who signed up in the three months before the pandemic began
dat.prepan_sensitivity_3months <- dat %>%
  filter(
    ((data_group_gad == "Baseline and retrospective data" |
      data_group_gad == "Prepandemic and baseline data" |
      data_group_gad == "All prepandemic, baseline and retrospective data") |
      (data_group_phq == "Baseline and retrospective data" |
      data_group_phq == "Prepandemic and baseline data" |
      data_group_phq == "All prepandemic, baseline and retrospective data") |
      (data_group_pcl == "Baseline and retrospective data" |
      data_group_pcl == "Prepandemic and baseline data" |
      data_group_pcl == "All prepandemic, baseline and retrospective data") |
      (data_group_ocir == "Baseline and retrospective data" |
      data_group_ocir == "Prepandemic and baseline data" |
      data_group_ocir == "All prepandemic, baseline and retrospective data")) &
      prepandemic_3_months_numeric == 1 # Only participants who signed up between December 1st 2019 and March 1st 2020
  )

# Participants who signed up in the three months before the pandemic began
dat.prepan_sensitivity_6months <- dat %>%
  filter(
    ((data_group_gad == "Baseline and retrospective data" |
      data_group_gad == "Prepandemic and baseline data" |
      data_group_gad == "All prepandemic, baseline and retrospective data") |
      (data_group_phq == "Baseline and retrospective data" |
      data_group_phq == "Prepandemic and baseline data" |
      data_group_phq == "All prepandemic, baseline and retrospective data") |
      (data_group_pcl == "Baseline and retrospective data" |
      data_group_pcl == "Prepandemic and baseline data" |
      data_group_pcl == "All prepandemic, baseline and retrospective data") |
      (data_group_ocir == "Baseline and retrospective data" |
      data_group_ocir == "Prepandemic and baseline data" |
      data_group_ocir == "All prepandemic, baseline and retrospective data")) &
      prepandemic_6_months_numeric == 1 # Only participants who signed up between September 1st 2019 and March 1st 2020
  )

# Participants who signed up in the three months before the pandemic began
dat.prepan_sensitivity_9months <- dat %>%
  filter(
    ((data_group_gad == "Baseline and retrospective data" |
      data_group_gad == "Prepandemic and baseline data" |
      data_group_gad == "All prepandemic, baseline and retrospective data") |
      (data_group_phq == "Baseline and retrospective data" |
      data_group_phq == "Prepandemic and baseline data" |
      data_group_phq == "All prepandemic, baseline and retrospective data") |
      (data_group_pcl == "Baseline and retrospective data" |
      data_group_pcl == "Prepandemic and baseline data" |
      data_group_pcl == "All prepandemic, baseline and retrospective data") |
      (data_group_ocir == "Baseline and retrospective data" |
      data_group_ocir == "Prepandemic and baseline data" |
      data_group_ocir == "All prepandemic, baseline and retrospective data")) &
      prepandemic_9_months_numeric == 1 # Only participants who signed up between June 1st 2019 and March 1st 2020
  )

```

2. Regression models (Regress covariates out of the change? Which?)
    i. Model 0: Disorders
    ii. Model 1: Model 0 + Sex + Age + Ethnicity + Time registration and baseline

3. Re-calculate change

4. Re-rank the change again

5. PCL:
    i. Calculate the total GLAD, COPING, RAMP baseline
    ii. For each item:
          a. present percentages of how say that this is due to the pandemic
          b. Calculate a variable PCL pandemic score
          c. If one item is highly endorsed due to pandemic -> exclude in sensitivity analysis



# 2. Regression
Regress covariates out of the change? Which?

Model naming conventions:
0 - unadjusted
1 - adjusted
2 - adjusted with age^2
a - hierarchical disorders
b - overlapping disorder categories

++MD: We may want to exclude disorders from Model b that aren't including in the hierarchy (e.g. ADHD, ASD)

# Functions

```{r model0a function}
model0a.estimates <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model0a"),
         lm( formula = glm.formula,
              data = get(data_set)
              )
  )

  assign(paste0(outcome,"model0a_estimates"),
         tidy(get(paste0(outcome,".model0a")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "Disorder_hierarchicalAnxiety disorders" = "Anxiety disorders",
               "Disorder_hierarchicalEating disorders" = "Eating disorders",
               "Disorder_hierarchicalOCDs" = "OCDs",
               "Disorder_hierarchicalPTSD" = "PTSD",
               "Disorder_hierarchicalDepressive disorders" = "Depressive disorders",
               "Disorder_hierarchicalBipolar disorders" = "Bipolar disorders"
             ),
    "Estimate" = format(
      round(estimate,
            digits = 2),
      nsmall = 2),
    "95% CI low" = format(
      round(conf.low,
            digits = 2),
      nsmall = 2),
    "95% CI up" = format(
      round(conf.high,
            digits = 2),
      nsmall = 2),
    "SE" = format(
      round(std.error,
            digits = 2),
      nsmall = 2),
    "z score" = format(
      round(statistic,
            digits = 2),
      nsmall = 2),
    "p value" = case_when(
      p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
      p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
      p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
  )
  ) %>%
  select(
    "Indepent variable",
    "Estimate",
    "95% CI low",
    "95% CI up",
    "SE",
#    "z score",
    "p value"
  )
  )

  return(get(paste0(outcome,"model0a_estimates")))
}

model0a.reg.stats <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model0a"),
         lm( formula = glm.formula,
              data = get(data_set)
              )
  )

  assign(paste0(outcome,"model0a_reg_stats"),
         glance(get(paste0(outcome,".model0a"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,"model0a_reg_stats")))
}
```


```{r model0b function}
model0b.estimates <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("depression_and_anxiety",
                             "eating_disorders",
                             "obsessive_compulsive_disorders",
                             "bipolar_and_schizophrenia",
                             "mhd.posttraumatic_stress_disorder_ptsd",
                             "autism_spectrum_disorder",
                             "mhd.attention_deficit_hyperactivity_disorder",
                             "mhd.personality_disorder"
                                )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model0b"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model0b_estimates"),
         tidy(get(paste0(outcome,".model0b")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "anxiety_disordersAnxiety disorder" = "Anxiety disorders",
               "depressive_disordersDepressive disorder" = "Depressive disorders",
               "depression_and_anxietyDepressive and anxiety disorder" = "Depressive and anxiety disorder",
               "depression_and_anxietyOnly depressive disorder" = "Only depressive disorder",
               "depression_and_anxietyOnly anxiety disorder" = "Only anxiety disorder",
               "eating_disordersEating disorder" = "Eating disorders",
               "obsessive_compulsive_disordersObsessive compulsive disorder" = "OCDs",
               "bipolar_and_schizophreniaPsychotic and bipolar disorder" = "Psychotic and bipolar disorder",
               "bipolar_and_schizophreniaOnly psychotic disorder" = "Only psychotic disorder",
               "bipolar_and_schizophreniaOnly bipolar disorder" = "Only bipolar disorder",
               "psychotic_disordersPsychotic disorder" = "Psychotic disorder",
               "mhd.mania_hypomania_bipolar_or_manicdepressionMania, hypomania, bipolar or manic-depression" = "Bipolar disorder",
               "mhd.posttraumatic_stress_disorder_ptsdPost-traumatic stress disorder (PTSD)" = "PTSD",
               "autism_spectrum_disorderAutism spectrum disorder" = "ASD",
               "mhd.attention_deficit_hyperactivity_disorderAttention deficit or attention deficit and hyperactivity disorder (ADD/ADHD)" = "ADHD",
               "mhd.personality_disorderPersonality disorder" = "Personality disorder"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,"model0b_estimates")))
}

model0b.reg.stats <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model0b"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model0b_reg_stats"),
         glance(get(paste0(outcome,".model0b"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,"model0b_reg_stats")))
}
```

```{r model1a function}
model1a.estimates <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical",
                            "Gender_collapsed",
                            "age_category_collapsed_reordered",
                            "Ethnicity_collapsed",
                            "time_diff_coping_lockdown_march_23"
                            )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model1a"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model1a_estimates"),
         tidy(get(paste0(outcome,".model1a")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "Disorder_hierarchicalAnxiety disorders" = "Anxiety disorders",
               "Disorder_hierarchicalEating disorders" = "Eating disorders",
               "Disorder_hierarchicalOCDs" = "OCDs",
               "Disorder_hierarchicalPTSD" = "PTSD",
               "Disorder_hierarchicalDepressive disorders" = "Depressive disorders",
               "Disorder_hierarchicalBipolar disorders" = "Bipolar disorders",
               "Gender_collapsedFemale" = "Female",
               "Gender_collapsedNon-binary/Self-defined" = "Non-binary/Self-defined",
               "age_category_collapsed_reordered19-25" = "19-25 years",
               "age_category_collapsed_reordered26-35" = "26-35 years",
               "age_category_collapsed_reordered36-45" = "36-45 years",
               "age_category_collapsed_reordered46-55" = "46-55 years",
               "age_category_collapsed_reordered56-65" = "56-65 years",
               "age_category_collapsed_reordered66-70" = "66-70 years",
               "age_category_collapsed_reordered71-75" = "71-75 years",
               "age_category_collapsed_reordered76+" = "76+ years",
               "Ethnicity_collapsedMixed or multiple ethnic origins" = "Mixed or multiple ethnic origins",
               "Ethnicity_collapsedAsian or Asian British" = "Asian or Asian British",
               "Ethnicity_collapsedAfrican or African British" = "African or African British",
               "Ethnicity_collapsedOther" = "Other ethnicity",
               "time_diff_coping_lockdown_march_23" = "Time difference: Lockdown to baseline"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,"model1a_estimates")))
}

model1a.reg.stats <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model1a"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model1a_reg_stats"),
         glance(get(paste0(outcome,".model1a"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,"model1a_reg_stats")))
}
```


```{r model1b function}
model1b.estimates <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("depression_and_anxiety",
                             "eating_disorders",
                             "obsessive_compulsive_disorders",
                             "bipolar_and_schizophrenia",
                             "mhd.posttraumatic_stress_disorder_ptsd",
                             "autism_spectrum_disorder",
                             "mhd.attention_deficit_hyperactivity_disorder",
                             "mhd.personality_disorder",
                             "Gender_collapsed",
                             "age_category_collapsed_reordered",
                             "Ethnicity_collapsed",
                             "key_worker",
                             "time_diff_coping_lockdown_march_23"
                                )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model1b"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model1b_estimates"),
         tidy(get(paste0(outcome,".model1b")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "anxiety_disordersAnxiety disorder" = "Anxiety disorders",
               "depressive_disordersDepressive disorder" = "Depressive disorders",
               "depression_and_anxietyDepressive and anxiety disorder" = "Depressive and anxiety disorder",
               "depression_and_anxietyOnly depressive disorder" = "Only depressive disorder",
               "depression_and_anxietyOnly anxiety disorder" = "Only anxiety disorder",
               "eating_disordersEating disorder" = "Eating disorders",
               "obsessive_compulsive_disordersObsessive compulsive disorder" = "OCDs",
               "bipolar_and_schizophreniaPsychotic and bipolar disorder" = "Psychotic and bipolar disorder",
               "bipolar_and_schizophreniaOnly psychotic disorder" = "Only psychotic disorder",
               "bipolar_and_schizophreniaOnly bipolar disorder" = "Only bipolar disorder",
               "psychotic_disordersPsychotic disorder" = "Psychotic disorder",
               "mhd.mania_hypomania_bipolar_or_manicdepressionMania, hypomania, bipolar or manic-depression" = "Bipolar disorder",
               "mhd.posttraumatic_stress_disorder_ptsdPost-traumatic stress disorder (PTSD)" = "PTSD",
               "autism_spectrum_disorderAutism spectrum disorder" = "ASD",
               "mhd.attention_deficit_hyperactivity_disorderAttention deficit or attention deficit and hyperactivity disorder (ADD/ADHD)" = "ADHD",
               "mhd.personality_disorderPersonality disorder" = "Personality disorder",
               "Gender_collapsedFemale" = "Female",
               "Gender_collapsedNon-binary/Self-defined" = "Non-binary/Self-defined",
               "age_category_collapsed_reordered19-25" = "19-25 years",
               "age_category_collapsed_reordered26-35" = "26-35 years",
               "age_category_collapsed_reordered36-45" = "36-45 years",
               "age_category_collapsed_reordered46-55" = "46-55 years",
               "age_category_collapsed_reordered56-65" = "56-65 years",
               "age_category_collapsed_reordered66-70" = "66-70 years",
               "age_category_collapsed_reordered71-75" = "71-75 years",
               "age_category_collapsed_reordered76+" = "76+ years",
               "Ethnicity_collapsedMixed or multiple ethnic origins" = "Mixed or multiple ethnic origins",
               "Ethnicity_collapsedAsian or Asian British" = "Asian or Asian British",
               "Ethnicity_collapsedAfrican or African British" = "African or African British",
               "Ethnicity_collapsedOther" = "Other ethnicity",
               "key_workerKey worker" = "Key worker",
               "time_diff_coping_lockdown_march_23" = "Time difference: Lockdown to baseline"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,"model1b_estimates")))
}

model1b.reg.stats <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model1b"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model1b_reg_stats"),
         glance(get(paste0(outcome,".model1b"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,"model1b_reg_stats")))
}
```

```{r model2a function}
model2a.estimates <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical",
                            "Gender_collapsed",
                            "poly(Age, 2)",
                            "Ethnicity_collapsed",
                            "time_diff_coping_lockdown_march_23"
                            )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model2a"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model2a_estimates"),
         tidy(get(paste0(outcome,".model2a")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "Disorder_hierarchicalAnxiety disorders" = "Anxiety disorders",
               "Disorder_hierarchicalEating disorders" = "Eating disorders",
               "Disorder_hierarchicalOCDs" = "OCDs",
               "Disorder_hierarchicalPTSD" = "PTSD",
               "Disorder_hierarchicalDepressive disorders" = "Depressive disorders",
               "Disorder_hierarchicalBipolar disorders" = "Bipolar disorders",
               "Gender_collapsedFemale" = "Female",
               "Gender_collapsedNon-binary/Self-defined" = "Non-binary/Self-defined",
               "poly(Age, 2)1" = "Age",
               "poly(Age, 2)2" = "Age^2", 
               "Ethnicity_collapsedMixed or multiple ethnic origins" = "Mixed or multiple ethnic origins",
               "Ethnicity_collapsedAsian or Asian British" = "Asian or Asian British",
               "Ethnicity_collapsedAfrican or African British" = "African or African British",
               "Ethnicity_collapsedOther" = "Other ethnicity",
               "time_diff_coping_lockdown_march_23" = "Time difference: Lockdown to baseline"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,"model2a_estimates")))
}

model2a.reg.stats <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model2a"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model2a_reg_stats"),
         glance(get(paste0(outcome,".model2a"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,"model2a_reg_stats")))
}
```

```{r model2b function}
model2b.estimates <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("depression_and_anxiety",
                             "eating_disorders",
                             "obsessive_compulsive_disorders",
                             "bipolar_and_schizophrenia",
                             "mhd.posttraumatic_stress_disorder_ptsd",
                             "autism_spectrum_disorder",
                             "mhd.attention_deficit_hyperactivity_disorder",
                             "mhd.personality_disorder",
                             "Gender_collapsed",
                             "poly(Age, 2)",
                             "Ethnicity_collapsed",
                             "key_worker",
                             "time_diff_coping_lockdown_march_23"
                                )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model2b"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model2b_estimates"),
         tidy(get(paste0(outcome,".model2b")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "anxiety_disordersAnxiety disorder" = "Anxiety disorders",
               "depressive_disordersDepressive disorder" = "Depressive disorders",
               "depression_and_anxietyDepressive and anxiety disorder" = "Depressive and anxiety disorder",
               "depression_and_anxietyOnly depressive disorder" = "Only depressive disorder",
               "depression_and_anxietyOnly anxiety disorder" = "Only anxiety disorder",
               "eating_disordersEating disorder" = "Eating disorders",
               "obsessive_compulsive_disordersObsessive compulsive disorder" = "OCDs",
               "bipolar_and_schizophreniaPsychotic and bipolar disorder" = "Psychotic and bipolar disorder",
               "bipolar_and_schizophreniaOnly psychotic disorder" = "Only psychotic disorder",
               "bipolar_and_schizophreniaOnly bipolar disorder" = "Only bipolar disorder",
               "psychotic_disordersPsychotic disorder" = "Psychotic disorder",
               "mhd.mania_hypomania_bipolar_or_manicdepressionMania, hypomania, bipolar or manic-depression" = "Bipolar disorder",
               "mhd.posttraumatic_stress_disorder_ptsdPost-traumatic stress disorder (PTSD)" = "PTSD",
               "autism_spectrum_disorderAutism spectrum disorder" = "ASD",
               "mhd.attention_deficit_hyperactivity_disorderAttention deficit or attention deficit and hyperactivity disorder (ADD/ADHD)" = "ADHD",
               "mhd.personality_disorderPersonality disorder" = "Personality disorder",
               "Gender_collapsedFemale" = "Female",
               "Gender_collapsedNon-binary/Self-defined" = "Non-binary/Self-defined",
               "poly(Age, 2)1" = "Age",
               "poly(Age, 2)2" = "Age^2", 
               "Ethnicity_collapsedMixed or multiple ethnic origins" = "Mixed or multiple ethnic origins",
               "Ethnicity_collapsedAsian or Asian British" = "Asian or Asian British",
               "Ethnicity_collapsedAfrican or African British" = "African or African British",
               "Ethnicity_collapsedOther" = "Other ethnicity",
               "key_workerKey worker" = "Key worker",
               "time_diff_coping_lockdown_march_23" = "Time difference: Lockdown to baseline"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,"model2b_estimates")))
}

model2b.reg.stats <- function(outcome, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".model2b"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,"model2b_reg_stats"),
         glance(get(paste0(outcome,".model2b"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,"model2b_reg_stats")))
}
```


```{r model0a.explan function}
model0a.explan.estimates <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c(explan_var, "Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model0a.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model0a.explan_estimates"),
         tidy(get(paste0(outcome,".",explan_var,".model0a.explan")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "Disorder_hierarchicalAnxiety disorders" = "Anxiety disorders",
               "Disorder_hierarchicalEating disorders" = "Eating disorders",
               "Disorder_hierarchicalOCDs" = "OCDs",
               "Disorder_hierarchicalPTSD" = "PTSD",
               "Disorder_hierarchicalDepressive disorders" = "Depressive disorders",
               "Disorder_hierarchicalBipolar disorders" = "Bipolar disorders"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model0a.explan_estimates")))
}

model0a.explan.reg.stats <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c(explan_var, "Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model0a.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model0a.explan_reg_stats"),
         glance(get(paste0(outcome,".",explan_var,".model0a.explan"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model0a.explan_reg_stats")))
}
```


```{r model0b.explan function}
model0b.explan.estimates <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c(explan_var,
                             "depression_and_anxiety",
                             "eating_disorders",
                             "obsessive_compulsive_disorders",
                             "bipolar_and_schizophrenia",
                             "mhd.posttraumatic_stress_disorder_ptsd",
                             "autism_spectrum_disorder",
                             "mhd.attention_deficit_hyperactivity_disorder",
                             "mhd.personality_disorder"
  )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model0b.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model0b.explan_estimates"),
         tidy(get(paste0(outcome,".",explan_var,".model0b.explan")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "anxiety_disordersAnxiety disorder" = "Anxiety disorders",
               "depressive_disordersDepressive disorder" = "Depressive disorders",
               "depression_and_anxietyDepressive and anxiety disorder" = "Depressive and anxiety disorder",
               "depression_and_anxietyOnly depressive disorder" = "Only depressive disorder",
               "depression_and_anxietyOnly anxiety disorder" = "Only anxiety disorder",
               "eating_disordersEating disorder" = "Eating disorders",
               "obsessive_compulsive_disordersObsessive compulsive disorder" = "OCDs",
               "bipolar_and_schizophreniaPsychotic and bipolar disorder" = "Psychotic and bipolar disorder",
               "bipolar_and_schizophreniaOnly psychotic disorder" = "Only psychotic disorder",
               "bipolar_and_schizophreniaOnly bipolar disorder" = "Only bipolar disorder",
               "psychotic_disordersPsychotic disorder" = "Psychotic disorder",
               "mhd.mania_hypomania_bipolar_or_manicdepressionMania, hypomania, bipolar or manic-depression" = "Bipolar disorder",
               "mhd.posttraumatic_stress_disorder_ptsdPost-traumatic stress disorder (PTSD)" = "PTSD",
               "autism_spectrum_disorderAutism spectrum disorder" = "ASD",
               "mhd.attention_deficit_hyperactivity_disorderAttention deficit or attention deficit and hyperactivity disorder (ADD/ADHD)" = "ADHD",
               "mhd.personality_disorderPersonality disorder" = "Personality disorder"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model0b.explan_estimates")))
}

model0b.explan.reg.stats <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model0b.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model0b.explan_reg_stats"),
         glance(get(paste0(outcome,".",explan_var,".model0b.explan"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model0b.explan_reg_stats")))
}
```



```{r model1a.explan function}
model1a.explan.estimates <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c(explan_var,
                             "Disorder_hierarchical",
                             "Gender_collapsed",
                             "age_category_collapsed_reordered",
                             "Ethnicity_collapsed",
                             "key_worker",
                             "time_diff_coping_lockdown_march_23"
  )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model1a.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model1a.explan_estimates"),
         tidy(get(paste0(outcome,".",explan_var,".model1a.explan")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "Disorder_hierarchicalAnxiety disorders" = "Anxiety disorders",
               "Disorder_hierarchicalEating disorders" = "Eating disorders",
               "Disorder_hierarchicalOCDs" = "OCDs",
               "Disorder_hierarchicalPTSD" = "PTSD",
               "Disorder_hierarchicalDepressive disorders" = "Depressive disorders",
               "Disorder_hierarchicalBipolar disorders" = "Bipolar disorders",
               "Gender_collapsedFemale" = "Female",
               "Gender_collapsedNon-binary/Self-defined" = "Non-binary/Self-defined",
               "age_category_collapsed_reordered19-25" = "19-25 years",
               "age_category_collapsed_reordered26-35" = "26-35 years",
               "age_category_collapsed_reordered36-45" = "36-45 years",
               "age_category_collapsed_reordered46-55" = "46-55 years",
               "age_category_collapsed_reordered56-65" = "56-65 years",
               "age_category_collapsed_reordered66-70" = "66-70 years",
               "age_category_collapsed_reordered71-75" = "71-75 years",
               "age_category_collapsed_reordered76+" = "76+ years",
               "Ethnicity_collapsedMixed or multiple ethnic origins" = "Mixed or multiple ethnic origins",
               "Ethnicity_collapsedAsian or Asian British" = "Asian or Asian British",
               "Ethnicity_collapsedAfrican or African British" = "African or African British",
               "Ethnicity_collapsedOther" = "Other ethnicity",
               "key_workerKey worker" = "Key worker",
               "time_diff_coping_lockdown_march_23" = "Time difference: Lockdown to baseline"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model1a.explan_estimates")))
}

model1a.explan.reg.stats <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model1a.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model1a.explan_reg_stats"),
         glance(get(paste0(outcome,".",explan_var,".model1a.explan"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model1a.explan_reg_stats")))
}
```


```{r model1b.explan function}
model1b.explan.estimates <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c(explan_var,
                             "depression_and_anxiety",
                             "eating_disorders",
                             "obsessive_compulsive_disorders",
                             "bipolar_and_schizophrenia",
                             "mhd.posttraumatic_stress_disorder_ptsd",
                             "autism_spectrum_disorder",
                             "mhd.attention_deficit_hyperactivity_disorder",
                             "mhd.personality_disorder",
                             "Gender_collapsed",
                             "age_category_collapsed_reordered",
                             "Ethnicity_collapsed",
                             "key_worker",
                             "time_diff_coping_lockdown_march_23"
  )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model1b.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model1b.explan_estimates"),
         tidy(get(paste0(outcome,".",explan_var,".model1b.explan")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "anxiety_disordersAnxiety disorder" = "Anxiety disorders",
               "depressive_disordersDepressive disorder" = "Depressive disorders",
               "depression_and_anxietyDepressive and anxiety disorder" = "Depressive and anxiety disorder",
               "depression_and_anxietyOnly depressive disorder" = "Only depressive disorder",
               "depression_and_anxietyOnly anxiety disorder" = "Only anxiety disorder",
               "eating_disordersEating disorder" = "Eating disorders",
               "obsessive_compulsive_disordersObsessive compulsive disorder" = "OCDs",
               "bipolar_and_schizophreniaPsychotic and bipolar disorder" = "Psychotic and bipolar disorder",
               "bipolar_and_schizophreniaOnly psychotic disorder" = "Only psychotic disorder",
               "bipolar_and_schizophreniaOnly bipolar disorder" = "Only bipolar disorder",
               "psychotic_disordersPsychotic disorder" = "Psychotic disorder",
               "mhd.mania_hypomania_bipolar_or_manicdepressionMania, hypomania, bipolar or manic-depression" = "Bipolar disorder",
               "mhd.posttraumatic_stress_disorder_ptsdPost-traumatic stress disorder (PTSD)" = "PTSD",
               "autism_spectrum_disorderAutism spectrum disorder" = "ASD",
               "mhd.attention_deficit_hyperactivity_disorderAttention deficit or attention deficit and hyperactivity disorder (ADD/ADHD)" = "ADHD",
               "mhd.personality_disorderPersonality disorder" = "Personality disorder",
               "Gender_collapsedFemale" = "Female",
               "Gender_collapsedNon-binary/Self-defined" = "Non-binary/Self-defined",
               "age_category_collapsed_reordered19-25" = "19-25 years",
               "age_category_collapsed_reordered26-35" = "26-35 years",
               "age_category_collapsed_reordered36-45" = "36-45 years",
               "age_category_collapsed_reordered46-55" = "46-55 years",
               "age_category_collapsed_reordered56-65" = "56-65 years",
               "age_category_collapsed_reordered66-70" = "66-70 years",
               "age_category_collapsed_reordered71-75" = "71-75 years",
               "age_category_collapsed_reordered76+" = "76+ years",
               "Ethnicity_collapsedMixed or multiple ethnic origins" = "Mixed or multiple ethnic origins",
               "Ethnicity_collapsedAsian or Asian British" = "Asian or Asian British",
               "Ethnicity_collapsedAfrican or African British" = "African or African British",
               "Ethnicity_collapsedOther" = "Other ethnicity",
               "key_workerKey worker" = "Key worker",
               "time_diff_coping_lockdown_march_23" = "Time difference: Lockdown to baseline"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model1b.explan_estimates")))
}

model1b.explan.reg.stats <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model1b.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model1b.explan_reg_stats"),
         glance(get(paste0(outcome,".",explan_var,".model1b.explan"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model1b.explan_reg_stats")))
}
```


```{r model2a.explan function}
model2a.explan.estimates <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c(explan_var,
                             "Disorder_hierarchical",
                             "Gender_collapsed",
                             "poly(Age, 2)",
                             "Ethnicity_collapsed",
                             "key_worker",
                             "time_diff_coping_lockdown_march_23"
  )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model2a.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model2a.explan_estimates"),
         tidy(get(paste0(outcome,".",explan_var,".model2a.explan")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "Disorder_hierarchicalAnxiety disorders" = "Anxiety disorders",
               "Disorder_hierarchicalEating disorders" = "Eating disorders",
               "Disorder_hierarchicalOCDs" = "OCDs",
               "Disorder_hierarchicalPTSD" = "PTSD",
               "Disorder_hierarchicalDepressive disorders" = "Depressive disorders",
               "Disorder_hierarchicalBipolar disorders" = "Bipolar disorders",
               "Gender_collapsedFemale" = "Female",
               "Gender_collapsedNon-binary/Self-defined" = "Non-binary/Self-defined",
               "poly(Age, 2)1" = "Age",
               "poly(Age, 2)2" = "Age^2", 
               "Ethnicity_collapsedMixed or multiple ethnic origins" = "Mixed or multiple ethnic origins",
               "Ethnicity_collapsedAsian or Asian British" = "Asian or Asian British",
               "Ethnicity_collapsedAfrican or African British" = "African or African British",
               "Ethnicity_collapsedOther" = "Other ethnicity",
               "key_workerKey worker" = "Key worker",
               "time_diff_coping_lockdown_march_23" = "Time difference: Lockdown to baseline"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model2a.explan_estimates")))
}

model2a.explan.reg.stats <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model2a.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model2a.explan_reg_stats"),
         glance(get(paste0(outcome,".",explan_var,".model2a.explan"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model2a.explan_reg_stats")))
}
```


```{r model2b.explan function}
model2b.explan.estimates <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c(explan_var,
                             "depression_and_anxiety",
                             "eating_disorders",
                             "obsessive_compulsive_disorders",
                             "bipolar_and_schizophrenia",
                             "mhd.posttraumatic_stress_disorder_ptsd",
                             "autism_spectrum_disorder",
                             "mhd.attention_deficit_hyperactivity_disorder",
                             "mhd.personality_disorder",
                             "Gender_collapsed",
                             "poly(Age, 2)",
                             "Ethnicity_collapsed",
                             "key_worker",
                             "time_diff_coping_lockdown_march_23"
  )
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model2b.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model2b.explan_estimates"),
         tidy(get(paste0(outcome,".",explan_var,".model2b.explan")), conf.int = TRUE) %>%
           mutate(
             "Indepent variable" = recode_factor(
               term,
               "(Intercept)" = "Intercept",
               "anxiety_disordersAnxiety disorder" = "Anxiety disorders",
               "depressive_disordersDepressive disorder" = "Depressive disorders",
               "depression_and_anxietyDepressive and anxiety disorder" = "Depressive and anxiety disorder",
               "depression_and_anxietyOnly depressive disorder" = "Only depressive disorder",
               "depression_and_anxietyOnly anxiety disorder" = "Only anxiety disorder",
               "eating_disordersEating disorder" = "Eating disorders",
               "obsessive_compulsive_disordersObsessive compulsive disorder" = "OCDs",
               "bipolar_and_schizophreniaPsychotic and bipolar disorder" = "Psychotic and bipolar disorder",
               "bipolar_and_schizophreniaOnly psychotic disorder" = "Only psychotic disorder",
               "bipolar_and_schizophreniaOnly bipolar disorder" = "Only bipolar disorder",
               "psychotic_disordersPsychotic disorder" = "Psychotic disorder",
               "mhd.mania_hypomania_bipolar_or_manicdepressionMania, hypomania, bipolar or manic-depression" = "Bipolar disorder",
               "mhd.posttraumatic_stress_disorder_ptsdPost-traumatic stress disorder (PTSD)" = "PTSD",
               "autism_spectrum_disorderAutism spectrum disorder" = "ASD",
               "mhd.attention_deficit_hyperactivity_disorderAttention deficit or attention deficit and hyperactivity disorder (ADD/ADHD)" = "ADHD",
               "mhd.personality_disorderPersonality disorder" = "Personality disorder",
               "Gender_collapsedFemale" = "Female",
               "Gender_collapsedNon-binary/Self-defined" = "Non-binary/Self-defined",
               "poly(Age, 2)1" = "Age",
               "poly(Age, 2)2" = "Age^2", 
               "Ethnicity_collapsedMixed or multiple ethnic origins" = "Mixed or multiple ethnic origins",
               "Ethnicity_collapsedAsian or Asian British" = "Asian or Asian British",
               "Ethnicity_collapsedAfrican or African British" = "African or African British",
               "Ethnicity_collapsedOther" = "Other ethnicity",
               "key_workerKey worker" = "Key worker",
               "time_diff_coping_lockdown_march_23" = "Time difference: Lockdown to baseline"
             ),
             "Estimate" = format(
               round(estimate,
                     digits = 2),
               nsmall = 2),
             "95% CI low" = format(
               round(conf.low,
                     digits = 2),
               nsmall = 2),
             "95% CI up" = format(
               round(conf.high,
                     digits = 2),
               nsmall = 2),
             "SE" = format(
               round(std.error,
                     digits = 2),
               nsmall = 2),
             "z score" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "Indepent variable",
             "Estimate",
             "95% CI low",
             "95% CI up",
             "SE",
             #    "z score",
             "p value"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model2b.explan_estimates")))
}

model2b.explan.reg.stats <- function(outcome, explan_var, data_set) {
  # define the variable name of the dependent variable
  dependent.variable <- outcome
  # define the independent variables
  independent.variables <- c("Disorder_hierarchical")
  # create the formula
  glm.formula <- as.formula(paste(dependent.variable, paste(independent.variables, collapse=" + "), sep=" ~ "))
  glm.formula

  # run the glm
  assign(paste0(outcome,".",explan_var,".model2b.explan"),
         lm( formula = glm.formula,
             data = get(data_set)
         )
  )

  assign(paste0(outcome,".",explan_var,"model2b.explan_reg_stats"),
         glance(get(paste0(outcome,".",explan_var,".model2b.explan"))) %>%
           mutate(
             "n" = format(
               round(nobs,
                     digits = 0),
               nsmall = 0),
             "R2" = format(
               round(r.squared,
                     digits = 2),
               nsmall = 2),
             "adjust. R2" = format(
               round(adj.r.squared,
                     digits = 2),
               nsmall = 2),
             "F" = format(
               round(statistic,
                     digits = 2),
               nsmall = 2),
             "p value" = case_when(
               p.value < 0.001 ~ formatC(p.value, format = "e", digits = 2),
               p.value >= 0.001 & p.value < 0.01 ~ formatC(p.value, format = "f", digits = 3),
               p.value >= 0.01 ~ formatC(p.value, format = "f", digits = 2)
             )
           ) %>%
           select(
             "n",
             "R2",
             "adjust. R2",
             "F",
             "p value",
             "df"
           )
  )

  return(get(paste0(outcome,".",explan_var,"model2b.explan_reg_stats")))
}
```

# GAD baseline, not controlling for prior symptoms
### Model 0a: Disorder_hierarchical, Unadjusted

#SB Hashing out this chunk of code as it is not included in our final analysis and is currently breaking the code.
```{r gad model0a absolute whole sample}
# Regression coefficients
gad_baseline_model0a_estimates <- model0a.estimates(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
#kable(gad_baseline_model0a_estimates)
gad_baseline_model0a_estimates

# Regression diagnostic statistics
gad_baseline_model0a_reg_stats <- model0a.reg.stats(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
#kable(gad_baseline_model0a_reg_stats)
gad_baseline_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r gad model0b absolute whole sample}
# Regression coefficients
gad_baseline_model0b_estimates <- model0b.estimates(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model0b_estimates)
gad_baseline_model0b_estimates

# Regression diagnostic statistics
gad_baseline_model0b_reg_stats <- model0b.reg.stats(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model0b_reg_stats)
gad_baseline_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1a absolute whole sample}
# Regression coefficients
gad_baseline_model1a_estimates <- model1a.estimates(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model1a_estimates)
gad_baseline_model1a_estimates

# Regression diagnostic statistics
gad_baseline_model1a_reg_stats <- model1a.reg.stats(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model1a_reg_stats)
gad_baseline_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1b absolute whole sample}
# Regression coefficients
gad_baseline_model1b_estimates <- model1b.estimates(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model1b_estimates)
gad_baseline_model1b_estimates

# Regression diagnostic statistics
gad_baseline_model1b_reg_stats <- model1b.reg.stats(outcome = "gad.sum_score_base",
                                                 data_set = "dat")
kable(gad_baseline_model1b_reg_stats)
gad_baseline_model1b_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with Age^2 
```{r}
# Regression coefficients
gad_baseline_model2a_estimates <- model2a.estimates(outcome = "gad.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(gad_baseline_model2a_estimates)
gad_baseline_model2a_estimates

# Regression diagnostic statistics
gad_baseline_model2a_reg_stats <- model2a.reg.stats(outcome = "gad.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(gad_baseline_model2a_reg_stats)
gad_baseline_model2a_reg_stats
```
### Model 2b: Disorder hierarchical, Adjusted with Age^2 
```{r}
# Regression coefficients
gad_baseline_model2b_estimates <- model2b.estimates(outcome = "gad.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(gad_baseline_model2b_estimates)
gad_baseline_model2b_estimates

# Regression diagnostic statistics
gad_baseline_model2b_reg_stats <- model2b.reg.stats(outcome = "gad.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(gad_baseline_model2b_reg_stats)
gad_baseline_model2b_reg_stats
```

# GAD prepan
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r gad model0a diff_score prepan}
# Regression coefficients
gad_prepan_model0a_estimates <- model0a.estimates(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model0a_estimates)
gad_prepan_model0a_estimates

# Regression diagnostic statistics
gad_prepan_model0a_reg_stats <- model0a.reg.stats(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model0a_reg_stats)
gad_prepan_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r gad model0b diff_score prepan}
# Regression coefficients
gad_prepan_model0b_estimates <- model0b.estimates(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model0b_estimates)
gad_prepan_model0b_estimates

# Regression diagnostic statistics
gad_prepan_model0b_reg_stats <- model0b.reg.stats(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model0b_reg_stats)
gad_prepan_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1a diff_score prepan}
# Regression coefficients
gad_prepan_model1a_estimates <- model1a.estimates(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model1a_estimates)
gad_prepan_model1a_estimates

# Regression diagnostic statistics
gad_prepan_model1a_reg_stats <- model1a.reg.stats(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model1a_reg_stats)
gad_prepan_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1b diff_score prepan}
# Regression coefficients
gad_prepan_model1b_estimates <- model1b.estimates(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model1b_estimates)
gad_prepan_model1b_estimates

# Regression diagnostic statistics
gad_prepan_model1b_reg_stats <- model1b.reg.stats(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(gad_prepan_model1b_reg_stats)
gad_prepan_model1b_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with Age^2 
Model 0a + Gender_collapsed + age^2+ Ethnicity_collapsed + Time registration and baseline
```{r gad model2a diff_score prepan}
# Regression coefficients
gad_prepan_model2a_estimates <- model2a.estimates(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(gad_prepan_model2a_estimates)
gad_prepan_model2a_estimates

# Regression diagnostic statistics
gad_prepan_model2a_reg_stats <- model2a.reg.stats(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(gad_prepan_model2a_reg_stats)
gad_prepan_model2a_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with Age^2 
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r gad model2b diff_score prepan}
# Regression coefficients
gad_prepan_model2b_estimates <- model2b.estimates(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(gad_prepan_model2b_estimates)
gad_prepan_model2b_estimates

# Regression diagnostic statistics
gad_prepan_model2b_reg_stats <- model2b.reg.stats(outcome = "gad.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(gad_prepan_model2b_reg_stats)
gad_prepan_model2b_reg_stats
```
## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r gad model0a sum_score prepan}
# Regression coefficients
gad_prepan_model0a_explan_estimates <- model0a.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model0a_explan_estimates)
gad_prepan_model0a_explan_estimates

# Regression diagnostic statistics
gad_prepan_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model0a_explan_reg_stats)
gad_prepan_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r gad model0b sum_score prepan}
# Regression coefficients
gad_prepan_model0b_explan_estimates <- model0b.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model0b_explan_estimates)
gad_prepan_model0b_explan_estimates

# Regression diagnostic statistics
gad_prepan_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model0b_explan_reg_stats)
gad_prepan_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1a sum_score prepan}
# Regression coefficients
gad_prepan_model1a_explan_estimates <- model1a.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model1a_explan_estimates)
gad_prepan_model1a_explan_estimates

# Regression diagnostic statistics
gad_prepan_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model1a_explan_reg_stats)
gad_prepan_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted 
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1b sum_score prepan}
# Regression coefficients
gad_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model1b_explan_estimates)
gad_prepan_model1b_explan_estimates

# Regression diagnostic statistics
gad_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan")
kable(gad_prepan_model1b_explan_reg_stats)
gad_prepan_model1b_explan_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r gad model2a sum_score prepan}
# Regression coefficients
gad_prepan_model2a_explan_estimates <- model2a.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(gad_prepan_model2a_explan_estimates)
gad_prepan_model2a_explan_estimates

# Regression diagnostic statistics
gad_prepan_model2a_explan_reg_stats <- model2a.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(gad_prepan_model2a_explan_reg_stats)
gad_prepan_model2a_explan_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r gad model2b sum_score prepan}
# Regression coefficients
gad_prepan_model2b_explan_estimates <- model2b.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(gad_prepan_model2b_explan_estimates)
gad_prepan_model2b_explan_estimates

# Regression diagnostic statistics
gad_prepan_model2b_explan_reg_stats <- model2b.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(gad_prepan_model2b_explan_reg_stats)
gad_prepan_model2b_explan_reg_stats
```
# GAD prepan: sensitivity
## Regression: Absolute scores
### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
#### Subset of participants 3 months prior to pandemic
```{r gad model1b sum_score prepan - sensitivity 3 months}
# Regression coefficients
gad_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_3months")
kable(gad_prepan_model1b_explan_estimates)
gad_prepan_model1b_explan_estimates

# Regression diagnostic statistics
gad_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_3months")
kable(gad_prepan_model1b_explan_reg_stats)
gad_prepan_model1b_explan_reg_stats
```

#### Subset of participants 6 months prior to pandemic
```{r gad model1b sum_score prepan - sensitivity 6 months}
# Regression coefficients
gad_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_6months")
kable(gad_prepan_model1b_explan_estimates)
gad_prepan_model1b_explan_estimates

# Regression diagnostic statistics
gad_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_6months")
kable(gad_prepan_model1b_explan_reg_stats)
gad_prepan_model1b_explan_reg_stats
```

#### Subset of participants 9 months prior to pandemic
```{r gad model1b sum_score prepan - sensitivity 9 months}
# Regression coefficients
gad_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_9months")
kable(gad_prepan_model1b_explan_estimates)
gad_prepan_model1b_explan_estimates

# Regression diagnostic statistics
gad_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "gad.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_9months")
kable(gad_prepan_model1b_explan_reg_stats)
gad_prepan_model1b_explan_reg_stats
```
##KT

# GAD retro
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r gad model0a diff_score retro}
# Regression coefficients
gad_retro_model0a_estimates <- model0a.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model0a_estimates)
gad_retro_model0a_estimates

# Regression diagnostic statistics
gad_retro_model0a_reg_stats <- model0a.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model0a_reg_stats)
gad_retro_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r gad model0b diff_score retro}
# Regression coefficients
gad_retro_model0b_estimates <- model0b.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model0b_estimates)
gad_retro_model0b_estimates

# Regression diagnostic statistics
gad_retro_model0b_reg_stats <- model0b.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model0b_reg_stats)
gad_retro_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1a diff_score retro}
# Regression coefficients
gad_retro_model1a_estimates <- model1a.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model1a_estimates)
gad_retro_model1a_estimates

# Regression diagnostic statistics
gad_retro_model1a_reg_stats <- model1a.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model1a_reg_stats)
gad_retro_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1b diff_score retro}
# Regression coefficients
gad_retro_model1b_estimates <- model1b.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model1b_estimates)
gad_retro_model1b_estimates

# Regression diagnostic statistics
gad_retro_model1b_reg_stats <- model1b.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(gad_retro_model1b_reg_stats)
gad_retro_model1b_reg_stats
```
### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r gad model2a diff_score retro}
# Regression coefficients
gad_retro_model2a_estimates <- model2a.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro_age_sensitivity")
kable(gad_retro_model2a_estimates)
gad_retro_model2a_estimates

# Regression diagnostic statistics
gad_retro_model2a_reg_stats <- model2a.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro_age_sensitivity")
kable(gad_retro_model2a_reg_stats)
gad_retro_model2a_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed +  age^2 + Ethnicity_collapsed + Time registration and baseline
```{r gad model2b diff_score retro}
# Regression coefficients
gad_retro_model2b_estimates <- model2b.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro_age_sensitivity")
kable(gad_retro_model2b_estimates)
gad_retro_model2b_estimates

# Regression diagnostic statistics
gad_retro_model2b_reg_stats <- model2b.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro_age_sensitivity")
kable(gad_retro_model2b_reg_stats)
gad_retro_model2b_reg_stats
```

## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r gad model0a sum_score retro}
# Regression coefficients
gad_retro_model0a_explan_estimates <- model0a.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model0a_explan_estimates)
gad_retro_model0a_explan_estimates

# Regression diagnostic statistics
gad_retro_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model0a_explan_reg_stats)
gad_retro_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r gad model0b sum_score retro}
# Regression coefficients
gad_retro_model0b_explan_estimates <- model0b.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model0b_explan_estimates)
gad_retro_model0b_explan_estimates

# Regression diagnostic statistics
gad_retro_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model0b_explan_reg_stats)
gad_retro_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1a sum_score retro}
# Regression coefficients
gad_retro_model1a_explan_estimates <- model1a.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model1a_explan_estimates)
gad_retro_model1a_explan_estimates

# Regression diagnostic statistics
gad_retro_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model1a_explan_reg_stats)
gad_retro_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1b sum_score retro}
# Regression coefficients
gad_retro_model1b_explan_estimates <- model1b.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model1b_explan_estimates)
gad_retro_model1b_explan_estimates

# Regression diagnostic statistics
gad_retro_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro")
kable(gad_retro_model1b_explan_reg_stats)
gad_retro_model1b_explan_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r gad model2a sum_score retro}
# Regression coefficients
gad_retro_model2a_explan_estimates <- model2a.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro_age_sensitivity")
kable(gad_retro_model2a_explan_estimates)
gad_retro_model2a_explan_estimates

# Regression diagnostic statistics
gad_retro_model2a_explan_reg_stats <- model2a.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro_age_sensitivity")
kable(gad_retro_model2a_explan_reg_stats)
gad_retro_model2a_explan_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r gad model2b sum_score retro}
# Regression coefficients
gad_retro_model2b_explan_estimates <- model2b.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro_age_sensitivity")
kable(gad_retro_model2b_explan_estimates)
gad_retro_model2b_explan_estimates

# Regression diagnostic statistics
gad_retro_model2b_explan_reg_stats <- model2b.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro_age_sensitivity")
kable(gad_retro_model2b_explan_reg_stats)
gad_retro_model2b_explan_reg_stats
```
# GAD retro: sensitivity
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r gad model0a diff_score retro (sensitivity analysis)}
# Regression coefficients
gad_retro_model0a_estimates <- model0a.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(gad_retro_model0a_estimates)
gad_retro_model0a_estimates

# Regression diagnostic statistics
gad_retro_model0a_reg_stats <- model0a.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(gad_retro_model0a_reg_stats)
gad_retro_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r gad model0b diff_score retro (sensitivity analysis)}
# Regression coefficients
gad_retro_model0b_estimates <- model0b.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(gad_retro_model0b_estimates)
gad_retro_model0b_estimates

# Regression diagnostic statistics
gad_retro_model0b_reg_stats <- model0b.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(gad_retro_model0b_reg_stats)
gad_retro_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1a diff_score retro (sensitivity analysis)}
# Regression coefficients
gad_retro_model1a_estimates <- model1a.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(gad_retro_model1a_estimates)
gad_retro_model1a_estimates

# Regression diagnostic statistics
gad_retro_model1a_reg_stats <- model1a.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(gad_retro_model1a_reg_stats)
gad_retro_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1b diff_score retro (sensitivity analysis)}
# Regression coefficients
gad_retro_model1b_estimates <- model1b.estimates(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(gad_retro_model1b_estimates)
gad_retro_model1b_estimates

# Regression diagnostic statistics
gad_retro_model1b_reg_stats <- model1b.reg.stats(outcome = "gad.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(gad_retro_model1b_reg_stats)
gad_retro_model1b_reg_stats
```


## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r gad model0a sum_score retro (sensitivity analysis)}
# Regression coefficients
gad_retro_model0a_explan_estimates <- model0a.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(gad_retro_model0a_explan_estimates)
gad_retro_model0a_explan_estimates

# Regression diagnostic statistics
gad_retro_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(gad_retro_model0a_explan_reg_stats)
gad_retro_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r gad model0b sum_score retro (sensitivity analysis)}
# Regression coefficients
gad_retro_model0b_explan_estimates <- model0b.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(gad_retro_model0b_explan_estimates)
gad_retro_model0b_explan_estimates

# Regression diagnostic statistics
gad_retro_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(gad_retro_model0b_explan_reg_stats)
gad_retro_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1a sum_score retro (sensitivity analysis)}
# Regression coefficients
gad_retro_model1a_explan_estimates <- model1a.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(gad_retro_model1a_explan_estimates)
gad_retro_model1a_explan_estimates

# Regression diagnostic statistics
gad_retro_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(gad_retro_model1a_explan_reg_stats)
gad_retro_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r gad model1b sum_score retro (sensitivity analysis)}
# Regression coefficients
gad_retro_model1b_explan_estimates <- model1b.explan.estimates(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(gad_retro_model1b_explan_estimates)
gad_retro_model1b_explan_estimates

# Regression diagnostic statistics
gad_retro_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "gad.sum_score_base",
                                                               explan_var = "gad.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(gad_retro_model1b_explan_reg_stats)
gad_retro_model1b_explan_reg_stats
```

# PHQ baseline, not controlling for prior symptoms
### Model 0a: Disorder_hierarchical, Unadjusted
```{r phq model0a absolute whole sample}
# Regression coefficients
phq_baseline_model0a_estimates <- model0a.estimates(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model0a_estimates)
phq_baseline_model0a_estimates

# Regression diagnostic statistics
phq_baseline_model0a_reg_stats <- model0a.reg.stats(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model0a_reg_stats)
phq_baseline_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r phq model0b absolute whole sample}
# Regression coefficients
phq_baseline_model0b_estimates <- model0b.estimates(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model0b_estimates)
phq_baseline_model0b_estimates

# Regression diagnostic statistics
phq_baseline_model0b_reg_stats <- model0b.reg.stats(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model0b_reg_stats)
phq_baseline_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1a absolute whole sample}
# Regression coefficients
phq_baseline_model1a_estimates <- model1a.estimates(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model1a_estimates)
phq_baseline_model1a_estimates

# Regression diagnostic statistics
phq_baseline_model1a_reg_stats <- model1a.reg.stats(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model1a_reg_stats)
phq_baseline_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1b absolute whole sample}
# Regression coefficients
phq_baseline_model1b_estimates <- model1b.estimates(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model1b_estimates)
phq_baseline_model1b_estimates

# Regression diagnostic statistics
phq_baseline_model1b_reg_stats <- model1b.reg.stats(outcome = "phq.sum_score_base",
                                                 data_set = "dat")
kable(phq_baseline_model1b_reg_stats)
phq_baseline_model1b_reg_stats
```


### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r phq model2a absolute whole sample}
# Regression coefficients
phq_baseline_model2a_estimates <- model2a.estimates(outcome = "phq.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(phq_baseline_model2a_estimates)
phq_baseline_model2a_estimates

# Regression diagnostic statistics
phq_baseline_model2a_reg_stats <- model2a.reg.stats(outcome = "phq.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(phq_baseline_model2a_reg_stats)
phq_baseline_model2a_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed +  age^2 + Ethnicity_collapsed + Time registration and baseline
```{r phq model2b absolute whole sample}
# Regression coefficients
phq_baseline_model2b_estimates <- model2b.estimates(outcome = "phq.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(phq_baseline_model2b_estimates)
phq_baseline_model2b_estimates

# Regression diagnostic statistics
phq_baseline_model2b_reg_stats <- model2b.reg.stats(outcome = "phq.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(phq_baseline_model2b_reg_stats)
phq_baseline_model2b_reg_stats
```

# PHQ prepan
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r phq model0a diff_score prepan}
# Regression coefficients
phq_prepan_model0a_estimates <- model0a.estimates(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model0a_estimates)
phq_prepan_model0a_estimates

# Regression diagnostic statistics
phq_prepan_model0a_reg_stats <- model0a.reg.stats(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model0a_reg_stats)
phq_prepan_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r phq model0b diff_score prepan}
# Regression coefficients
phq_prepan_model0b_estimates <- model0b.estimates(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model0b_estimates)
phq_prepan_model0b_estimates

# Regression diagnostic statistics
phq_prepan_model0b_reg_stats <- model0b.reg.stats(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model0b_reg_stats)
phq_prepan_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1a diff_score prepan}
# Regression coefficients
phq_prepan_model1a_estimates <- model1a.estimates(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model1a_estimates)
phq_prepan_model1a_estimates

# Regression diagnostic statistics
phq_prepan_model1a_reg_stats <- model1a.reg.stats(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model1a_reg_stats)
phq_prepan_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1b diff_score prepan}
# Regression coefficients
phq_prepan_model1b_estimates <- model1b.estimates(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model1b_estimates)
phq_prepan_model1b_estimates

# Regression diagnostic statistics
phq_prepan_model1b_reg_stats <- model1b.reg.stats(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(phq_prepan_model1b_reg_stats)
phq_prepan_model1b_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r phq model2a diff_score prepan}
# Regression coefficients
phq_prepan_model2a_estimates <- model2a.estimates(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(phq_prepan_model2a_estimates)
phq_prepan_model2a_estimates

# Regression diagnostic statistics
phq_prepan_model2a_reg_stats <- model2a.reg.stats(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(phq_prepan_model2a_reg_stats)
phq_prepan_model2a_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed +  age^2 + Ethnicity_collapsed + Time registration and baseline
```{r phq model2b diff_score prepan}
# Regression coefficients
phq_prepan_model2b_estimates <- model2b.estimates(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(phq_prepan_model2b_estimates)
phq_prepan_model2b_estimates

# Regression diagnostic statistics
phq_prepan_model2b_reg_stats <- model2b.reg.stats(outcome = "phq.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(phq_prepan_model2b_reg_stats)
phq_prepan_model2b_reg_stats
```
## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r phq model0a sum_score prepan}
# Regression coefficients
phq_prepan_model0a_explan_estimates <- model0a.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model0a_explan_estimates)
phq_prepan_model0a_explan_estimates

# Regression diagnostic statistics
phq_prepan_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model0a_explan_reg_stats)
phq_prepan_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r phq model0b sum_score prepan}
# Regression coefficients
phq_prepan_model0b_explan_estimates <- model0b.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model0b_explan_estimates)
phq_prepan_model0b_explan_estimates

# Regression diagnostic statistics
phq_prepan_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model0b_explan_reg_stats)
phq_prepan_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1a sum_score prepan}
# Regression coefficients
phq_prepan_model1a_explan_estimates <- model1a.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model1a_explan_estimates)
phq_prepan_model1a_explan_estimates

# Regression diagnostic statistics
phq_prepan_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model1a_explan_reg_stats)
phq_prepan_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1b sum_score prepan}
# Regression coefficients
phq_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model1b_explan_estimates)
phq_prepan_model1b_explan_estimates

# Regression diagnostic statistics
phq_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan")
kable(phq_prepan_model1b_explan_reg_stats)
phq_prepan_model1b_explan_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r phq model2a sum_score prepan}
# Regression coefficients
phq_prepan_model2a_explan_estimates <- model2a.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(phq_prepan_model2a_explan_estimates)
phq_prepan_model2a_explan_estimates

# Regression diagnostic statistics
phq_prepan_model2a_explan_reg_stats <- model2a.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(phq_prepan_model2a_explan_reg_stats)
phq_prepan_model2a_explan_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r phq model2b sum_score prepan}
# Regression coefficients
phq_prepan_model2b_explan_estimates <- model2b.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(phq_prepan_model2b_explan_estimates)
phq_prepan_model2b_explan_estimates

# Regression diagnostic statistics
phq_prepan_model2b_explan_reg_stats <- model2b.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(phq_prepan_model2b_explan_reg_stats)
phq_prepan_model2b_explan_reg_stats
```

# PHQ prepan: sensitivity
## Regression: Absolute scores
### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
#### Subset of participants 3 months prior to pandemic
```{r phq model1b sum_score prepan - sensitivity 3 months}
# Regression coefficients
phq_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_3months")
kable(phq_prepan_model1b_explan_estimates)
phq_prepan_model1b_explan_estimates

# Regression diagnostic statistics
phq_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_3months")
kable(phq_prepan_model1b_explan_reg_stats)
phq_prepan_model1b_explan_reg_stats
```

#### Subset of participants 6 months prior to pandemic
```{r phq model1b sum_score prepan - sensitivity 6 months}
# Regression coefficients
phq_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_6months")
kable(phq_prepan_model1b_explan_estimates)
phq_prepan_model1b_explan_estimates

# Regression diagnostic statistics
phq_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_6months")
kable(phq_prepan_model1b_explan_reg_stats)
phq_prepan_model1b_explan_reg_stats
```

#### Subset of participants 9 months prior to pandemic
```{r phq model1b sum_score prepan - sensitivity 9 months}
# Regression coefficients
phq_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_9months")
kable(phq_prepan_model1b_explan_estimates)
phq_prepan_model1b_explan_estimates

# Regression diagnostic statistics
phq_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "phq.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_9months")
kable(phq_prepan_model1b_explan_reg_stats)
phq_prepan_model1b_explan_reg_stats
```


# PHQ retro
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r phq model0a diff_score retro}
# Regression coefficients
phq_retro_model0a_estimates <- model0a.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model0a_estimates)
phq_retro_model0a_estimates

# Regression diagnostic statistics
phq_retro_model0a_reg_stats <- model0a.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model0a_reg_stats)
phq_retro_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r phq model0b diff_score retro}
# Regression coefficients
phq_retro_model0b_estimates <- model0b.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model0b_estimates)
phq_retro_model0b_estimates

# Regression diagnostic statistics
phq_retro_model0b_reg_stats <- model0b.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model0b_reg_stats)
phq_retro_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1a diff_score retro}
# Regression coefficients
phq_retro_model1a_estimates <- model1a.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model1a_estimates)
phq_retro_model1a_estimates

# Regression diagnostic statistics
phq_retro_model1a_reg_stats <- model1a.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model1a_reg_stats)
phq_retro_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1b diff_score retro}
# Regression coefficients
phq_retro_model1b_estimates <- model1b.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model1b_estimates)
phq_retro_model1b_estimates

# Regression diagnostic statistics
phq_retro_model1b_reg_stats <- model1b.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(phq_retro_model1b_reg_stats)
phq_retro_model1b_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r phq model2a diff_score retro}
# Regression coefficients
phq_retro_model2a_estimates <- model2a.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro_age_sensitivity")
kable(phq_retro_model2a_estimates)
phq_retro_model2a_estimates

# Regression diagnostic statistics
phq_retro_model2a_reg_stats <- model2a.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro_age_sensitivity")
kable(phq_retro_model2a_reg_stats)
phq_retro_model2a_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r phq model2b diff_score retro}
# Regression coefficients
phq_retro_model2b_estimates <- model2b.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro_age_sensitivity")
kable(phq_retro_model2b_estimates)
phq_retro_model2b_estimates

# Regression diagnostic statistics
phq_retro_model2b_reg_stats <- model2b.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro_age_sensitivity")
kable(phq_retro_model2b_reg_stats)
phq_retro_model2b_reg_stats
```
## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r phq model0a sum_score retro}
# Regression coefficients
phq_retro_model0a_explan_estimates <- model0a.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model0a_explan_estimates)
phq_retro_model0a_explan_estimates

# Regression diagnostic statistics
phq_retro_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model0a_explan_reg_stats)
phq_retro_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r phq model0b sum_score retro}
# Regression coefficients
phq_retro_model0b_explan_estimates <- model0b.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model0b_explan_estimates)
phq_retro_model0b_explan_estimates

# Regression diagnostic statistics
phq_retro_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model0b_explan_reg_stats)
phq_retro_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1a sum_score retro}
# Regression coefficients
phq_retro_model1a_explan_estimates <- model1a.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model1a_explan_estimates)
phq_retro_model1a_explan_estimates

# Regression diagnostic statistics
phq_retro_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model1a_explan_reg_stats)
phq_retro_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1b sum_score retro}
# Regression coefficients
phq_retro_model1b_explan_estimates <- model1b.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model1b_explan_estimates)
phq_retro_model1b_explan_estimates

# Regression diagnostic statistics
phq_retro_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro")
kable(phq_retro_model1b_explan_reg_stats)
phq_retro_model1b_explan_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r phq model2a sum_score retro}
# Regression coefficients
phq_retro_model2a_explan_estimates <- model2a.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro_age_sensitivity")
kable(phq_retro_model2a_explan_estimates)
phq_retro_model2a_explan_estimates

# Regression diagnostic statistics
phq_retro_model2a_explan_reg_stats <- model2a.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro_age_sensitivity")
kable(phq_retro_model2a_explan_reg_stats)
phq_retro_model2a_explan_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r phq model2b sum_score retro}
# Regression coefficients
phq_retro_model2b_explan_estimates <- model2b.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro_age_sensitivity")
kable(phq_retro_model2b_explan_estimates)
phq_retro_model2b_explan_estimates

# Regression diagnostic statistics
phq_retro_model2b_explan_reg_stats <- model2b.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro_age_sensitivity")
kable(phq_retro_model2b_explan_reg_stats)
phq_retro_model2b_explan_reg_stats
```

# PHQ retro: Sensitivity
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r phq model0a diff_score retro (sensitivity analysis)}
# Regression coefficients
phq_retro_model0a_estimates <- model0a.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(phq_retro_model0a_estimates)
phq_retro_model0a_estimates

# Regression diagnostic statistics
phq_retro_model0a_reg_stats <- model0a.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(phq_retro_model0a_reg_stats)
phq_retro_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r phq model0b diff_score retro (sensitivity analysis)}
# Regression coefficients
phq_retro_model0b_estimates <- model0b.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(phq_retro_model0b_estimates)
phq_retro_model0b_estimates

# Regression diagnostic statistics
phq_retro_model0b_reg_stats <- model0b.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(phq_retro_model0b_reg_stats)
phq_retro_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1a diff_score retro (sensitivity analysis)}
# Regression coefficients
phq_retro_model1a_estimates <- model1a.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(phq_retro_model1a_estimates)
phq_retro_model1a_estimates

# Regression diagnostic statistics
phq_retro_model1a_reg_stats <- model1a.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(phq_retro_model1a_reg_stats)
phq_retro_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1b diff_score retro (sensitivity analysis)}
# Regression coefficients
phq_retro_model1b_estimates <- model1b.estimates(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(phq_retro_model1b_estimates)
phq_retro_model1b_estimates

# Regression diagnostic statistics
phq_retro_model1b_reg_stats <- model1b.reg.stats(outcome = "phq.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(phq_retro_model1b_reg_stats)
phq_retro_model1b_reg_stats
```

## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r phq model0a sum_score retro (sensitivity analysis)}
# Regression coefficients
phq_retro_model0a_explan_estimates <- model0a.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(phq_retro_model0a_explan_estimates)
phq_retro_model0a_explan_estimates

# Regression diagnostic statistics
phq_retro_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(phq_retro_model0a_explan_reg_stats)
phq_retro_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r phq model0b sum_score retro (sensitivity analysis)}
# Regression coefficients
phq_retro_model0b_explan_estimates <- model0b.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(phq_retro_model0b_explan_estimates)
phq_retro_model0b_explan_estimates

# Regression diagnostic statistics
phq_retro_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(phq_retro_model0b_explan_reg_stats)
phq_retro_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1a sum_score retro (sensitivity analysis)}
# Regression coefficients
phq_retro_model1a_explan_estimates <- model1a.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(phq_retro_model1a_explan_estimates)
phq_retro_model1a_explan_estimates

# Regression diagnostic statistics
phq_retro_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(phq_retro_model1a_explan_reg_stats)
phq_retro_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r phq model1b sum_score retro (sensitivity analysis)}
# Regression coefficients
phq_retro_model1b_explan_estimates <- model1b.explan.estimates(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(phq_retro_model1b_explan_estimates)
phq_retro_model1b_explan_estimates

# Regression diagnostic statistics
phq_retro_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "phq.sum_score_base",
                                                               explan_var = "phq.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(phq_retro_model1b_explan_reg_stats)
phq_retro_model1b_explan_reg_stats
```



# OCI-R baseline, not controlling for prior symptoms
### Model 0a: Disorder_hierarchical, Unadjusted
```{r ocir model0a absolute whole sample}
# Regression coefficients
ocir_baseline_model0a_estimates <- model0a.estimates(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model0a_estimates)
ocir_baseline_model0a_estimates

# Regression diagnostic statistics
ocir_baseline_model0a_reg_stats <- model0a.reg.stats(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model0a_reg_stats)
ocir_baseline_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r ocir model0b absolute whole sample}
# Regression coefficients
ocir_baseline_model0b_estimates <- model0b.estimates(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model0b_estimates)
ocir_baseline_model0b_estimates

# Regression diagnostic statistics
ocir_baseline_model0b_reg_stats <- model0b.reg.stats(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model0b_reg_stats)
ocir_baseline_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1a absolute whole sample}
# Regression coefficients
ocir_baseline_model1a_estimates <- model1a.estimates(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model1a_estimates)
ocir_baseline_model1a_estimates

# Regression diagnostic statistics
ocir_baseline_model1a_reg_stats <- model1a.reg.stats(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model1a_reg_stats)
ocir_baseline_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1b absolute whole sample}
# Regression coefficients
ocir_baseline_model1b_estimates <- model1b.estimates(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model1b_estimates)
ocir_baseline_model1b_estimates

# Regression diagnostic statistics
ocir_baseline_model1b_reg_stats <- model1b.reg.stats(outcome = "ocir.sum_score_base",
                                                 data_set = "dat")
kable(ocir_baseline_model1b_reg_stats)
ocir_baseline_model1b_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r ocir model2a absolute whole sample}
# Regression coefficients
ocir_baseline_model2a_estimates <- model2a.estimates(outcome = "ocir.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(ocir_baseline_model2a_estimates)
ocir_baseline_model2a_estimates

# Regression diagnostic statistics
ocir_baseline_model2a_reg_stats <- model2a.reg.stats(outcome = "ocir.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(ocir_baseline_model2a_reg_stats)
ocir_baseline_model2a_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r ocir model2b absolute whole sample}
# Regression coefficients
ocir_baseline_model2b_estimates <- model2b.estimates(outcome = "ocir.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(ocir_baseline_model2b_estimates)
ocir_baseline_model2b_estimates

# Regression diagnostic statistics
ocir_baseline_model2b_reg_stats <- model2b.reg.stats(outcome = "ocir.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(ocir_baseline_model2b_reg_stats)
ocir_baseline_model2b_reg_stats
```

# OCIR prepan
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r ocir model0a diff_score prepan}
# Regression coefficients
ocir_prepan_model0a_estimates <- model0a.estimates(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model0a_estimates)
ocir_prepan_model0a_estimates

# Regression diagnostic statistics
ocir_prepan_model0a_reg_stats <- model0a.reg.stats(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model0a_reg_stats)
ocir_prepan_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r ocir model0b diff_score prepan}
# Regression coefficients
ocir_prepan_model0b_estimates <- model0b.estimates(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model0b_estimates)
ocir_prepan_model0b_estimates

# Regression diagnostic statistics
ocir_prepan_model0b_reg_stats <- model0b.reg.stats(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model0b_reg_stats)
ocir_prepan_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1a diff_score prepan}
# Regression coefficients
ocir_prepan_model1a_estimates <- model1a.estimates(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model1a_estimates)
ocir_prepan_model1a_estimates

# Regression diagnostic statistics
ocir_prepan_model1a_reg_stats <- model1a.reg.stats(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model1a_reg_stats)
ocir_prepan_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1b diff_score prepan}
# Regression coefficients
ocir_prepan_model1b_estimates <- model1b.estimates(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model1b_estimates)
ocir_prepan_model1b_estimates

# Regression diagnostic statistics
ocir_prepan_model1b_reg_stats <- model1b.reg.stats(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(ocir_prepan_model1b_reg_stats)
ocir_prepan_model1b_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r ocir model2a diff_score prepan}
# Regression coefficients
ocir_prepan_model2a_estimates <- model2a.estimates(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(ocir_prepan_model2a_estimates)
ocir_prepan_model2a_estimates

# Regression diagnostic statistics
ocir_prepan_model2a_reg_stats <- model2a.reg.stats(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(ocir_prepan_model2a_reg_stats)
ocir_prepan_model2a_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r ocir model2b diff_score prepan}
# Regression coefficients
ocir_prepan_model2b_estimates <- model2b.estimates(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(ocir_prepan_model2b_estimates)
ocir_prepan_model2b_estimates

# Regression diagnostic statistics
ocir_prepan_model2b_reg_stats <- model2b.reg.stats(outcome = "ocir.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(ocir_prepan_model2b_reg_stats)
ocir_prepan_model2b_reg_stats
```

## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r ocir model0a sum_score prepan}
# Regression coefficients
ocir_prepan_model0a_explan_estimates <- model0a.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model0a_explan_estimates)
ocir_prepan_model0a_explan_estimates

# Regression diagnostic statistics
ocir_prepan_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model0a_explan_reg_stats)
ocir_prepan_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r ocir model0b sum_score prepan}
# Regression coefficients
ocir_prepan_model0b_explan_estimates <- model0b.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model0b_explan_estimates)
ocir_prepan_model0b_explan_estimates

# Regression diagnostic statistics
ocir_prepan_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model0b_explan_reg_stats)
ocir_prepan_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1a sum_score prepan}
# Regression coefficients
ocir_prepan_model1a_explan_estimates <- model1a.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1a_explan_estimates)
ocir_prepan_model1a_explan_estimates

# Regression diagnostic statistics
ocir_prepan_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1a_explan_reg_stats)
ocir_prepan_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1b sum_score prepan}
# Regression coefficients
ocir_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1b_explan_estimates)
ocir_prepan_model1b_explan_estimates

# Regression diagnostic statistics
ocir_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1b_explan_reg_stats)
ocir_prepan_model1b_explan_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r ocir model2a sum_score prepan}
# Regression coefficients
ocir_prepan_model2a_explan_estimates <- model2a.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(ocir_prepan_model2a_explan_estimates)
ocir_prepan_model2a_explan_estimates

# Regression diagnostic statistics
ocir_prepan_model2a_explan_reg_stats <- model2a.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(ocir_prepan_model2a_explan_reg_stats)
ocir_prepan_model2a_explan_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r ocir model2b sum_score prepan}
# Regression coefficients
ocir_prepan_model2b_explan_estimates <- model2b.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(ocir_prepan_model2b_explan_estimates)
ocir_prepan_model2b_explan_estimates

# Regression diagnostic statistics
ocir_prepan_model2b_explan_reg_stats <- model2b.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "ocir.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(ocir_prepan_model2b_explan_reg_stats)
ocir_prepan_model2b_explan_reg_stats
```
# OCIR retro
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r ocir model0a diff_score retro}
# Regression coefficients
ocir_retro_model0a_estimates <- model0a.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model0a_estimates)
ocir_retro_model0a_estimates

# Regression diagnostic statistics
ocir_retro_model0a_reg_stats <- model0a.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model0a_reg_stats)
ocir_retro_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r ocir model0b diff_score retro}
# Regression coefficients
ocir_retro_model0b_estimates <- model0b.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model0b_estimates)
ocir_retro_model0b_estimates

# Regression diagnostic statistics
ocir_retro_model0b_reg_stats <- model0b.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model0b_reg_stats)
ocir_retro_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1a diff_score retro}
# Regression coefficients
ocir_retro_model1a_estimates <- model1a.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model1a_estimates)
ocir_retro_model1a_estimates

# Regression diagnostic statistics
ocir_retro_model1a_reg_stats <- model1a.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model1a_reg_stats)
ocir_retro_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1b diff_score retro}
# Regression coefficients
ocir_retro_model1b_estimates <- model1b.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model1b_estimates)
ocir_retro_model1b_estimates

# Regression diagnostic statistics
ocir_retro_model1b_reg_stats <- model1b.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro")
kable(ocir_retro_model1b_reg_stats)
ocir_retro_model1b_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r ocir model2a diff_score retro}
# Regression coefficients
ocir_retro_model2a_estimates <- model2a.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro_age_sensitivity")
kable(ocir_retro_model2a_estimates)
ocir_retro_model2a_estimates

# Regression diagnostic statistics
ocir_retro_model2a_reg_stats <- model2a.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro_age_sensitivity")
kable(ocir_retro_model2a_reg_stats)
ocir_retro_model2a_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r ocir model2b diff_score retro}
# Regression coefficients
ocir_retro_model2b_estimates <- model2b.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro_age_sensitivity")
kable(ocir_retro_model2b_estimates)
ocir_retro_model2b_estimates

# Regression diagnostic statistics
ocir_retro_model2b_reg_stats <- model2b.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro_age_sensitivity")
kable(ocir_retro_model2b_reg_stats)
ocir_retro_model2b_reg_stats
```

## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r ocir model0a sum_score retro}
# Regression coefficients
ocir_retro_model0a_explan_estimates <- model0a.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model0a_explan_estimates)
ocir_retro_model0a_explan_estimates

# Regression diagnostic statistics
ocir_retro_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model0a_explan_reg_stats)
ocir_retro_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r ocir model0b sum_score retro}
# Regression coefficients
ocir_retro_model0b_explan_estimates <- model0b.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model0b_explan_estimates)
ocir_retro_model0b_explan_estimates

# Regression diagnostic statistics
ocir_retro_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model0b_explan_reg_stats)
ocir_retro_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1a sum_score retro}
# Regression coefficients
ocir_retro_model1a_explan_estimates <- model1a.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model1a_explan_estimates)
ocir_retro_model1a_explan_estimates

# Regression diagnostic statistics
ocir_retro_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model1a_explan_reg_stats)
ocir_retro_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1b sum_score retro}
# Regression coefficients
ocir_retro_model1b_explan_estimates <- model1b.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model1b_explan_estimates)
ocir_retro_model1b_explan_estimates

# Regression diagnostic statistics
ocir_retro_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro")
kable(ocir_retro_model1b_explan_reg_stats)
ocir_retro_model1b_explan_reg_stats
```
### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r ocir model2a sum_score retro}
# Regression coefficients
ocir_retro_model2a_explan_estimates <- model2a.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro_age_sensitivity")
kable(ocir_retro_model2a_explan_estimates)
ocir_retro_model2a_explan_estimates

# Regression diagnostic statistics
ocir_retro_model2a_explan_reg_stats <- model2a.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro_age_sensitivity")
kable(ocir_retro_model2a_explan_reg_stats)
ocir_retro_model2a_explan_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r ocir model2b sum_score retro}
# Regression coefficients
ocir_retro_model2b_explan_estimates <- model2b.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro_age_sensitivity")
kable(ocir_retro_model2b_explan_estimates)
ocir_retro_model2b_explan_estimates

# Regression diagnostic statistics
ocir_retro_model2b_explan_reg_stats <- model2b.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro_age_sensitivity")
kable(ocir_retro_model2b_explan_reg_stats)
ocir_retro_model2b_explan_reg_stats
```

# OCIR retro
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r ocir model0a diff_score retro (sensitivity analyses)}
# Regression coefficients
ocir_retro_model0a_estimates <- model0a.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(ocir_retro_model0a_estimates)
ocir_retro_model0a_estimates

# Regression diagnostic statistics
ocir_retro_model0a_reg_stats <- model0a.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(ocir_retro_model0a_reg_stats)
ocir_retro_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r ocir model0b diff_score retro (sensitivity analyses)}
# Regression coefficients
ocir_retro_model0b_estimates <- model0b.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(ocir_retro_model0b_estimates)
ocir_retro_model0b_estimates

# Regression diagnostic statistics
ocir_retro_model0b_reg_stats <- model0b.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(ocir_retro_model0b_reg_stats)
ocir_retro_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1a diff_score retro (sensitivity analyses)}
# Regression coefficients
ocir_retro_model1a_estimates <- model1a.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(ocir_retro_model1a_estimates)
ocir_retro_model1a_estimates

# Regression diagnostic statistics
ocir_retro_model1a_reg_stats <- model1a.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(ocir_retro_model1a_reg_stats)
ocir_retro_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1b diff_score retro (sensitivity analyses)}
# Regression coefficients
ocir_retro_model1b_estimates <- model1b.estimates(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(ocir_retro_model1b_estimates)
ocir_retro_model1b_estimates

# Regression diagnostic statistics
ocir_retro_model1b_reg_stats <- model1b.reg.stats(outcome = "ocir.diff_score_base_retro",
                                                 data_set = "dat.retro_sensitivity")
kable(ocir_retro_model1b_reg_stats)
ocir_retro_model1b_reg_stats
```

## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r ocir model0a sum_score retro (sensitivity analyses)}
# Regression coefficients
ocir_retro_model0a_explan_estimates <- model0a.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(ocir_retro_model0a_explan_estimates)
ocir_retro_model0a_explan_estimates

# Regression diagnostic statistics
ocir_retro_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(ocir_retro_model0a_explan_reg_stats)
ocir_retro_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r ocir model0b sum_score retro (sensitivity analyses)}
# Regression coefficients
ocir_retro_model0b_explan_estimates <- model0b.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(ocir_retro_model0b_explan_estimates)
ocir_retro_model0b_explan_estimates

# Regression diagnostic statistics
ocir_retro_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(ocir_retro_model0b_explan_reg_stats)
ocir_retro_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1a sum_score retro (sensitivity analyses)}
# Regression coefficients
ocir_retro_model1a_explan_estimates <- model1a.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(ocir_retro_model1a_explan_estimates)
ocir_retro_model1a_explan_estimates

# Regression diagnostic statistics
ocir_retro_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(ocir_retro_model1a_explan_reg_stats)
ocir_retro_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r ocir model1b sum_score retro (sensitivity analyses)}
# Regression coefficients
ocir_retro_model1b_explan_estimates <- model1b.explan.estimates(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(ocir_retro_model1b_explan_estimates)
ocir_retro_model1b_explan_estimates

# Regression diagnostic statistics
ocir_retro_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "ocir.sum_score_base",
                                                               explan_var = "ocir.sum_score_retro",
                                                               data_set = "dat.retro_sensitivity")
kable(ocir_retro_model1b_explan_reg_stats)
ocir_retro_model1b_explan_reg_stats
```


# PCL baseline, not controlling for prior symptoms
### Model 0a: Disorder_hierarchical, Unadjusted
```{r pcl model0a absolute whole sample}
# Regression coefficients
pcl_baseline_model0a_estimates <- model0a.estimates(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model0a_estimates)
pcl_baseline_model0a_estimates

# Regression diagnostic statistics
pcl_baseline_model0a_reg_stats <- model0a.reg.stats(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model0a_reg_stats)
pcl_baseline_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r pcl model0b absolute whole sample}
# Regression coefficients
pcl_baseline_model0b_estimates <- model0b.estimates(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model0b_estimates)
pcl_baseline_model0b_estimates

# Regression diagnostic statistics
pcl_baseline_model0b_reg_stats <- model0b.reg.stats(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model0b_reg_stats)
pcl_baseline_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r pcl model1a absolute whole sample}
# Regression coefficients
pcl_baseline_model1a_estimates <- model1a.estimates(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model1a_estimates)
pcl_baseline_model1a_estimates

# Regression diagnostic statistics
pcl_baseline_model1a_reg_stats <- model1a.reg.stats(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model1a_reg_stats)
pcl_baseline_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted 
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r pcl model1b absolute whole sample}
# Regression coefficients
pcl_baseline_model1b_estimates <- model1b.estimates(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model1b_estimates)
pcl_baseline_model1b_estimates

# Regression diagnostic statistics
pcl_baseline_model1b_reg_stats <- model1b.reg.stats(outcome = "pcl.sum_score_base",
                                                 data_set = "dat")
kable(pcl_baseline_model1b_reg_stats)
pcl_baseline_model1b_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r pcl model2a absolute whole sample}
# Regression coefficients
pcl_baseline_model2a_estimates <- model2a.estimates(outcome = "pcl.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(pcl_baseline_model2a_estimates)
pcl_baseline_model2a_estimates

# Regression diagnostic statistics
pcl_baseline_model2a_reg_stats <- model2a.reg.stats(outcome = "pcl.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(pcl_baseline_model2a_reg_stats)
pcl_baseline_model2a_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r pcl model2b absolute whole sample}
# Regression coefficients
pcl_baseline_model2b_estimates <- model2b.estimates(outcome = "pcl.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(pcl_baseline_model2b_estimates)
pcl_baseline_model2b_estimates

# Regression diagnostic statistics
pcl_baseline_model2b_reg_stats <- model2b.reg.stats(outcome = "pcl.sum_score_base",
                                                 data_set = "dat_age_sensitivity")
kable(pcl_baseline_model2b_reg_stats)
pcl_baseline_model2b_reg_stats
```

# PCL prepan
## Regression: Change scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r pcl model0a diff_score prepan}
# Regression coefficients
pcl_prepan_model0a_estimates <- model0a.estimates(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model0a_estimates)
pcl_prepan_model0a_estimates

# Regression diagnostic statistics
pcl_prepan_model0a_reg_stats <- model0a.reg.stats(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model0a_reg_stats)
pcl_prepan_model0a_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r pcl model0b diff_score prepan}
# Regression coefficients
pcl_prepan_model0b_estimates <- model0b.estimates(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model0b_estimates)
pcl_prepan_model0b_estimates

# Regression diagnostic statistics
pcl_prepan_model0b_reg_stats <- model0b.reg.stats(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model0b_reg_stats)
pcl_prepan_model0b_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r pcl model1a diff_score prepan}
# Regression coefficients
pcl_prepan_model1a_estimates <- model1a.estimates(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model1a_estimates)
pcl_prepan_model1a_estimates

# Regression diagnostic statistics
pcl_prepan_model1a_reg_stats <- model1a.reg.stats(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model1a_reg_stats)
pcl_prepan_model1a_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r pcl model1b diff_score prepan}
# Regression coefficients
pcl_prepan_model1b_estimates <- model1b.estimates(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model1b_estimates)
pcl_prepan_model1b_estimates

# Regression diagnostic statistics
pcl_prepan_model1b_reg_stats <- model1b.reg.stats(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan")
kable(pcl_prepan_model1b_reg_stats)
pcl_prepan_model1b_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r pcl model2a diff_score prepan}
# Regression coefficients
pcl_prepan_model2a_estimates <- model2a.estimates(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(pcl_prepan_model2a_estimates)
pcl_prepan_model2a_estimates

# Regression diagnostic statistics
pcl_prepan_model2a_reg_stats <- model2a.reg.stats(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(pcl_prepan_model2a_reg_stats)
pcl_prepan_model2a_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r pcl model2b diff_score prepan}
# Regression coefficients
pcl_prepan_model2b_estimates <- model2b.estimates(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(pcl_prepan_model2b_estimates)
pcl_prepan_model2b_estimates

# Regression diagnostic statistics
pcl_prepan_model2b_reg_stats <- model2b.reg.stats(outcome = "pcl.diff_score_base_prepan",
                  data_set = "dat.prepan_age_sensitivity")
kable(pcl_prepan_model2b_reg_stats)
pcl_prepan_model2b_reg_stats
```

## Regression: Absolute scores
### Model 0a: Disorder_hierarchical, Unadjusted
```{r pcl model0a sum_score prepan}
# Regression coefficients
pcl_prepan_model0a_explan_estimates <- model0a.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model0a_explan_estimates)
pcl_prepan_model0a_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model0a_explan_reg_stats <- model0a.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model0a_explan_reg_stats)
pcl_prepan_model0a_explan_reg_stats
```

### Model 0b: Overlapping disorders, Unadjusted
```{r pcl model0b sum_score prepan}
# Regression coefficients
pcl_prepan_model0b_explan_estimates <- model0b.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model0b_explan_estimates)
pcl_prepan_model0b_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model0b_explan_reg_stats <- model0b.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model0b_explan_reg_stats)
pcl_prepan_model0b_explan_reg_stats
```

### Model 1a: Disorder hierarchical, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r pcl model1a sum_score prepan}
# Regression coefficients
pcl_prepan_model1a_explan_estimates <- model1a.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1a_explan_estimates)
pcl_prepan_model1a_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model1a_explan_reg_stats <- model1a.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1a_explan_reg_stats)
pcl_prepan_model1a_explan_reg_stats
```

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
```{r pcl model1b sum_score prepan}
# Regression coefficients
pcl_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1b_explan_estimates)
pcl_prepan_model1b_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1b_explan_reg_stats)
pcl_prepan_model1b_explan_reg_stats
```

### Model 2a: Disorder hierarchical, Adjusted with age^2
Model 0a + Gender_collapsed + age^2 + Ethnicity_collapsed + Time registration and baseline
```{r pcl model2a sum_score prepan}
# Regression coefficients
pcl_prepan_model2a_explan_estimates <- model2a.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(pcl_prepan_model2a_explan_estimates)
pcl_prepan_model2a_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model2a_explan_reg_stats <- model2a.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(pcl_prepan_model2a_explan_reg_stats)
pcl_prepan_model2a_explan_reg_stats
```

### Model 2b: Overlapping disorders, Adjusted with age^2
Model 0a + Gender_collapsed +  age^2 + Ethnicity_collapsed + Time registration and baseline
```{r pcl model2b sum_score prepan}
# Regression coefficients
pcl_prepan_model2b_explan_estimates <- model2b.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(pcl_prepan_model2b_explan_estimates)
pcl_prepan_model2b_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model2b_explan_reg_stats <- model2b.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan_age_sensitivity")
kable(pcl_prepan_model2b_explan_reg_stats)
pcl_prepan_model2b_explan_reg_stats
```
# SENSITIVITY based on highest level of education 

# GAD prepan
## Regression: Absolute scores

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad education sensitivity model1b sum_score prepan}
# Regression coefficients
gad_prepan_model1b_education_estimates <- model1b.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "highest_education_numeric",
                         data_set = "dat.prepan")
kable(gad_prepan_model1b_education_estimates)
gad_prepan_model1b_education_estimates

# Regression diagnostic statistics
gad_prepan_model1b_education_reg_stats <- model1b.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "highest_education_numeric",
                         data_set = "dat.prepan")
kable(gad_prepan_model1b_education_reg_stats)
gad_prepan_model1b_education_reg_stats
```

# PHQ prepan
## Regression: Absolute scores


### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq education sensitivity model1b sum_score prepan}
# Regression coefficients
phq_prepan_model1b_education_estimates <- model1b.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "highest_education_numeric",
                         data_set = "dat.prepan")
kable(phq_prepan_model1b_education_estimates)
phq_prepan_model1b_education_estimates

# Regression diagnostic statistics
phq_prepan_model1b_education_reg_stats <- model1b.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "highest_education_numeric",
                         data_set = "dat.prepan")
kable(phq_prepan_model1b_education_reg_stats)
phq_prepan_model1b_education_reg_stats
```

# OCIR prepan 
## Regression: Absolute scores

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir education sensitivity model1b sum_score prepan}
# Regression coefficients
ocir_prepan_model1b_education_estimates <- model1b.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "highest_education_numeric",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1b_education_estimates)
ocir_prepan_model1b_education_estimates

# Regression diagnostic statistics
ocir_prepan_model1b_education_reg_stats <- model1b.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "highest_education_numeric",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1b_education_reg_stats)
ocir_prepan_model1b_education_reg_stats
```

#PCL prepan 
## Regression: Absolute scores

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r pcl education sensitivty model1b sum_score prepan}
# Regression coefficients
pcl_prepan_model1b_education_estimates <- model1b.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "highest_education_numeric",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1b_education_estimates)
pcl_prepan_model1b_education_estimates

# Regression diagnostic statistics
pcl_prepan_model1b_education_reg_stats <- model1b.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "highest_education_numeric",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1b_education_reg_stats)
pcl_prepan_model1b_education_reg_stats
```

# SENSITIVITY based on employment status 

# GAD prepan
## Regression: Absolute scores

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad employment sensitivity model1b sum_score prepan}
# Regression coefficients
gad_prepan_model1b_employment_estimates <- model1b.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "employment.unemployed_numeric",
                         data_set = "dat.prepan")
kable(gad_prepan_model1b_employment_estimates)
gad_prepan_model1b_employment_estimates

# Regression diagnostic statistics
gad_prepan_model1b_employment_reg_stats <- model1b.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "employment.unemployed_numeric",
                         data_set = "dat.prepan")
kable(gad_prepan_model1b_employment_reg_stats)
gad_prepan_model1b_employment_reg_stats
```

# PHQ prepan
## Regression: Absolute scores

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq employment sensitivity model1b sum_score prepan}
# Regression coefficients
phq_prepan_model1b_employment_estimates <- model1b.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "employment.unemployed_numeric",
                         data_set = "dat.prepan")
kable(phq_prepan_model1b_employment_estimates)
phq_prepan_model1b_employment_estimates

# Regression diagnostic statistics
phq_prepan_model1b_employment_reg_stats <- model1b.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "employment.unemployed_numeric",
                         data_set = "dat.prepan")
kable(phq_prepan_model1b_employment_reg_stats)
phq_prepan_model1b_employment_reg_stats
```

# OCIR prepan 
## Regression: Absolute scores
### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir employment sensitivity model1b sum_score prepan}
# Regression coefficients
ocir_prepan_model1b_employment_estimates <- model1b.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "employment.unemployed_numeric",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1b_employment_estimates)
ocir_prepan_model1b_employment_estimates

# Regression diagnostic statistics
ocir_prepan_model1b_employment_reg_stats <- model1b.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "employment.unemployed_numeric",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1b_employment_reg_stats)
ocir_prepan_model1b_employment_reg_stats
```

#PCL prepan 
## Regression: Absolute scores

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r pcl employment sensitivty model1b sum_score prepan}
# Regression coefficients
pcl_prepan_model1b_employment_estimates <- model1b.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "employment.unemployed_numeric",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1b_employment_estimates)
pcl_prepan_model1b_employment_estimates

# Regression diagnostic statistics
pcl_prepan_model1b_employment_reg_stats <- model1b.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "employment.unemployed_numeric",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1b_employment_reg_stats)
pcl_prepan_model1b_employment_reg_stats
```

# SENSITIVITY based on employment change 

```{r create an employment change variable}
dat.prepan <- dat.prepan %>%
  mutate(employment_change =
           case_when(
             employment.unemployed_numeric == "1" ~ "Unemployed",
             employment.became_unemployed_numeric == "1" ~ "Became Unemployed",                         
             employment.furloughed_or_paid_leave_government_funded_numeric == "1" ~ "Furlough",
             employment.furloughed_or_paid_leave_company_funded_numeric == "1" ~ "Furlough",    
             employment.paid_leave_furloughed_numeric == "1" ~ "Furlough",                             
             key_worker_numeric == "1" ~ "Key Worker",                                            
             employment.government_work_key_workers_numeric == "1" ~ "Key Worker",                
             employment.zerohours_contract_numeric == "1" ~ "Zero Hours Contract",                         
             employment.retired_numeric == "1" ~ "Retired",                                   
             employment.student_gcse_or_a_level_numeric == "1" ~ "Student",                   
             employment.student_university_numeric == "1" ~ "Student"                        
           )
  )

dat.prepan$employment_change <- as.factor(dat.prepan$employment_change)
```

# GAD prepan
## Regression: Absolute scores
### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r gad employment change sensitivity model1b sum_score prepan}
# Regression coefficients
gad_prepan_model1b_employmentchange_estimates <- model1b.explan.estimates(outcome = "gad.sum_score_base",
                         explan_var = "employment_change",
                         data_set = "dat.prepan")
kable(gad_prepan_model1b_employmentchange_estimates)
gad_prepan_model1b_employmentchange_estimates

# Regression diagnostic statistics
gad_prepan_model1b_employmentchange_reg_stats <- model1b.explan.reg.stats(outcome = "gad.sum_score_base",
                         explan_var = "employment_change",
                         data_set = "dat.prepan")
kable(gad_prepan_model1b_employmentchange_reg_stats)
gad_prepan_model1b_employmentchange_reg_stats
```

# PHQ prepan
## Regression: Absolute scores

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r phq employment change sensitivity model1b sum_score prepan}
# Regression coefficients
phq_prepan_model1b_employmentchange_estimates <- model1b.explan.estimates(outcome = "phq.sum_score_base",
                         explan_var = "employment_change",
                         data_set = "dat.prepan")
kable(phq_prepan_model1b_employmentchange_estimates)
phq_prepan_model1b_employmentchange_estimates

# Regression diagnostic statistics
phq_prepan_model1b_employmentchange_reg_stats <- model1b.explan.reg.stats(outcome = "phq.sum_score_base",
                         explan_var = "employment_change",
                         data_set = "dat.prepan")
kable(phq_prepan_model1b_employmentchange_reg_stats)
phq_prepan_model1b_employmentchange_reg_stats
```

# OCIR prepan 
## Regression: Absolute scores

### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r ocir employment change sensitivity model1b sum_score prepan}
# Regression coefficients
ocir_prepan_model1b_employmentchange_estimates <- model1b.explan.estimates(outcome = "ocir.sum_score_base",
                         explan_var = "employment_change",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1b_employmentchange_estimates)
ocir_prepan_model1b_employmentchange_estimates

# Regression diagnostic statistics
ocir_prepan_model1b_employmentchange_reg_stats <- model1b.explan.reg.stats(outcome = "ocir.sum_score_base",
                         explan_var = "employment_change",
                         data_set = "dat.prepan")
kable(ocir_prepan_model1b_employmentchange_reg_stats)
ocir_prepan_model1b_employmentchange_reg_stats
```

#PCL prepan 
## Regression: Absolute scores
### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed + Ethnicity_collapsed + Time registration and baseline
```{r pcl employment change sensitivty model1b sum_score prepan}
# Regression coefficients
pcl_prepan_model1b_employmentchange_estimates <- model1b.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "employment_change",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1b_employmentchange_estimates)
pcl_prepan_model1b_employmentchange_estimates

# Regression diagnostic statistics
pcl_prepan_model1b_employmentchange_reg_stats <- model1b.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "employment_change",
                         data_set = "dat.prepan")
kable(pcl_prepan_model1b_employmentchange_reg_stats)
pcl_prepan_model1b_employmentchange_reg_stats
```

# Sensitivity based on GLAD sign up
#PCL prepan: sensitivity
## Regression: Absolute scores
### Model 1b: Overlapping disorders, Adjusted
Model 0a + Gender_collapsed + age_category_collapsed_reordered + Ethnicity_collapsed + Time registration and baseline
#### Subset of participants 3 months prior to pandemic
```{r pcl model1b sum_score prepan - sensitivity 3 months}
# Regression coefficients
pcl_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_3months")
kable(pcl_prepan_model1b_explan_estimates)
pcl_prepan_model1b_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_3months")
kable(pcl_prepan_model1b_explan_reg_stats)
pcl_prepan_model1b_explan_reg_stats
```

#### Subset of participants 6 months prior to pandemic
```{r pcl model1b sum_score prepan - sensitivity 6 months}
# Regression coefficients
pcl_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_6months")
kable(pcl_prepan_model1b_explan_estimates)
pcl_prepan_model1b_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_6months")
kable(pcl_prepan_model1b_explan_reg_stats)
pcl_prepan_model1b_explan_reg_stats
```

#### Subset of participants 9 months prior to pandemic
```{r pcl model1b sum_score prepan - sensitivity 9 months}
# Regression coefficients
pcl_prepan_model1b_explan_estimates <- model1b.explan.estimates(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_9months")
kable(pcl_prepan_model1b_explan_estimates)
pcl_prepan_model1b_explan_estimates

# Regression diagnostic statistics
pcl_prepan_model1b_explan_reg_stats <- model1b.explan.reg.stats(outcome = "pcl.sum_score_base",
                         explan_var = "pcl.sum_score_prepan",
                         data_set = "dat.prepan_sensitivity_9months")
kable(pcl_prepan_model1b_explan_reg_stats)
pcl_prepan_model1b_explan_reg_stats
```

